{"ast":null,"code":"import axios from 'axios';\n\n/**\n * 预定API\n */\nexport default {\n  // 创建预定\n  createReservation(data) {\n    return axios.post('/api/reservation', data);\n  },\n  // 获取预定列表（管理员）\n  getReservations(params) {\n    return axios.get('/api/reservation', {\n      params\n    });\n  },\n  // 获取预定详情\n  getReservation(code) {\n    // 添加时间戳参数，防止缓存\n    const timestamp = new Date().getTime();\n    return axios.get(`/api/reservation/${code}`, {\n      params: {\n        _t: timestamp\n      }\n    });\n  },\n  // 通过预定码获取预定详情\n  getReservationByCode(code, params = {}) {\n    // 添加时间戳参数，防止缓存\n    const timestamp = new Date().getTime();\n    params = {\n      ...params,\n      _t: timestamp\n    };\n\n    // 构建API基础URL\n    const url = `/api/reservation/code/${code}`;\n\n    // 记录API请求信息\n    console.log(`API请求: ${url}`, '参数:', params);\n\n    // 发送请求并记录响应\n    return axios.get(url, {\n      params\n    }).then(response => {\n      console.log(`API响应: ${url}`, response.data);\n\n      // 调试状态信息\n      if (response.data && response.data.success && response.data.data) {\n        console.log(`预约状态: ${response.data.data.status}`);\n      }\n      return response;\n    }).catch(error => {\n      console.error(`API错误: ${url}`, error);\n      throw error;\n    });\n  },\n  // 更新预定\n  updateReservation(code, data) {\n    return axios.put(`/api/reservation/code/${code}`, data);\n  },\n  // 取消预定\n  cancelReservation(code, data = {}) {\n    // 添加时间戳参数，防止缓存\n    const timestamp = new Date().getTime();\n    if (!data._t) {\n      data._t = timestamp;\n    }\n\n    // 确保reservation_number参数被正确传递\n    if (data.reservation_number) {\n      console.log('取消预约 - 预约序号:', data.reservation_number);\n    } else {\n      console.warn('取消预约 - 未提供预约序号，将取消所有具有相同预约码的预约');\n    }\n    console.log('取消预约请求参数:', data);\n    console.log('取消预约请求URL:', `/api/reservation/cancel/code/${code}`);\n\n    // 将data转换为FormData，确保参数正确传递\n    const formData = new FormData();\n    for (const key in data) {\n      formData.append(key, data[key]);\n    }\n    return axios.post(`/api/reservation/cancel/code/${code}`, data);\n  },\n  // 获取预定二维码\n  getReservationQrcode(code) {\n    return axios.get(`/api/reservation/qrcode/${code}`);\n  },\n  // 获取设备在指定日期的可用性\n  getEquipmentAvailability(equipmentId, params) {\n    return axios.get(`/api/equipment/${equipmentId}/availability`, {\n      params\n    });\n  }\n};","map":{"version":3,"names":["axios","createReservation","data","post","getReservations","params","get","getReservation","code","timestamp","Date","getTime","_t","getReservationByCode","url","console","log","then","response","success","status","catch","error","updateReservation","put","cancelReservation","reservation_number","warn","formData","FormData","key","append","getReservationQrcode","getEquipmentAvailability","equipmentId"],"sources":["D:/equipment-reservation-system/frontend/src/api/reservation.js"],"sourcesContent":["import axios from 'axios'\n\n/**\n * 预定API\n */\nexport default {\n  // 创建预定\n  createReservation(data) {\n    return axios.post('/api/reservation', data)\n  },\n\n  // 获取预定列表（管理员）\n  getReservations(params) {\n    return axios.get('/api/reservation', { params })\n  },\n\n  // 获取预定详情\n  getReservation(code) {\n    // 添加时间戳参数，防止缓存\n    const timestamp = new Date().getTime()\n    return axios.get(`/api/reservation/${code}`, { params: { _t: timestamp } })\n  },\n\n  // 通过预定码获取预定详情\n  getReservationByCode(code, params = {}) {\n    // 添加时间戳参数，防止缓存\n    const timestamp = new Date().getTime()\n    params = { ...params, _t: timestamp }\n\n    // 构建API基础URL\n    const url = `/api/reservation/code/${code}`\n\n    // 记录API请求信息\n    console.log(`API请求: ${url}`, '参数:', params);\n\n    // 发送请求并记录响应\n    return axios.get(url, { params })\n      .then(response => {\n        console.log(`API响应: ${url}`, response.data);\n\n        // 调试状态信息\n        if (response.data && response.data.success && response.data.data) {\n          console.log(`预约状态: ${response.data.data.status}`);\n        }\n\n        return response;\n      })\n      .catch(error => {\n        console.error(`API错误: ${url}`, error);\n        throw error;\n      });\n  },\n\n  // 更新预定\n  updateReservation(code, data) {\n    return axios.put(`/api/reservation/code/${code}`, data)\n  },\n\n  // 取消预定\n  cancelReservation(code, data = {}) {\n    // 添加时间戳参数，防止缓存\n    const timestamp = new Date().getTime()\n    if (!data._t) {\n      data._t = timestamp\n    }\n\n    // 确保reservation_number参数被正确传递\n    if (data.reservation_number) {\n      console.log('取消预约 - 预约序号:', data.reservation_number)\n    } else {\n      console.warn('取消预约 - 未提供预约序号，将取消所有具有相同预约码的预约')\n    }\n\n    console.log('取消预约请求参数:', data)\n    console.log('取消预约请求URL:', `/api/reservation/cancel/code/${code}`)\n\n    // 将data转换为FormData，确保参数正确传递\n    const formData = new FormData()\n    for (const key in data) {\n      formData.append(key, data[key])\n    }\n\n    return axios.post(`/api/reservation/cancel/code/${code}`, data)\n  },\n\n  // 获取预定二维码\n  getReservationQrcode(code) {\n    return axios.get(`/api/reservation/qrcode/${code}`)\n  },\n\n  // 获取设备在指定日期的可用性\n  getEquipmentAvailability(equipmentId, params) {\n    return axios.get(`/api/equipment/${equipmentId}/availability`, { params })\n  }\n}\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;;AAEzB;AACA;AACA;AACA,eAAe;EACb;EACAC,iBAAiBA,CAACC,IAAI,EAAE;IACtB,OAAOF,KAAK,CAACG,IAAI,CAAC,kBAAkB,EAAED,IAAI,CAAC;EAC7C,CAAC;EAED;EACAE,eAAeA,CAACC,MAAM,EAAE;IACtB,OAAOL,KAAK,CAACM,GAAG,CAAC,kBAAkB,EAAE;MAAED;IAAO,CAAC,CAAC;EAClD,CAAC;EAED;EACAE,cAAcA,CAACC,IAAI,EAAE;IACnB;IACA,MAAMC,SAAS,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;IACtC,OAAOX,KAAK,CAACM,GAAG,CAAC,oBAAoBE,IAAI,EAAE,EAAE;MAAEH,MAAM,EAAE;QAAEO,EAAE,EAAEH;MAAU;IAAE,CAAC,CAAC;EAC7E,CAAC;EAED;EACAI,oBAAoBA,CAACL,IAAI,EAAEH,MAAM,GAAG,CAAC,CAAC,EAAE;IACtC;IACA,MAAMI,SAAS,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;IACtCN,MAAM,GAAG;MAAE,GAAGA,MAAM;MAAEO,EAAE,EAAEH;IAAU,CAAC;;IAErC;IACA,MAAMK,GAAG,GAAG,yBAAyBN,IAAI,EAAE;;IAE3C;IACAO,OAAO,CAACC,GAAG,CAAC,UAAUF,GAAG,EAAE,EAAE,KAAK,EAAET,MAAM,CAAC;;IAE3C;IACA,OAAOL,KAAK,CAACM,GAAG,CAACQ,GAAG,EAAE;MAAET;IAAO,CAAC,CAAC,CAC9BY,IAAI,CAACC,QAAQ,IAAI;MAChBH,OAAO,CAACC,GAAG,CAAC,UAAUF,GAAG,EAAE,EAAEI,QAAQ,CAAChB,IAAI,CAAC;;MAE3C;MACA,IAAIgB,QAAQ,CAAChB,IAAI,IAAIgB,QAAQ,CAAChB,IAAI,CAACiB,OAAO,IAAID,QAAQ,CAAChB,IAAI,CAACA,IAAI,EAAE;QAChEa,OAAO,CAACC,GAAG,CAAC,SAASE,QAAQ,CAAChB,IAAI,CAACA,IAAI,CAACkB,MAAM,EAAE,CAAC;MACnD;MAEA,OAAOF,QAAQ;IACjB,CAAC,CAAC,CACDG,KAAK,CAACC,KAAK,IAAI;MACdP,OAAO,CAACO,KAAK,CAAC,UAAUR,GAAG,EAAE,EAAEQ,KAAK,CAAC;MACrC,MAAMA,KAAK;IACb,CAAC,CAAC;EACN,CAAC;EAED;EACAC,iBAAiBA,CAACf,IAAI,EAAEN,IAAI,EAAE;IAC5B,OAAOF,KAAK,CAACwB,GAAG,CAAC,yBAAyBhB,IAAI,EAAE,EAAEN,IAAI,CAAC;EACzD,CAAC;EAED;EACAuB,iBAAiBA,CAACjB,IAAI,EAAEN,IAAI,GAAG,CAAC,CAAC,EAAE;IACjC;IACA,MAAMO,SAAS,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;IACtC,IAAI,CAACT,IAAI,CAACU,EAAE,EAAE;MACZV,IAAI,CAACU,EAAE,GAAGH,SAAS;IACrB;;IAEA;IACA,IAAIP,IAAI,CAACwB,kBAAkB,EAAE;MAC3BX,OAAO,CAACC,GAAG,CAAC,cAAc,EAAEd,IAAI,CAACwB,kBAAkB,CAAC;IACtD,CAAC,MAAM;MACLX,OAAO,CAACY,IAAI,CAAC,gCAAgC,CAAC;IAChD;IAEAZ,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEd,IAAI,CAAC;IAC9Ba,OAAO,CAACC,GAAG,CAAC,YAAY,EAAE,gCAAgCR,IAAI,EAAE,CAAC;;IAEjE;IACA,MAAMoB,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;IAC/B,KAAK,MAAMC,GAAG,IAAI5B,IAAI,EAAE;MACtB0B,QAAQ,CAACG,MAAM,CAACD,GAAG,EAAE5B,IAAI,CAAC4B,GAAG,CAAC,CAAC;IACjC;IAEA,OAAO9B,KAAK,CAACG,IAAI,CAAC,gCAAgCK,IAAI,EAAE,EAAEN,IAAI,CAAC;EACjE,CAAC;EAED;EACA8B,oBAAoBA,CAACxB,IAAI,EAAE;IACzB,OAAOR,KAAK,CAACM,GAAG,CAAC,2BAA2BE,IAAI,EAAE,CAAC;EACrD,CAAC;EAED;EACAyB,wBAAwBA,CAACC,WAAW,EAAE7B,MAAM,EAAE;IAC5C,OAAOL,KAAK,CAACM,GAAG,CAAC,kBAAkB4B,WAAW,eAAe,EAAE;MAAE7B;IAAO,CAAC,CAAC;EAC5E;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}