{"ast":null,"code":"import { mapGetters, mapActions } from 'vuex';\nexport default {\n  name: 'AdminLayout',\n  data() {\n    return {\n      mobileMenuOpen: false\n    };\n  },\n  computed: {\n    ...mapGetters(['currentUser', 'getLanguage']),\n    activeMenu() {\n      return this.$route.path;\n    },\n    currentLanguage() {\n      return this.getLanguage;\n    },\n    displayUsername() {\n      // 优先显示用户名，如果没有则显示'管理员'\n      return this.currentUser && this.currentUser.username ? this.currentUser.username : '管理员';\n    },\n    isSuperAdmin() {\n      return this.currentUser && this.currentUser.role === 'superadmin';\n    }\n  },\n  methods: {\n    ...mapActions(['logout', 'setLanguage']),\n    handleCommand(command) {\n      if (command === 'logout') {\n        this.handleLogout();\n      } else if (command === 'home') {\n        this.$router.push('/');\n      }\n    },\n    handleLogout() {\n      this.logout();\n      this.$message.success('退出登录成功');\n      this.$router.push('/admin/login');\n    },\n    handleLanguageChange(lang) {\n      this.setLanguage(lang);\n      this.$i18n.locale = lang;\n    },\n    handleMobileMenuSelect(key) {\n      this.$router.push(key);\n      this.mobileMenuOpen = false;\n    },\n    toggleMobileMenu() {\n      // 这里可以实现折叠菜单的逻辑，或 emit 事件给父组件\n      const menu = document.querySelector('.header-menu');\n      if (menu) {\n        menu.style.display = menu.style.display === 'none' ? '' : 'none';\n      }\n    }\n  }\n};","map":{"version":3,"names":["mapGetters","mapActions","name","data","mobileMenuOpen","computed","activeMenu","$route","path","currentLanguage","getLanguage","displayUsername","currentUser","username","isSuperAdmin","role","methods","handleCommand","command","handleLogout","$router","push","logout","$message","success","handleLanguageChange","lang","setLanguage","$i18n","locale","handleMobileMenuSelect","key","toggleMobileMenu","menu","document","querySelector","style","display"],"sources":["src/views/admin/AdminLayout.vue"],"sourcesContent":["<template>\n  <div class=\"admin-layout\">\n    <!-- 移动端菜单按钮 -->\n    <div class=\"admin-mobile-nav-toggle\" @click=\"mobileMenuOpen = true\"></div>\n    <!-- 移动端抽屉菜单和遮罩层 -->\n    <div v-if=\"mobileMenuOpen\" class=\"admin-mobile-nav-overlay\" @click=\"mobileMenuOpen = false\"></div>\n    <div v-if=\"mobileMenuOpen\" class=\"admin-mobile-nav-drawer\">\n      <div class=\"admin-mobile-nav-header\">\n        <img src=\"@/assets/logo.png\" alt=\"Logo\" class=\"admin-mobile-nav-logo\">\n        <h3 class=\"admin-mobile-nav-title\">管理控制台</h3>\n      </div>\n      <el-menu\n        :default-active=\"activeMenu\"\n        class=\"admin-mobile-nav-list\"\n        background-color=\"#304156\"\n        text-color=\"#bfcbd9\"\n        active-text-color=\"#409EFF\"\n        @select=\"handleMobileMenuSelect\"\n      >\n        <el-menu-item index=\"/admin/dashboard\">\n          <i class=\"el-icon-s-home\"></i>\n          <span>控制台</span>\n        </el-menu-item>\n        <el-submenu index=\"equipment\">\n          <template slot=\"title\">\n            <i class=\"el-icon-s-grid\"></i>\n            <span>设备管理</span>\n          </template>\n          <el-menu-item index=\"/admin/equipment\">\n            <i class=\"el-icon-s-management\"></i>\n            <span>设备列表</span>\n          </el-menu-item>\n          <el-menu-item index=\"/admin/category\">\n            <i class=\"el-icon-collection-tag\"></i>\n            <span>设备类别</span>\n          </el-menu-item>\n        </el-submenu>\n        <el-menu-item index=\"/admin/reservation\">\n          <i class=\"el-icon-s-order\"></i>\n          <span>预定管理</span>\n        </el-menu-item>\n        <el-menu-item index=\"/admin/announcement\">\n          <i class=\"el-icon-message-solid\"></i>\n          <span>公告管理</span>\n        </el-menu-item>\n        <el-submenu index=\"email-mobile\">\n          <template slot=\"title\">\n            <i class=\"el-icon-message\"></i>\n            <span>邮件管理</span>\n          </template>\n          <el-menu-item index=\"/admin/email/settings\">\n            <i class=\"el-icon-setting\"></i>\n            <span>邮件设置</span>\n          </el-menu-item>\n          <el-menu-item index=\"/admin/email/templates\">\n            <i class=\"el-icon-document\"></i>\n            <span>邮件模板</span>\n          </el-menu-item>\n          <el-menu-item index=\"/admin/email/logs\">\n            <i class=\"el-icon-tickets\"></i>\n            <span>邮件日志</span>\n          </el-menu-item>\n        </el-submenu>\n        <el-menu-item index=\"/admin/db-viewer\" v-if=\"isSuperAdmin\">\n          <i class=\"el-icon-view\"></i>\n          <span>数据库表查看</span>\n        </el-menu-item>\n        <el-menu-item index=\"/admin/accounts\">\n          <i class=\"el-icon-user\"></i>\n          <span>账号管理</span>\n        </el-menu-item>\n      </el-menu>\n      <div class=\"admin-mobile-nav-footer\">\n        <el-button type=\"primary\" plain icon=\"el-icon-s-home\" size=\"small\" @click=\"handleCommand('home')\">返回首页</el-button>\n        <el-button type=\"danger\" plain icon=\"el-icon-switch-button\" size=\"small\" @click=\"handleCommand('logout')\">退出登录</el-button>\n      </div>\n    </div>\n    <el-container class=\"admin-container\">\n      <el-header class=\"admin-header\">\n        <div class=\"header-left\">\n          <img src=\"@/assets/logo.png\" alt=\"Logo\" class=\"header-logo\" />\n          <span class=\"header-title\">管理控制台</span>\n        </div>\n\n        <div class=\"header-menu\">\n          <el-menu\n            :default-active=\"activeMenu\"\n            class=\"top-menu\"\n            mode=\"horizontal\"\n            background-color=\"#FFFFFF\"\n            text-color=\"#333333\"\n            active-text-color=\"#409EFF\"\n            router\n          >\n            <el-menu-item index=\"/admin/dashboard\">\n              <i class=\"el-icon-s-home\"></i>\n              <span>控制台</span>\n            </el-menu-item>\n\n            <el-submenu index=\"equipment\">\n              <template slot=\"title\">\n                <i class=\"el-icon-s-grid\"></i>\n                <span>设备管理</span>\n              </template>\n              <el-menu-item index=\"/admin/equipment\">\n                <i class=\"el-icon-s-management\"></i>\n                <span>设备列表</span>\n              </el-menu-item>\n              <el-menu-item index=\"/admin/category\">\n                <i class=\"el-icon-collection-tag\"></i>\n                <span>设备类别</span>\n              </el-menu-item>\n            </el-submenu>\n\n            <el-menu-item index=\"/admin/reservation\">\n              <i class=\"el-icon-s-order\"></i>\n              <span>预定管理</span>\n            </el-menu-item>\n\n            <el-menu-item index=\"/admin/announcement\">\n              <i class=\"el-icon-message-solid\"></i>\n              <span>公告管理</span>\n            </el-menu-item>\n\n            <el-submenu index=\"email\">\n              <template slot=\"title\">\n                <i class=\"el-icon-message\"></i>\n                <span>邮件管理</span>\n              </template>\n              <el-menu-item index=\"/admin/email/settings\">\n                <i class=\"el-icon-setting\"></i>\n                <span>邮件设置</span>\n              </el-menu-item>\n              <el-menu-item index=\"/admin/email/templates\">\n                <i class=\"el-icon-document\"></i>\n                <span>邮件模板</span>\n              </el-menu-item>\n              <el-menu-item index=\"/admin/email/logs\">\n                <i class=\"el-icon-tickets\"></i>\n                <span>邮件日志</span>\n              </el-menu-item>\n            </el-submenu>\n\n            <el-menu-item index=\"/admin/db-viewer\" v-if=\"isSuperAdmin\">\n              <i class=\"el-icon-view\"></i>\n              <span>数据库表查看</span>\n            </el-menu-item>\n\n            <el-menu-item index=\"/admin/accounts\">\n              <i class=\"el-icon-user\"></i>\n              <span>账号管理</span>\n            </el-menu-item>\n          </el-menu>\n        </div>\n\n        <div class=\"header-right\">\n          <div class=\"user-info\">\n            <i class=\"el-icon-user\"></i>\n            <span>{{ displayUsername }}</span>\n          </div>\n          <el-button type=\"primary\" plain icon=\"el-icon-s-home\" size=\"small\" @click=\"handleCommand('home')\" class=\"home-btn\">返回首页</el-button>\n          <el-button type=\"danger\" plain icon=\"el-icon-switch-button\" size=\"small\" @click=\"handleCommand('logout')\" class=\"logout-btn\">退出登录</el-button>\n        </div>\n      </el-header>\n\n      <el-main class=\"admin-main\">\n        <keep-alive>\n          <router-view></router-view>\n        </keep-alive>\n      </el-main>\n    </el-container>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nexport default {\n  name: 'AdminLayout',\n\n  data() {\n    return {\n      mobileMenuOpen: false\n    }\n  },\n\n  computed: {\n    ...mapGetters(['currentUser', 'getLanguage']),\n\n    activeMenu() {\n      return this.$route.path\n    },\n\n    currentLanguage() {\n      return this.getLanguage\n    },\n\n    displayUsername() {\n      // 优先显示用户名，如果没有则显示'管理员'\n      return this.currentUser && this.currentUser.username ? this.currentUser.username : '管理员'\n    },\n\n    isSuperAdmin() {\n      return this.currentUser && this.currentUser.role === 'superadmin'\n    }\n  },\n\n  methods: {\n    ...mapActions(['logout', 'setLanguage']),\n\n    handleCommand(command) {\n      if (command === 'logout') {\n        this.handleLogout()\n      } else if (command === 'home') {\n        this.$router.push('/')\n      }\n    },\n\n    handleLogout() {\n      this.logout()\n      this.$message.success('退出登录成功')\n      this.$router.push('/admin/login')\n    },\n\n    handleLanguageChange(lang) {\n      this.setLanguage(lang)\n      this.$i18n.locale = lang\n    },\n\n    handleMobileMenuSelect(key) {\n      this.$router.push(key)\n      this.mobileMenuOpen = false\n    },\n\n    toggleMobileMenu() {\n      // 这里可以实现折叠菜单的逻辑，或 emit 事件给父组件\n      const menu = document.querySelector('.header-menu')\n      if (menu) {\n        menu.style.display = (menu.style.display === 'none') ? '' : 'none'\n      }\n    }\n  }\n}\n</script>\n\n<style>\n.admin-layout {\n  height: 100vh;\n  width: 100vw;\n  overflow: hidden;\n  display: flex;\n  margin: 0;\n  padding: 0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  box-sizing: border-box;\n}\n\n.admin-container {\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n}\n\n.admin-header,\n.el-header {\n  background-color: #FFFFFF !important;\n  color: #333333 !important;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0;\n  height: 60px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  border-bottom: 1px solid #EBEEF5;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  padding: 0 20px;\n}\n\n.header-logo {\n  height: 32px;\n  margin-right: 10px;\n}\n\n.header-title {\n  font-size: 18px;\n  font-weight: bold;\n  color: #409EFF;\n  white-space: nowrap;\n}\n\n.header-menu {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n}\n\n.top-menu {\n  background-color: #FFFFFF !important;\n  border-bottom: none;\n}\n\n.top-menu .el-menu-item {\n  height: 60px;\n  line-height: 60px;\n}\n\n.top-menu .el-submenu__title {\n  height: 60px;\n  line-height: 60px;\n}\n\n.header-right {\n  display: flex;\n  align-items: center;\n  gap: 15px;\n  padding: 0 20px;\n}\n\n.user-info {\n  display: flex;\n  align-items: center;\n  color: #606266;\n  margin-right: 15px;\n  background-color: #F5F7FA;\n  padding: 5px 12px;\n  border-radius: 4px;\n  font-size: 14px;\n  border: 1px solid #DCDFE6;\n}\n\n.user-info i {\n  margin-right: 5px;\n}\n\n.header-right .el-button {\n  margin-left: 0;\n  white-space: nowrap;\n}\n\n.admin-main {\n  background-color: #f0f2f5;\n  padding: 20px;\n  overflow-y: auto;\n  height: calc(100vh - 60px);\n  width: 100%;\n  max-width: 100%;\n}\n\n@media (max-width: 768px) {\n  .header-title {\n    display: none;\n  }\n\n  .header-menu {\n    display: none; /* 完全隐藏菜单栏，因为已经集成到侧边悬浮按钮中 */\n  }\n\n  .header-right {\n    flex: 1;\n    justify-content: flex-end;\n    padding-right: 10px; /* 减少右侧内边距，让按钮更靠左 */\n  }\n\n  .user-info {\n    margin-right: 8px; /* 减少用户信息右侧间距 */\n  }\n\n  /* 移动端按钮样式优化 */\n  .home-btn, .logout-btn {\n    padding: 7px 10px;\n    font-size: 12px;\n  }\n\n  .home-btn {\n    margin-right: 5px;\n  }\n\n  .logout-btn {\n    margin-right: 5px; /* 确保退出按钮不会超出屏幕 */\n  }\n\n  .admin-mobile-nav-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0,0,0,0.5);\n    z-index: 2999;\n  }\n  .admin-mobile-nav-drawer {\n    position: fixed;\n    top: 0;\n    right: 0;\n    width: 260px;\n    height: 100vh;\n    background: #304156;\n    z-index: 3000;\n    display: flex;\n    flex-direction: column;\n    transition: right 0.3s ease;\n    box-shadow: -2px 0 8px rgba(0,0,0,0.1);\n  }\n  .admin-mobile-nav-header {\n    height: 60px;\n    display: flex;\n    align-items: center;\n    padding: 0 20px;\n    background-color: #263445;\n  }\n  .admin-mobile-nav-logo {\n    width: 32px;\n    height: 32px;\n    margin-right: 10px;\n  }\n  .admin-mobile-nav-title {\n    margin: 0;\n    font-size: 16px;\n    font-weight: 600;\n    color: #fff;\n  }\n  .admin-mobile-nav-list {\n    flex: 1;\n    border-right: none;\n    background: #304156;\n  }\n  .admin-mobile-nav-footer {\n    padding: 15px 20px;\n    background-color: #263445;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n  }\n  .admin-mobile-nav-toggle {\n    position: fixed;\n    top: 50%;\n    right: 0;\n    left: auto;\n    transform: translateY(-50%);\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background-color: #409EFF;\n    color: #fff;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    cursor: pointer;\n    z-index: 3001;\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  }\n  .admin-mobile-nav-toggle:before {\n    content: '';\n    display: block;\n    width: 24px;\n    height: 24px;\n    background-image: url('data:image/svg+xml;utf8,<svg fill=\"white\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M160 512a32 32 0 0 1 32-32h640a32 32 0 0 1 0 64H192a32 32 0 0 1-32-32zm0-192a32 32 0 0 1 32-32h640a32 32 0 0 1 0 64H192a32 32 0 0 1-32-32zm32 288a32 32 0 0 0 0 64h640a32 32 0 0 0 0-64H192z\"/></svg>');\n    background-size: contain;\n    background-repeat: no-repeat;\n    margin: auto;\n  }\n}\n</style>\n"],"mappings":"AA+KA,SAAAA,UAAA,EAAAC,UAAA;AAEA;EACAC,IAAA;EAEAC,KAAA;IACA;MACAC,cAAA;IACA;EACA;EAEAC,QAAA;IACA,GAAAL,UAAA;IAEAM,WAAA;MACA,YAAAC,MAAA,CAAAC,IAAA;IACA;IAEAC,gBAAA;MACA,YAAAC,WAAA;IACA;IAEAC,gBAAA;MACA;MACA,YAAAC,WAAA,SAAAA,WAAA,CAAAC,QAAA,QAAAD,WAAA,CAAAC,QAAA;IACA;IAEAC,aAAA;MACA,YAAAF,WAAA,SAAAA,WAAA,CAAAG,IAAA;IACA;EACA;EAEAC,OAAA;IACA,GAAAf,UAAA;IAEAgB,cAAAC,OAAA;MACA,IAAAA,OAAA;QACA,KAAAC,YAAA;MACA,WAAAD,OAAA;QACA,KAAAE,OAAA,CAAAC,IAAA;MACA;IACA;IAEAF,aAAA;MACA,KAAAG,MAAA;MACA,KAAAC,QAAA,CAAAC,OAAA;MACA,KAAAJ,OAAA,CAAAC,IAAA;IACA;IAEAI,qBAAAC,IAAA;MACA,KAAAC,WAAA,CAAAD,IAAA;MACA,KAAAE,KAAA,CAAAC,MAAA,GAAAH,IAAA;IACA;IAEAI,uBAAAC,GAAA;MACA,KAAAX,OAAA,CAAAC,IAAA,CAAAU,GAAA;MACA,KAAA3B,cAAA;IACA;IAEA4B,iBAAA;MACA;MACA,MAAAC,IAAA,GAAAC,QAAA,CAAAC,aAAA;MACA,IAAAF,IAAA;QACAA,IAAA,CAAAG,KAAA,CAAAC,OAAA,GAAAJ,IAAA,CAAAG,KAAA,CAAAC,OAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}