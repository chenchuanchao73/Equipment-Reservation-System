{"ast":null,"code":"import { reservationApi, equipmentApi } from '@/api';\nimport { isReservationExpired } from '@/utils/date';\nexport default {\n  name: 'AdminDashboard',\n  data() {\n    return {\n      loading: false,\n      stats: {\n        totalEquipment: 0,\n        availableEquipment: 0,\n        totalReservation: 0,\n        activeReservation: 0\n      },\n      recentReservations: []\n    };\n  },\n  created() {\n    this.fetchData();\n  },\n  methods: {\n    async fetchData() {\n      this.loading = true;\n      try {\n        // 获取设备统计\n        const equipmentResponse = await equipmentApi.getEquipments({\n          limit: 1,\n          page: 1\n        });\n        this.stats.totalEquipment = equipmentResponse.data.total;\n\n        // 获取可用设备统计\n        const availableEquipmentResponse = await equipmentApi.getEquipments({\n          limit: 1,\n          page: 1,\n          status: 'available'\n        });\n        this.stats.availableEquipment = availableEquipmentResponse.data.total;\n\n        // 获取预定统计\n        const reservationResponse = await reservationApi.getReservations({\n          limit: 1,\n          page: 1\n        });\n        this.stats.totalReservation = reservationResponse.data.total;\n\n        // 获取活跃预定统计\n        const activeReservationResponse = await reservationApi.getReservations({\n          limit: 1,\n          page: 1,\n          status: 'confirmed'\n        });\n        this.stats.activeReservation = activeReservationResponse.data.total;\n\n        // 获取最近预定\n        const recentReservationsResponse = await reservationApi.getReservations({\n          limit: 10,\n          page: 1\n        });\n        this.recentReservations = recentReservationsResponse.data.items;\n      } catch (error) {\n        console.error('Failed to fetch dashboard data:', error);\n        this.$message.error(this.$t('common.error'));\n      } finally {\n        this.loading = false;\n      }\n    },\n    formatDateTime(row, column, cellValue) {\n      if (!cellValue) return '';\n      const date = new Date(cellValue);\n      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;\n    },\n    viewReservation(reservation) {\n      // 打开预定详情对话框或页面\n      this.$router.push(`/admin/reservation/${reservation.reservation_code}`);\n    }\n  }\n};","map":{"version":3,"names":["reservationApi","equipmentApi","isReservationExpired","name","data","loading","stats","totalEquipment","availableEquipment","totalReservation","activeReservation","recentReservations","created","fetchData","methods","equipmentResponse","getEquipments","limit","page","total","availableEquipmentResponse","status","reservationResponse","getReservations","activeReservationResponse","recentReservationsResponse","items","error","console","$message","$t","formatDateTime","row","column","cellValue","date","Date","getFullYear","String","getMonth","padStart","getDate","getHours","getMinutes","viewReservation","reservation","$router","push","reservation_code"],"sources":["src/views/admin/AdminDashboard.vue"],"sourcesContent":["<template>\n  <div class=\"admin-dashboard\">\n    <h1 class=\"page-title\">{{ $t('admin.dashboard') }}</h1>\n\n    <!-- 统计卡片 -->\n    <el-row :gutter=\"20\" class=\"stats-row\">\n        <el-col :xs=\"24\" :sm=\"12\" :md=\"6\">\n          <el-card shadow=\"hover\" class=\"stats-card primary\">\n            <div class=\"stats-content\">\n              <div class=\"stats-value\">{{ stats.totalEquipment }}</div>\n              <div class=\"stats-label\">{{ $t('admin.totalEquipment') }}</div>\n            </div>\n            <i class=\"el-icon-s-grid stats-icon\"></i>\n          </el-card>\n        </el-col>\n\n        <el-col :xs=\"24\" :sm=\"12\" :md=\"6\">\n          <el-card shadow=\"hover\" class=\"stats-card success\">\n            <div class=\"stats-content\">\n              <div class=\"stats-value\">{{ stats.availableEquipment }}</div>\n              <div class=\"stats-label\">{{ $t('admin.availableEquipment') }}</div>\n            </div>\n            <i class=\"el-icon-s-cooperation stats-icon\"></i>\n          </el-card>\n        </el-col>\n\n        <el-col :xs=\"24\" :sm=\"12\" :md=\"6\">\n          <el-card shadow=\"hover\" class=\"stats-card warning\">\n            <div class=\"stats-content\">\n              <div class=\"stats-value\">{{ stats.totalReservation }}</div>\n              <div class=\"stats-label\">{{ $t('admin.totalReservation') }}</div>\n            </div>\n            <i class=\"el-icon-s-order stats-icon\"></i>\n          </el-card>\n        </el-col>\n\n        <el-col :xs=\"24\" :sm=\"12\" :md=\"6\">\n          <el-card shadow=\"hover\" class=\"stats-card danger\">\n            <div class=\"stats-content\">\n              <div class=\"stats-value\">{{ stats.activeReservation }}</div>\n              <div class=\"stats-label\">{{ $t('admin.activeReservation') }}</div>\n            </div>\n            <i class=\"el-icon-s-claim stats-icon\"></i>\n          </el-card>\n        </el-col>\n      </el-row>\n\n      <!-- 最近预定 -->\n      <el-card shadow=\"hover\" class=\"recent-reservations\">\n        <div slot=\"header\" class=\"card-header\">\n          <span>{{ $t('admin.recentReservations') }}</span>\n          <el-button\n            type=\"text\"\n            @click=\"$router.push('/admin/reservation')\"\n          >\n            {{ $t('common.more') }} <i class=\"el-icon-arrow-right\"></i>\n          </el-button>\n        </div>\n\n        <div v-if=\"loading\" class=\"loading-container\">\n          <el-skeleton :rows=\"5\" animated />\n        </div>\n\n        <div v-else-if=\"recentReservations.length === 0\" class=\"empty-data\">\n          <el-empty :description=\"$t('common.noData')\"></el-empty>\n        </div>\n\n        <el-table\n          v-else\n          :data=\"recentReservations\"\n          style=\"width: 100%\"\n          :default-sort=\"{ prop: 'created_at', order: 'descending' }\"\n        >\n          <el-table-column\n            prop=\"reservation_code\"\n            :label=\"$t('reservation.code')\"\n            width=\"120\"\n          ></el-table-column>\n\n          <el-table-column\n            prop=\"equipment_name\"\n            :label=\"$t('reservation.equipmentName')\"\n            width=\"150\"\n          ></el-table-column>\n\n          <el-table-column\n            prop=\"user_name\"\n            :label=\"$t('reservation.userName')\"\n            width=\"120\"\n          ></el-table-column>\n\n          <el-table-column\n            prop=\"start_datetime\"\n            :label=\"$t('reservation.startTime')\"\n            width=\"180\"\n            :formatter=\"formatDateTime\"\n          ></el-table-column>\n\n          <el-table-column\n            prop=\"end_datetime\"\n            :label=\"$t('reservation.endTime')\"\n            width=\"180\"\n            :formatter=\"formatDateTime\"\n          ></el-table-column>\n\n          <el-table-column\n            prop=\"status\"\n            :label=\"$t('reservation.status')\"\n            width=\"100\"\n          >\n            <template slot-scope=\"scope\">\n              <el-tag\n                :type=\"getStatusType(scope.row)\"\n                size=\"small\"\n              >\n                {{ getStatusText(scope.row) }}\n              </el-tag>\n            </template>\n          </el-table-column>\n\n          <el-table-column\n            :label=\"$t('common.operation')\"\n            width=\"120\"\n          >\n            <template slot-scope=\"scope\">\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                @click=\"viewReservation(scope.row)\"\n              >\n                {{ $t('admin.viewReservation') }}\n              </el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-card>\n  </div>\n</template>\n\n<script>\nimport { reservationApi, equipmentApi } from '@/api'\nimport { isReservationExpired } from '@/utils/date'\n\nexport default {\n  name: 'AdminDashboard',\n\n  data() {\n    return {\n      loading: false,\n      stats: {\n        totalEquipment: 0,\n        availableEquipment: 0,\n        totalReservation: 0,\n        activeReservation: 0\n      },\n      recentReservations: []\n    }\n  },\n\n  created() {\n    this.fetchData()\n  },\n\n  methods: {\n    async fetchData() {\n      this.loading = true\n\n      try {\n        // 获取设备统计\n        const equipmentResponse = await equipmentApi.getEquipments({\n          limit: 1,\n          page: 1\n        })\n        this.stats.totalEquipment = equipmentResponse.data.total\n\n        // 获取可用设备统计\n        const availableEquipmentResponse = await equipmentApi.getEquipments({\n          limit: 1,\n          page: 1,\n          status: 'available'\n        })\n        this.stats.availableEquipment = availableEquipmentResponse.data.total\n\n        // 获取预定统计\n        const reservationResponse = await reservationApi.getReservations({\n          limit: 1,\n          page: 1\n        })\n        this.stats.totalReservation = reservationResponse.data.total\n\n        // 获取活跃预定统计\n        const activeReservationResponse = await reservationApi.getReservations({\n          limit: 1,\n          page: 1,\n          status: 'confirmed'\n        })\n        this.stats.activeReservation = activeReservationResponse.data.total\n\n        // 获取最近预定\n        const recentReservationsResponse = await reservationApi.getReservations({\n          limit: 10,\n          page: 1\n        })\n        this.recentReservations = recentReservationsResponse.data.items\n      } catch (error) {\n        console.error('Failed to fetch dashboard data:', error)\n        this.$message.error(this.$t('common.error'))\n      } finally {\n        this.loading = false\n      }\n    },\n\n    formatDateTime(row, column, cellValue) {\n      if (!cellValue) return ''\n\n      const date = new Date(cellValue)\n      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`\n    },\n\n    viewReservation(reservation) {\n      // 打开预定详情对话框或页面\n      this.$router.push(`/admin/reservation/${reservation.reservation_code}`)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.admin-dashboard {\n  width: 100%;\n}\n\n.page-title {\n  margin: 0 0 20px;\n  font-size: 24px;\n  color: #303133;\n}\n\n.stats-row {\n  margin-bottom: 20px;\n}\n\n.stats-card {\n  height: 100px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px;\n  position: relative;\n  overflow: hidden;\n  margin-bottom: 20px;\n}\n\n.stats-card.primary {\n  border-left: 4px solid #409EFF;\n}\n\n.stats-card.success {\n  border-left: 4px solid #67C23A;\n}\n\n.stats-card.warning {\n  border-left: 4px solid #E6A23C;\n}\n\n.stats-card.danger {\n  border-left: 4px solid #F56C6C;\n}\n\n.stats-content {\n  z-index: 1;\n}\n\n.stats-value {\n  font-size: 28px;\n  font-weight: bold;\n  color: #303133;\n  margin-bottom: 5px;\n}\n\n.stats-label {\n  font-size: 14px;\n  color: #909399;\n}\n\n.stats-icon {\n  position: absolute;\n  right: 20px;\n  font-size: 60px;\n  opacity: 0.1;\n  color: #000;\n}\n\n.recent-reservations {\n  margin-bottom: 20px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.loading-container {\n  padding: 40px 0;\n}\n\n.empty-data {\n  padding: 40px 0;\n  text-align: center;\n}\n\n@media (max-width: 768px) {\n  .stats-card {\n    height: 80px;\n  }\n\n  .stats-value {\n    font-size: 24px;\n  }\n\n  .stats-icon {\n    font-size: 40px;\n  }\n}\n</style>\n"],"mappings":"AA4IA,SAAAA,cAAA,EAAAC,YAAA;AACA,SAAAC,oBAAA;AAEA;EACAC,IAAA;EAEAC,KAAA;IACA;MACAC,OAAA;MACAC,KAAA;QACAC,cAAA;QACAC,kBAAA;QACAC,gBAAA;QACAC,iBAAA;MACA;MACAC,kBAAA;IACA;EACA;EAEAC,QAAA;IACA,KAAAC,SAAA;EACA;EAEAC,OAAA;IACA,MAAAD,UAAA;MACA,KAAAR,OAAA;MAEA;QACA;QACA,MAAAU,iBAAA,SAAAd,YAAA,CAAAe,aAAA;UACAC,KAAA;UACAC,IAAA;QACA;QACA,KAAAZ,KAAA,CAAAC,cAAA,GAAAQ,iBAAA,CAAAX,IAAA,CAAAe,KAAA;;QAEA;QACA,MAAAC,0BAAA,SAAAnB,YAAA,CAAAe,aAAA;UACAC,KAAA;UACAC,IAAA;UACAG,MAAA;QACA;QACA,KAAAf,KAAA,CAAAE,kBAAA,GAAAY,0BAAA,CAAAhB,IAAA,CAAAe,KAAA;;QAEA;QACA,MAAAG,mBAAA,SAAAtB,cAAA,CAAAuB,eAAA;UACAN,KAAA;UACAC,IAAA;QACA;QACA,KAAAZ,KAAA,CAAAG,gBAAA,GAAAa,mBAAA,CAAAlB,IAAA,CAAAe,KAAA;;QAEA;QACA,MAAAK,yBAAA,SAAAxB,cAAA,CAAAuB,eAAA;UACAN,KAAA;UACAC,IAAA;UACAG,MAAA;QACA;QACA,KAAAf,KAAA,CAAAI,iBAAA,GAAAc,yBAAA,CAAApB,IAAA,CAAAe,KAAA;;QAEA;QACA,MAAAM,0BAAA,SAAAzB,cAAA,CAAAuB,eAAA;UACAN,KAAA;UACAC,IAAA;QACA;QACA,KAAAP,kBAAA,GAAAc,0BAAA,CAAArB,IAAA,CAAAsB,KAAA;MACA,SAAAC,KAAA;QACAC,OAAA,CAAAD,KAAA,oCAAAA,KAAA;QACA,KAAAE,QAAA,CAAAF,KAAA,MAAAG,EAAA;MACA;QACA,KAAAzB,OAAA;MACA;IACA;IAEA0B,eAAAC,GAAA,EAAAC,MAAA,EAAAC,SAAA;MACA,KAAAA,SAAA;MAEA,MAAAC,IAAA,OAAAC,IAAA,CAAAF,SAAA;MACA,UAAAC,IAAA,CAAAE,WAAA,MAAAC,MAAA,CAAAH,IAAA,CAAAI,QAAA,QAAAC,QAAA,YAAAF,MAAA,CAAAH,IAAA,CAAAM,OAAA,IAAAD,QAAA,YAAAF,MAAA,CAAAH,IAAA,CAAAO,QAAA,IAAAF,QAAA,YAAAF,MAAA,CAAAH,IAAA,CAAAQ,UAAA,IAAAH,QAAA;IACA;IAEAI,gBAAAC,WAAA;MACA;MACA,KAAAC,OAAA,CAAAC,IAAA,uBAAAF,WAAA,CAAAG,gBAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}