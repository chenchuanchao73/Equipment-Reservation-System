(()=>{"use strict";var e={555:e=>{e.exports="data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxISEhUSExIWFRUXFxgYFxUWGBgYFxcYGBcXFxcVFRgYHSggGBolGxYVITEiJSkrLi4uFx8zODMtNygtLysBCgoKDg0OFxAQFSsdHR0rLS0tLS03LS0tLSsrLS0rKysrKy0tKy0tLSstLS0rKysrLS0tLS0tNy03LSstLSstLf/AABEIAMYA/wMBIgACEQEDEQH/xAAcAAEAAgIDAQAAAAAAAAAAAAAAAQcGCAIEBQP/xABNEAABAgMEBgcEBQgIBgMBAAABAAIDESEEEjFBBQYHIjJhE0JRcYGh8FJikdEUI3KCsRc1Q5KisrPSFSQzY3N0g8FThJOjwsNU4fEl/8QAFwEBAQEBAAAAAAAAAAAAAAAAAAECA//EABwRAQEBAQEAAwEAAAAAAAAAAAABAhExEiFRQf/aAAwDAQACEQMRAD8Aul7r1B31S9IXc/mjpDhx5VSkpni9SogMNzHNQ0S3jh81La8XhOigE4HD1JAcL28MFLt/DLtUE9mCOpw+MqoJvUu54Ix12hSkp9b1kjZHix50QQxt2pS7W9kpaZ8WHOi8DWzW6zaPZOM8kuncgskYj5dgybPrEgeNEHvO36jLtWJax7SdH2WbOkMaI2hhwZPkRQhz5hjTyJnyVQa2a/Wy3TaXdDAP6CGTIjsivoYndRvJYqFuZFk6U2x2t822eDCgtrV04r5ZEcLQeUisUt2umkY3HbYw5Q3dEP8AtXV4KLfIjtv0nHdxWiMeZivJ83L5tt0YYRog7nuH4FfBEHq2TWe3QjNlttA5GK9zf1Xkt8lkuitrGkYUhEMO0Nz6Rga7wdDkB4tKwVE5Beuru16xRJNtDH2ZxlU/WQp/baJjvc0Dms7sVoY9rYsN7YjHDdexwc08wRQhanr0tBaetNiffs8UsJM3Nxhv+2w0dhjiMiFm4G0hbM3ssedEfv4ZdqwPUraZBthbAjAQI5oGk/VxD/duODj7Lq1oXLPHU4fGVVizipLpgNz+SB10FpxQylMY+ppSRnioDBcxz7FEpb2WPNS0z4vOigHLq+UsqoD23qjzUvN6gUOMuHDlVS6Q4ceVUC9S7ngjDcxz7EpKfW8/gjZHi86IIaLu8cELC4zCNM8cELiOHD4oJLblcckuz3vGXcoaJVdh8UIzHD6mgkb/ACkgM931RHCfD8koRICvqaBO7u+qoRc5zQGQIOKNEuL5oF2W/wCMu9Lt+uCgCs8vWSxPaPrg3R8CbJGPEBEJhwEuKK8ey2YpmZDtIDq7RdoDLC3oYQD7S4TDTVsMHB8T/ZufIY0NbrZEjRHRYr3RIjjNz3GZPyHYBQZL5x474j3RIji97iXOe4zLicSVwXWTiCL72GxxI0RsKEx0SI6jWNEyfkOZoM1cOqOySFCuxbeeldj0LT9U3svkViH4NrKTsUt4Km0RoW02o3bPAiRSMS0bo5OeZNb4kLNtFbHrdErFiwYI7JuivHeAA34OKu2BZmsaGw2NZDbg1oDWgDINFAvq6vD45LN3VVTZdi0LB9tiE9rIbWD4Oc78V9I2xizigtcbxbDI+AA/FWlMSkBX1mgkKEVU+VFL6S2L2hgnCtcKIchEY+F+00v/AAWHab1Mt9kBdGsz7g/SQ/rGS7SWTLR9oBbMNEuL5pzy9ZJNUakAzUrYXWvZzY7befDZ0EY/pYYABd2xIdA/vo7mqS1n1ZtNgiXI7N0k3Iraw3/ZORl1TI94qtzXUeMQrV2bbS3Qy2y2195hk2HaHGrexsYnFuV/EZzFRVaK2dG28pb3qqXb296oqi2Ra8G82wWl0xhZ3url/YO/8T932VbjhOowXKzip4+Ukn1fPuR1eH5JMSl1vWagid2mOam7drjkjSBxY/FQ0S4sPigm71vGSAX+UlEs8v8AbuUuE+H5IAN7dQPu0xRxBAAxRpAo4V+KCGuvUdghdkMFN69TBRelu+E+9BLjd4UkAJjFODnNA2W96qgAAzJNVDTe4vkpLb295dyE3uUkHV0lpBkCFEixXShQ2uc4+60Tp2mkgMytZNZNNxLbaIlpiULjJrfYhidyGO4GvaSTmrL256wkCFo9hxlFjcwDKEw/eBd91vaqiXTM/oLuaI0XFtUZkCA29EeaDAAZueeq0CpP4kgLp+qV+C2F2Zan/QLP0kQf1iKA6J2sGLYI7sT2unkBK28R3tR9TrPo+FdbvRXAdJGIk557G+ywZNHeZmqyNpnQ4KSL/JL17dwXJUEyoMFLt3hP+6Xpbvn3oNznNAkAJg1RoBqTVA2W95d6EXq4IDTe4lE6yy9ZqSb/ACS91fNBDjd4fmuppfRcG0QXQYrBEY8Sc0/EEEVa4GRBFQV3A67TFA27XFBrhr5qdE0dFFS+BEJ6KIcZiphxJUDwK8wJjAgYutqNOaHhWyBEgxhNjxUZgjBzTk4EAg8lrPp/Q8Sx2iJZ4vEw0cBIPaate2eRHwMxkumb1HngkSIJBBmCDIgioIIwIOa2K2ca1m32QFxHTQ9yMO0y3YgGQcK94cMlrqsp2a6wfQrcxxMoUX6qL2Scd15+y6Rn2F3arqdg2Odu8KSEr2aDc5zS7Le8Zd65KNAdUmqhpvUcplerghdepgggnLL1mpcbvCl7q+aA3Oc0EEACYNVLWg1JqgF3eS5erggOl1ceVEpKvF58qo5t2oSUxez+SA2nF4TqoE8+H1JS3exyUB093L5IB5Yepo8jq07Th8ULru6MF4G0K3fRtHWqIHSJhOY09johENpHObwg161m0sbZa41pJmIjyW4/2Y3YYkcDcDfGa81EXZGc7INAC1W3pYgnCswEQzwMQkiE09xDn97B2q/ZV93yWE7HtFCFo5jjR0dzox7juw/C41p+8Vm17q5Lnq/ajvd8qKSRIXcUcbuCEXZOGKyFJV4vUkbTi8J1QCYvZ/JG72OSCBz4fLkjvdw5IHT3cvkjnXaBBLpdXyolJe96zRwu1CSpezQGkdbzqobPrYKWi9UqGuvUKAeXD5c1W+23V8RbO22QxvwN2JIYwnmXjdcQeQc9WQXS3cvmvhpGxsiQ3wXibIrHMeD7LgWnyJVl4NUFDhOi+1qszoUR8J3FDe6G77THFrvMFfJdUbK7PNM/S7BAivJLg3o3k4l8M3HOMvauh33lkI7er5SyotYND60W2yMMOz2l8JhcXFoaxwvEAE77TKjRh2LILJtW0mwSdEhRR/eQh/6y1YuVX+73cOVFLpHhx+CqnQ22hnDaLK5kzxwnB47yx10gdxcVYOg9YrJa237LHbE9puD2/bYZOb4hZssHqzEve9Zo2Q4vOqSpezxRu9ioIb72CEHqzkjXXqFC+7QIDWXanyQtnvZfJGz62CHlw+poJdv4Zdq6eltLQLPC6SPEbCYKXnmQJ7GjFxPYBNYxr/r9B0cOjhSi2lwpDmbrAcHxSMOTRU8hVUTprTEe1xTGtEQxH5To1o9ljRRo7vGZWpnotHTm2VrZssUC9jKLGmG8i2E3eI7y08lXuntcbdbGlkeOTDJB6JrWtZNpmKATMjWpK8JFuSRBcYrpAnsBK5LlCAvNnhMT7p1VG1WirIIcCDAaJCHDYwdzGhuXcu3epdzR0urikhL3lxUbu4qA27vFS2XWUN97BALZ72XyUu3sMlB5cPqal3u+MkC9MXc/kgddoUMpU4vU0EutigNFypUS62SN97zT93yQHNv1CkuvUCO93DkhA6uKADIXc/mjd3HNABKvF6kjfe8JoNcNp9l6PSlqEpBzmRB9+GxxP6xcsXV1a+bOLRbrY60Q4sJjCxjZPvzm0ETo0jsWO/katn/yLP8A9z+RdZqcRW6KxY+xy3ATZGs7z2TiDzuFeFpPZ5pOBMmzGIBnBc2J+y03/wBlOwYuvpZ474bmvY5zHtM2vYS1wPJwqFwe0glpBDgZFpEiD2EGoKhUWtqXtXcHNhW/eEwBaGiRH+M0Yj3mjsmMSrfhxGxQHsIc0gEOBmHA1BBFCFqUs02ea+RNHv6KIXPsrjvNxMInGJDHZ7TM8RXixcq2DLrwkEa+7Qr5wYrHsa+G4ODgHNc0zDmkTDgcCCvo0DrYrAB16iwzaVrqNHQeihydaYgPRg1DG5xXjyAzPIFZNpvSkKzwIkd5kyG0vd2kDBre1xJAA7SFrHpzSsS1x4loinfiGcpzDRg1jfdAkPPErWZ0dWPHc9znvcXOcSXOcZlxOJJzK+aLuaH0VGtUZsCAy/Ed4BoGL3nqtExM8wKkgHojpjIZkgAZkmgA7Ss01f2YaQtUnOY2zsOcYkPl2iGAXeDrqtXUvUKz2BoeAIseW9HcKjtEJvUb5nM9mXO3uELF3+CqrHsWhYRbZEJ7YbGMHwffXZi7F7EKfSbVh7UEf+pWYTS7KqAhtCs/KqXblcUu0veMlDRdxSWeSgkC/wApKA69uqXC9ghMwABVBBdLd9VUnc5zSYAkRX1JeDrdrRB0bBMSLvPdMQoQO9EcP3WiYm7LmSAQ5a16z2fR0IRoziXOn0cJsr7znLsaJ1caCYzIBrCLtmtRfeFlgBnsF0Qu/wCpMD9hYHp7TMa2RnWiO6892A6rG5MYOq0T/EmZJK89dJlGympmuUDSbDc+risG/BcZuGV5p6zOfxAWRz6nmtUdGaQi2eKyPBeWRGGbXDzBGbTgRmth9RdcoOkYMgAy0NA6SF2e+ydSw+WB551nisnJuUxS7dqjTd4goa27U4LIkNnveXcgF/lJRKt7JS7e4UC9Pd9UUE3d1STMSAqgIAkcUAi5zmhbIXvLvUN3eJAOtkg8jT+q9k0g2VohNJAk2I3diNz3XivgZg5gqj9d9QI9gnEaTGs3/ElvQ+wRmjD7QoeRIB2HcL1RgojMbEBZdBBBDgQCCCJEEHEVwWpeDUpFmu03Uz6BGESEP6tFO7/dPqTCPKQJaewEZTOFLpEWjsa1vMOILBFdNj5mAT1XmZdCn2OqRzmOsFcwh3qzWpLHlpDmktc0gtcMWuBmHDmCAfBbNam6Z+nWOFaRIOc27EApKI3deAOyYmORCxqKwLbtpkBsGxMPF9dFkcgS2E08i4Pd3saqhWSbRtIdPpK0unMMidE3kIX1ZA5XmvPisbWpORAA4AEnIATJPYAMStidnGqTbBZwHgdPFAdGd2YlsIH2WzPeSTmqr2RaDFq0g1zhNkBpjHsLwQ2ED943v9NbBXr2759yzq/wQTKgwUupw/NQHXZt9VU8HOawoZSn1vWSAA8WPwS7Lf8AGXehF6uCCGmfFh8Enll6zU3r1MEvdXzQHGXD80MhUYpO5zmvB1v1ng6Ng9LEN57piFBBk6I6Xk0TE3ZcyQCDXDWmBo+B0sXeiOmIUIGTojh+60Um7LmSAddtPaajWyM6PHdee6g9lrRgxgyaJn4kmZJKae01Htkd1ojuvPdkKNY3JjBk0fMmZJK89dJOIIiLQLtaL0jFs0VkeC8siMM2uHmCM2kUIOK6qINkNRNcYOkoUzJkdgHSQp4e+z2mE/DA88maZ0dh8FqnozSMWzxWxoLyyIwzDh5gjNpwIOK2H1G1yhaThUAhx2AdLCnhlfZ2sPlgefPWeKyWeQ4fWalxlw+OaXpbvn3pwc5rIGQExj6yShEzil2W95d6EXt71RBDa8XyQHLq+s1PHykl6e74T7kEOMuHD4qXADhx+KXrtMc0ldrig87WHQ8K2WaLZ4v6Rsp5tcDNjwO1rgD4LV612V8KI+FEEnw3OY4djmktMuUwtsrvW8lQO2WwdHpJ0QNkI8NkTleE4bgPBjT95bxRgytXYTpctfaLJPiAjMHNsocT4gwv1VVSyXZvpE2fSMCJl9YHDtBhPp+sGnwWr4jwbdHvxYj/AG4j3/rOLv8AdfBcorLrnNOIJB7wZFcVRcWwWyfU2qKBV0RkOfJjL4/in4K1aSkMfU6qsdg8aVltLRj9In4GFDA/dKs6QAvA1XLXqgIlI4o0S4vOqATF44o03sclBEs+r6yRwnw4fBJz3cvkjjdoEEukeHHlRKSl1vWaOF2oK8XW3WGFYLM60xKundZDBkYkQzutHYJAknIAlB89btaIOjoJiRt97piFCnvRHDn1WiYm7LmSAddtO6ajWyM6PHfee6gA4WNGDGDJomfMmZJKad03HtkZ1ojuvPdSQo1jRgxg6rRP8SZkkrz10zOAuUKG5zg1oLnOIDWgTLiTIAAVJJySHDLiGtBc5xAa0AkkkyAAFSScle2zjUEWENtMcB1qcKChEAEVa3teQZF3gKTLrbxFN6x6Ci2KKyDGl0joTIrmity+Xi4TmRcqRSZlWUz5azzbX+cx/loX78ZYGrB6ermhX22OLPDcGvc15aXcJLGF4aSMAZSnWU8CujarM+E90KIwsiMN1zHULSMj+M8CCCKFZZsibPSsD7MX+E9WltD1GZpBl+HJlpYJMeaCIBXo4ssux2LSeyYMuuUa+LtaL0jFs0VkeC8siMM2uHmCM2nAjNfK12Z8J7oURhZEYS17HULSMj88CCCKL5KjZDUTXKDpGDOQZaGD6yFmMg9hzYTnlgeeTtpxeE6rVLRekYtmisjwXlkRhm1w8wRm0ihBxWxeoutLNJwOklciMIbFhjqulObZ4tcKjxGS56zxWQgHE4epUQjMYIDPdOHyRzpUGCyJdXh8ZUSkpdb1OqOF3DNRKQvZoJbIcWPxUNBHFh8VLReqVDTeoUAjPq+slT+31o6WxuHsRwfB0Ej8T8VcE+rkqX28R2m1WaEDMsgvef8AUeAP4RWs+isVyhRC0gihH/4uK7uhbCY8dkEYvveTHO/8V0R2dbbH0NutUM5R4hH2XOL2fsuavJVj7cNE9HbIdpaNyOyRP95CkDM82FkvslVwk8Fl7CtKiHao8A/poYc37UImg5lsRx+4rraJb3qq1T0TpB9mjQ7RD44Tw4dhli08nNJaeTitntB6Vh2qBDtEN04cRsxyOBY7sc0ggjtCxqK7xbe3vVFLjfwyUHlgpd7vjJYC91fVEDrtClJe95zzRsutjzQALtSqq29w3mFZIg/s+kiB323NaWeTIvxVqN97BdHTeiYVrgvgRm3oT8ciJGYc05OBqCrLyjVdcocMuIa1pc5xAa1oJLiTIAAVJJyVm23YxaA89BaoT2ToYgex4HYQ0OBPOncFmWo+zuDYD0zn9Paayfduthg0IhtJMjKhcTPskCZ7+UR1dm2oLbEBHtDQ61OFBQtgBw4W5F8jIu8BSZdYA3Mc1AlKvF6kpb73hNc7eqoPbX+c++zQj+3GWCLO9tf5z/5eFLuvxlgi7TxGYbI2z0rAHuxf4T1sPepdWvGySf8ASsCXsxf4T1sPSXvLnv1WF7RNRGW9l9l1lqYNx/Ve0foovLGTsWk9kwaBtdmfCe6FEYWRGG69jqFpGR+eBBBFFtk2XW81iOu+ocHSIDy7oY7RJsYCcxkyI2l9vZUEdsiQWdcGuytPYLAeYtrcOC5CBORdeeWjmQL3x5r4WfYzai/ftMFsOfE0Pc6X2SGif3lauregINhgNgWcGQ3nuNXPeZTe8jE0A7AAAKBXWvpHrF0931RL13dQylTi9TQSlXH1JYUAuY1ml2W9lj8Ub73goH7PlyQSW3qhCb1Aod7uCl0urjyQL3UWtGv2mBa7fHitM2B3Rw+y5DF2Y7Q5wc776t/arrULHZTBY7+sxwWtljDZg+KeylBzM+qVr+BKi3mIlZzsa0Z02kmvIm2DDiPJym4dE0HvER5+6sGV4bFNCOhWR9pIIdaHbtJHooc2t+LjEPcQtav0Mk2g6tfTbE+E3+0G/BJ/4jQZCeV4FzPvLWsgihBBFCCJEEUIIOBByW2zW3alU5th1MLHO0jAb9W4/wBYaOo7Dppeyet2GuZIzmqqxZhs812do+IWRLzrLEIL2iphuw6WGM6SDm5gCVRI4ei3Z1G19itsOLDa+E9sSG8Ta9pmCD2ELsOFzxWsmq+tlq0e4mA/ccZvhP3obucp7rpdYEHCc8FbGr21yxRKWlr7O+gqDEhknse0TA+00DmudzVWHdpe8figbeqvLsOn7JF3oVqgPHY2IwnxE6LuPtcN1REYO9zfmsjsNN6hUXuqvi+2wnUD2Dvc35p9NhSu9Iyfbeb80H3JueKFt2TlwgRW5EOHa0gju/Bcmtu1OCCbswXeqIN/HJQRPey+Sl29ggoPbX+c+6zQh+3GWCLO9tn5zH+Whfvxlgi7TxGYbI3S0rA+zF/hPWw92l5a87IjLSsD7MX+E9bC3etkue/VS0X6lGuvURwvVCE3qBZC9Ld9VR25hmuL4jWiTiBzMgK4VK+LbdCbjEZX3m/NB2C2QveqoGzBd6ouqLfBFTFhy+235qHaRgkz6aH+u35oO2038clF6e74fBdKPpizSn9IggDEmIwD8V4uk9oejILZG1Me4UlBnFMxlOHMDxIV4MnJu0CxvXTXGBoyHNxESO4fVwAd49jnnqMmMT4TKrzWLbBFe0ssULoQf0sW66J91gmxp5ku7lWlpjuiPdEiOc97jNz3Elzj2kmp/wDpamf0djTGlI1qjPtEd96I8zJwAGTGDqtAoB+JmV00XOBBc9zWMaXPcQ1rWiZc40AA7VtHp6q6Bfb7VDszJi8ZveOpDEr7++RkOZaFs5ZoTYLGwobQ1jGhrWjBrWgBrRyAAWLbOdUG2CzydI2mLIxXDAS4YTTm1szXMknCQGXNeG0IXPV6qGkniw50XGI0GbSJsNCCJgg4gzxGK53r9MM0nLd8J96yKP2ibNnWYutFjaX2fF0JtXQOYGLofm3mKitwexbccHOawLXDZbZrVONAIs8Z1Tdb9U8kzJewYOx3myxJIctzX6KFRe9p7U63WOZjQHFg/Sw5xIfeXATaPtBq8AEHBbQc0HELiYLfZHwC5og4dE32R8AnRN9kfBc0QXjsHht+gRsB/Wn8v0MBWK0k8WHwVd7Coc7BG/zT/wCDAVi3r27guWvVQTkOH1Oql1OHxlVJy3fPvTg5zUFCba/zmP8ALQp/rxlgazvbX+cxzs0I/txlgi7TxGY7IgP6VgT9mL/CethZ5dX/AG71r1sjbPSsAe7F/hPWws+r4TXPXqjjLh+akgDhx+KTuUxS7drisjCdsbQdExp434E/+vDyWvYhN9kfALYTbGP/AOVGd2vgU/14YWvy6Z8Rw6Mdg+Cnox2D4Lki0ON0di5IiAi+lmgPiODIbHRHnBjGlzj91oJWe6sbJ7XaCHWkizQ+wydFI5NBkzvcZj2U7wYNo+wxY8RsKDDdEiOwY3E9pOQAzJkAr22e6gssAEaIWxLURVzashA4shzGPa7PKQnPIdXNWrLYGGFZ4YaXSD4hrEfze7PE0EgJ0AXscHOa53XVDIcOPxRoB4sfgl27vIGXq4LIPINGivwQSlI8XqVUeA2oNUAmL2fyQG04vDNQBKpw9SopbvYqAZ0OCAa1GC8XS2qOj7USYlkhOceJ4bcee97JO817TnSoMFLt3hQYJG2TaMNGsjMPY2K4/v3l8hsh0cOJ1on/AIjf9mLP5CV7PFSAHVJV7RX/AOSHR44jaP8AqN/kT8kOj8Z2iX+I3+RZ+03uJJ9XJO0ePqxq1BsMJ0GzF5Y55iG+4E3i1rcQBSTB5r2SQQAMUcbuCESkRioEwBI4+pI2nF4ZpIETOPyRpvYoKD21/nP/AJaF+/GWCLPttsMjSTXS3TZocj23YkYEfh8QsBXaeIzDZGD/AErAl7MX+E9bDzEpdb1mtetkIP8ASkEgYMik8h0bhP4uA8VsLISvZrnv1RpA4vmoaCKuw+KlovcRUNdeocFkebrFoOFbYDoEW8ITi0m4Q07jg4Soc29ixL8kOjjwutB/1G/yLP5y3RgpcbuGavaK/wDyRaOwDrRP/Eb/ACJ+SLRwxdaJ/wCI3+RWAQAJjFAARM4p8qK+/JBo4cTrRy+sb/Iu9o7ZfoyEbxgOi84r3OEvsAhp8QszbvYqAa3ck7R1rDo6FBbcs8JkJg6sNrWD4Nku04z4fkoc67QKXSbUKBMSl1vWaNpxfNJUvTqjd7iQQ0SqcELSatw+CNM6HBC4toMEE3blcclEp73jLuUogEXuUkvT3fVERAnd3fVUG5zmiIAb1vGXejm3q4IiCS69TBRe6qIgA3OaBt3eREAtnveqI7f5SREGK6+6ns0nCYy90ceET0USUxUbzHjG6ZDCoIB7QaHtOr8aHafojjD6ScpguuT7y2fkiLeaLw2d6jDRjXRIjhEtEQXXObO6xs53GTEyJgEkgTkKCSzK71vJEWbQIv1wQuvURFAvS3fPvRu5zmiIAbLe9VQtvbyIgl2/ykonS74TREAOuUxQC7XFEQLvW8kIv8pIiBevSapD7tERB//Z"},1981:(e,t,a)=>{function s(e){if(!e)return null;const t=new Date(e);if(isNaN(t.getTime()))return null;const a=t.getTime(),s=a+288e5;return new Date(s)}function r(e,t="YYYY-MM-DD HH:mm:ss",a=!0){if(!e)return"";let r=new Date(e);if(isNaN(r.getTime()))return"";a&&(r=s(r));const i=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getDate()).padStart(2,"0"),l=String(r.getHours()).padStart(2,"0"),c=String(r.getMinutes()).padStart(2,"0"),u=String(r.getSeconds()).padStart(2,"0");return t.replace("YYYY",i).replace("MM",n).replace("DD",o).replace("HH",l).replace("mm",c).replace("ss",u)}function i(e){const t=new Date,a=new Date(e);if(isNaN(a.getTime()))return!1;const s=t>a;return s}a.d(t,{Gl:()=>i,Yq:()=>r})},2465:(e,t,a)=>{var s=a(6848),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("el-container",[e.isAdminRoute?e._e():t("el-header",[t("app-header")],1),t("el-main",[t("router-view")],1),e.isAdminRoute?e._e():t("el-footer",[t("app-footer")],1)],1)],1)},i=[],n=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"app-header desktop-nav"},[t("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal",router:"","background-color":"#FFFFFF","text-color":"#333333","active-text-color":"#409EFF"}},[t("el-menu-item",{attrs:{index:"/"}},[t("i",{staticClass:"el-icon-s-home"}),t("span",[e._v(e._s(e.$t("nav.home")))])]),t("el-menu-item",{attrs:{index:"/equipment"}},[t("i",{staticClass:"el-icon-s-grid"}),t("span",[e._v(e._s(e.$t("nav.equipment")))])]),t("el-menu-item",{attrs:{index:"/reservation/query"}},[t("i",{staticClass:"el-icon-s-order"}),t("span",[e._v(e._s(e.$t("nav.reservation")))])]),t("el-menu-item",{attrs:{index:"/calendar"}},[t("i",{staticClass:"el-icon-date"}),t("span",[e._v(e._s(e.$t("nav.calendar")))])]),t("div",{staticClass:"right-menu"},[t("div",{staticClass:"language-switcher"},[t("button",{staticClass:"lang-btn",class:{active:"zh-CN"===e.currentLanguage},on:{click:function(t){return e.handleLanguageChange("zh-CN")}}},[e._v(" 中文 ")]),t("span",{staticClass:"divider"},[e._v("|")]),t("button",{staticClass:"lang-btn",class:{active:"en"===e.currentLanguage},on:{click:function(t){return e.handleLanguageChange("en")}}},[e._v(" English ")])]),e.isLoggedIn?t("el-button",{staticClass:"admin-button",staticStyle:{"min-width":"100px"},attrs:{type:"primary",plain:"",size:"small"},on:{click:e.goToAdmin}},[t("i",{staticClass:"el-icon-s-tools"}),e._v(" "+e._s(e.$t("nav.admin"))+" ")]):t("el-button",{staticClass:"login-button",staticStyle:{"min-width":"100px"},attrs:{type:"text"},on:{click:e.goToLogin}},[t("i",{staticClass:"el-icon-s-custom"}),e._v(" "+e._s(e.$t("nav.login"))+" ")])],1)],1)],1),t("mobile-nav",{staticClass:"mobile-nav"})],1)},o=[],l=a(3518),c=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mobile-nav"},[e.isOpen?t("div",{staticClass:"mobile-nav-overlay",on:{click:e.closeMenu}}):e._e(),t("div",{staticClass:"mobile-nav-toggle",on:{click:e.toggleMenu}},[t("i",{class:e.isOpen?"el-icon-close":"el-icon-menu"})]),t("div",{staticClass:"mobile-nav-menu",class:{"mobile-nav-menu-open":e.isOpen}},[t("div",{staticClass:"mobile-nav-header"},[t("img",{staticClass:"mobile-nav-logo",attrs:{src:a(3914),alt:"Logo"}}),t("h3",{staticClass:"mobile-nav-title"},[e._v(e._s(e.$t("common.appName")))])]),t("el-menu",{staticClass:"mobile-nav-list",attrs:{"default-active":e.activeRoute,"background-color":"#304156","text-color":"#bfcbd9","active-text-color":"#409EFF"},on:{select:e.handleSelect}},[t("el-menu-item",{attrs:{index:"/"}},[t("i",{staticClass:"el-icon-s-home"}),t("span",[e._v(e._s(e.$t("nav.home")))])]),t("el-menu-item",{attrs:{index:"/equipment"}},[t("i",{staticClass:"el-icon-s-grid"}),t("span",[e._v(e._s(e.$t("nav.equipment")))])]),t("el-menu-item",{attrs:{index:"/reservation/query"}},[t("i",{staticClass:"el-icon-s-order"}),t("span",[e._v(e._s(e.$t("nav.reservation")))])]),t("el-menu-item",{attrs:{index:"/calendar"}},[t("i",{staticClass:"el-icon-date"}),t("span",[e._v(e._s(e.$t("nav.calendar")))])]),t("el-menu-item",{attrs:{index:"/admin/login"}},[t("i",{staticClass:"el-icon-s-custom"}),t("span",[e._v(e._s(e.$t("nav.admin")))])])],1),t("div",{staticClass:"mobile-nav-footer"},[t("language-switcher")],1)],1)])},u=[],d=function(){var e=this,t=e._self._c;return t("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleLanguageChange}},[t("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s("zh-CN"===e.currentLanguage?"中文":"English")+" "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"zh-CN"}},[e._v("中文")]),t("el-dropdown-item",{attrs:{command:"en"}},[e._v("English")])],1)],1)},m=[];const p={name:"LanguageSwitcher",computed:{...(0,l.L8)(["getLanguage"]),currentLanguage(){return this.getLanguage}},methods:{...(0,l.i0)(["setLanguage"]),handleLanguageChange(e){this.setLanguage(e),this.$i18n.locale=e}}},g=p;var h=a(1656),v=(0,h.A)(g,d,m,!1,null,"39411cdf",null);const f=v.exports,_={name:"MobileNav",components:{LanguageSwitcher:f},data(){return{isOpen:!1}},computed:{activeRoute(){return this.$route.path}},methods:{toggleMenu(){this.isOpen=!this.isOpen,this.isOpen?document.body.style.overflow="hidden":document.body.style.overflow=""},closeMenu(){this.isOpen=!1,document.body.style.overflow=""},handleSelect(e){this.$router.push(e),this.closeMenu()}},watch:{$route(){this.closeMenu()}},beforeDestroy(){document.body.style.overflow=""}},b=_;var y=(0,h.A)(b,c,u,!1,null,"4b3e5ca8",null);const $=y.exports,w={name:"AppHeader",components:{MobileNav:$},computed:{...(0,l.L8)(["isLoggedIn","getLanguage"]),activeIndex(){return this.$route.path},currentLanguage(){return this.getLanguage}},methods:{...(0,l.i0)(["setLanguage"]),goToAdmin(){this.$router.push("/admin/dashboard")},goToLogin(){this.$router.push("/admin/login")},handleLanguageChange(e){this.setLanguage(e),this.$i18n.locale=e}}},S=w;var C=(0,h.A)(S,n,o,!1,null,"cd511ec2",null);const q=C.exports;var T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-footer"},[t("div",{staticClass:"footer-content"},[t("div",{staticClass:"footer-content-inner"},[t("p",[e._v("© "+e._s(e.currentYear)+" "+e._s(e.$t("common.appName")))])])])])},R=[];const k={name:"AppFooter",computed:{currentYear(){return(new Date).getFullYear()}}},D=k;var x=(0,h.A)(D,T,R,!1,null,"e143ce64",null);const E=x.exports,A={name:"App",components:{AppHeader:q,AppFooter:E},computed:{isAdminRoute(){return this.$route.path.startsWith("/admin")}}},F=A;var I=(0,h.A)(F,r,i,!1,null,null,null);const L=I.exports;var N=a(6178),P=a(4373);s["default"].use(l.Ay);const O=new l.Ay.Store({state:{token:localStorage.getItem("token")||"",user:JSON.parse(localStorage.getItem("user")||"{}"),equipments:[],equipmentTotal:0,equipmentCategories:[],reservations:[],reservationTotal:0,settings:{},loading:!1,language:localStorage.getItem("language")||"zh-CN"},getters:{isLoggedIn:e=>!!e.token,currentUser:e=>e.user,isAdmin:e=>e.user&&"admin"===e.user.role,isSuperAdmin:e=>e.user&&"superadmin"===e.user.role,getEquipments:e=>e.equipments,getEquipmentTotal:e=>e.equipmentTotal,getEquipmentCategories:e=>e.equipmentCategories,getReservations:e=>e.reservations,getReservationTotal:e=>e.reservationTotal,getSettings:e=>e.settings,isLoading:e=>e.loading,getLanguage:e=>e.language},mutations:{SET_TOKEN(e,t){e.token=t},SET_USER(e,t){e.user=t},CLEAR_AUTH(e){e.token="",e.user={}},SET_EQUIPMENTS(e,{items:t,total:a}){e.equipments=t,e.equipmentTotal=a},SET_EQUIPMENT_CATEGORIES(e,t){e.equipmentCategories=t},SET_RESERVATIONS(e,{items:t,total:a}){e.reservations=t,e.reservationTotal=a},SET_SETTINGS(e,t){e.settings=t},SET_LOADING(e,t){e.loading=t},SET_LANGUAGE(e,t){e.language=t,localStorage.setItem("language",t)}},actions:{async login({commit:e},t){try{e("SET_LOADING",!0);const a=new URLSearchParams;a.append("username",t.username),a.append("password",t.password),console.log("Sending login request to:",P.A.defaults.baseURL+"/api/admin/login"),console.log("Login credentials:",{username:t.username,password:"******"});const s=await P.A.post("/api/admin/login",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:3e4}),r=s.data.access_token,i={id:s.data.admin_id,username:s.data.username,name:s.data.name,role:s.data.role};return e("SET_TOKEN",r),e("SET_USER",i),localStorage.setItem("token",r),localStorage.setItem("user",JSON.stringify(i)),!0}catch(a){return console.error("Login error:",a),a.response?console.error("Error response:",{status:a.response.status,data:a.response.data,headers:a.response.headers}):a.request?(console.error("No response received:",a.request),console.log("Is backend server running at",P.A.defaults.baseURL,"?")):console.error("Request error:",a.message),!1}finally{e("SET_LOADING",!1)}},logout({commit:e}){e("CLEAR_AUTH"),localStorage.removeItem("token"),localStorage.removeItem("user")},async fetchEquipments({commit:e},{page:t=1,limit:a=10,category:s=null,status:r=null,search:i=null}){try{e("SET_LOADING",!0);const n={skip:(t-1)*a,limit:a,category:s,status:r,search:i},o=await P.A.get("/api/equipment",{params:n});return e("SET_EQUIPMENTS",o.data),o.data}catch(n){return console.error("Fetch equipments error:",n),{items:[],total:0}}finally{e("SET_LOADING",!1)}},async fetchEquipmentCategories({commit:e}){try{e("SET_LOADING",!0);const t=await P.A.get("/api/equipment/categories");return e("SET_EQUIPMENT_CATEGORIES",t.data.categories),t.data.categories}catch(t){return console.error("Fetch equipment categories error:",t),[]}finally{e("SET_LOADING",!1)}},async fetchReservations({commit:e},{page:t=1,limit:a=10,equipmentId:s=null,userName:r=null,status:i=null,fromDate:n=null,toDate:o=null}){try{e("SET_LOADING",!0);const l={skip:(t-1)*a,limit:a,equipment_id:s,user_name:r,status:i,from_date:n,to_date:o},c=await P.A.get("/api/reservation",{params:l});return e("SET_RESERVATIONS",c.data),c.data}catch(l){return console.error("Fetch reservations error:",l),{items:[],total:0}}finally{e("SET_LOADING",!1)}},async fetchSettings({commit:e}){try{e("SET_LOADING",!0);const t=await P.A.get("/api/admin/settings");return e("SET_SETTINGS",t.data),t.data}catch(t){return console.error("Fetch settings error:",t),{}}finally{e("SET_LOADING",!1)}},setLanguage({commit:e},t){e("SET_LANGUAGE",t)}},modules:{}});var z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home-page"},[t("div",{staticClass:"banner"},[t("h1",[e._v(e._s(e.$t("home.welcome")))]),t("p",{staticClass:"description"},[e._v(e._s(e.$t("home.description")))])]),t("div",{staticClass:"features"},[t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{xs:24,sm:12}},[t("div",{staticClass:"feature-card"},[t("i",{staticClass:"el-icon-view feature-icon"}),t("h3",[e._v(e._s(e.$t("home.viewReservations")))]),t("p",[e._v(e._s(e.$t("home.viewReservationsDesc")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.goToEquipment}},[t("i",{staticClass:"el-icon-view"}),e._v(" "+e._s(e.$t("home.browseEquipment"))+" "),t("i",{staticClass:"el-icon-arrow-right"})])],1)]),t("el-col",{attrs:{xs:24,sm:12}},[t("div",{staticClass:"feature-card"},[t("i",{staticClass:"el-icon-s-order feature-icon"}),t("h3",[e._v(e._s(e.$t("home.myReservations")))]),t("p",[e._v(e._s(e.$t("home.myReservationsDesc")))]),t("el-button",{attrs:{type:"success"},on:{click:e.goToReservationManage}},[t("i",{staticClass:"el-icon-s-order"}),e._v(" "+e._s(e.$t("home.manageReservations"))+" "),t("i",{staticClass:"el-icon-arrow-right"})])],1)])],1)],1),t("div",{staticClass:"public-query-section"},[t("h2",[e._v(e._s(e.$t("home.publicQuery")))]),t("el-form",{staticClass:"query-form",attrs:{model:e.queryForm,"label-position":"top"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:8}},[t("el-form-item",{attrs:{label:e.$t("equipment.category")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("common.all")+" "+e.$t("equipment.category"),clearable:""},on:{change:e.handleQuery},model:{value:e.queryForm.category,callback:function(t){e.$set(e.queryForm,"category",t)},expression:"queryForm.category"}},e._l(e.categories,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),t("el-col",{attrs:{xs:24,sm:8}},[t("el-form-item",{attrs:{label:e.$t("common.status")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("common.all")+" "+e.$t("common.status"),clearable:""},on:{change:e.handleQuery},model:{value:e.queryForm.status,callback:function(t){e.$set(e.queryForm,"status",t)},expression:"queryForm.status"}},[t("el-option",{attrs:{label:e.$t("reservation.statusConfirmed"),value:"confirmed"}}),t("el-option",{attrs:{label:e.$t("reservation.statusInUse"),value:"in_use"}}),t("el-option",{attrs:{label:e.$t("reservation.statusExpired"),value:"expired"}}),t("el-option",{attrs:{label:e.$t("reservation.statusCancelled"),value:"cancelled"}})],1)],1)],1),t("el-col",{attrs:{xs:24,sm:8}},[t("el-form-item",{attrs:{label:e.$t("reservation.dateRange")}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"-","start-placeholder":e.$t("reservation.startDate"),"end-placeholder":e.$t("reservation.endDate")},on:{change:e.handleQuery},model:{value:e.queryForm.dateRange,callback:function(t){e.$set(e.queryForm,"dateRange",t)},expression:"queryForm.dateRange"}})],1)],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search",loading:e.loading},on:{click:e.handleQuery}},[e._v(" "+e._s(e.$t("common.search"))+" ")]),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.resetQuery}},[e._v(e._s(e.$t("common.reset")))])],1)],1),e.reservations.length>0?t("div",{staticClass:"query-results"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.paginatedReservations,"default-sort":{prop:"id",order:"descending"},border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"id",label:e.$t("common.id"),"min-width":"80",sortable:""}}),t("el-table-column",{attrs:{prop:"equipment_name",label:e.$t("equipment.name"),"min-width":"120"}}),t("el-table-column",{attrs:{prop:"equipment_category",label:e.$t("equipment.category"),"min-width":"180"}}),t("el-table-column",{attrs:{prop:"user_name",label:e.$t("reservation.reserver"),"min-width":"100"}}),t("el-table-column",{attrs:{prop:"user_department",label:e.$t("reservation.department"),"min-width":"100"}}),t("el-table-column",{attrs:{prop:"start_datetime",label:e.$t("reservation.startTime"),"min-width":"120",formatter:e.formatDateTime,sortable:""}}),t("el-table-column",{attrs:{prop:"end_datetime",label:e.$t("reservation.endTime"),"min-width":"120",formatter:e.formatDateTime,sortable:""}}),t("el-table-column",{attrs:{prop:"status",label:e.$t("common.status"),width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{staticStyle:{"font-weight":"bold",padding:"0px 10px","font-size":"14px"},attrs:{type:e.getStatusType(a.row),size:"medium"}},[e._v(" "+e._s(e.getStatusText(a.row))+" ")])]}}],null,!1,3055268523)})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.reservations.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1):e.querySubmitted?t("div",{staticClass:"no-results"},[t("el-empty",{attrs:{description:e.$t("reservation.noRecordsFound")}})],1):e._e()],1)])},M=[];function U(e,t="YYYY-MM-DD HH:mm"){if(!e)return"";const a=new Date(e);if(isNaN(a.getTime()))return"";const s=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),i=String(a.getDate()).padStart(2,"0"),n=String(a.getHours()).padStart(2,"0"),o=String(a.getMinutes()).padStart(2,"0"),l=String(a.getSeconds()).padStart(2,"0");return t.replace("YYYY",s).replace("MM",r).replace("DD",i).replace("HH",n).replace("mm",o).replace("ss",l)}const B={getEquipments(e){return P.A.get("/api/equipment",{params:e})},getEquipment(e){return P.A.get(`/api/equipment/${e}`)},getCategories(){return P.A.get("/api/equipment/categories")},getAvailability(e,t,a){return P.A.get(`/api/equipment/${e}/availability`,{params:{start_date:t,end_date:a}})},createEquipment(e){return P.A.post("/api/equipment",e)},updateEquipment(e,t){return P.A.put(`/api/equipment/${e}`,t)},deleteEquipment(e){return P.A.delete(`/api/equipment/${e}`)}};var W=a(8650);const H={getEquipments(e){return P.A.get("/api/equipment",{params:e})},getEquipment(e){return P.A.get(`/api/equipment/${e}`)},getCategories(){return P.A.get("/api/equipment/categories")},getAvailability(e,t,a){return P.A.get(`/api/equipment/${e}/availability`,{params:{start_date:t,end_date:a}})},createEquipment(e){return P.A.post("/api/equipment",e)},updateEquipment(e,t){return P.A.put(`/api/equipment/${e}`,t)},deleteEquipment(e){return P.A.delete(`/api/equipment/${e}`)}},Q={getCategories(e){return P.A.get("/api/equipment-categories",{params:e})},getAllCategories(){return P.A.get("/api/equipment-categories/all")},getCategory(e){return P.A.get(`/api/equipment-categories/${e}`)},createCategory(e){return P.A.post("/api/equipment-categories",e)},updateCategory(e,t){return P.A.put(`/api/equipment-categories/${e}`,t)},deleteCategory(e){return P.A.delete(`/api/equipment-categories/${e}`)}},j={createReservation(e){return P.A.post("/api/reservation",e)},getReservations(e){return P.A.get("/api/reservation",{params:e})},getReservation(e){return P.A.get(`/api/reservation/${e}`)},getReservationByNumber(e){const t=(new Date).getTime(),a=`/api/reservation/number/${e}?_t=${t}`;return console.log(`通过预约序号获取预约详情URL: ${a}`),P.A.get(a)},getReservationByCode(e,t=null){const a=(new Date).getTime();let s=e.includes("?")?`${e}&_t=${a}`:`/api/reservation/code/${e}?_t=${a}`;if(t)if("object"===typeof t)console.warn("预约序号参数是对象类型，将被忽略:",t);else{const e=String(t);s+=`&reservation_number=${encodeURIComponent(e)}`,console.log(`添加预约序号参数: ${e}`),console.log("预约序号类型: "+typeof t)}return console.log(`获取预约详情URL: ${s}`),P.A.get(s)},updateReservation(e,t){return P.A.put(`/api/reservation/code/${e}`,t)},cancelReservation(e,t){return P.A.post(`/api/reservation/cancel/code/${e}`,t)},getReservationQrcode(e){return P.A.get(`/api/reservation/qrcode/${e}`)}},V={createRecurringReservation(e){return P.A.post("/api/recurring-reservation",e)},getRecurringReservations(e){return P.A.get("/api/recurring-reservation",{params:e})},getRecurringReservation(e){return P.A.get(`/api/recurring-reservation/${e}`)},getRecurringReservationByCode(e){return P.A.get(`/api/recurring-reservation/code/${e}`)},updateRecurringReservation(e,t,a=1){return P.A.put(`/api/recurring-reservation/${e}`,t,{params:{update_future_only:a}})},cancelRecurringReservation(e,t=null,a="zh_CN"){return P.A.post(`/api/recurring-reservation/cancel/${e}`,null,{params:{user_email:t,lang:a}})},getChildReservations(e,t=0){return P.A.get(`/api/recurring-reservation/${e}/reservations`,{params:{include_past:t}})}},Y={name:"HomePage",data(){return{loading:!1,querySubmitted:!1,reservations:[],categories:[],queryForm:{category:"",status:"",dateRange:null},currentPage:1,pageSize:10}},computed:{paginatedReservations(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.reservations.slice(e,t)}},created(){this.fetchCategories(),this.handleQuery()},methods:{goToEquipment(){this.$router.push("/equipment")},goToQuery(){this.$router.push("/reservation/query")},goToReservationManage(){this.$router.push("/reservation/query")},async fetchCategories(){try{const e=await Q.getAllCategories();e.data&&Array.isArray(e.data)?this.categories=e.data.map((e=>e.name)):(console.error("Invalid categories data format:",e.data),this.categories=[])}catch(e){console.error("Failed to fetch equipment categories:",e),this.categories=[]}},async handleQuery(){this.loading=!0,this.querySubmitted=!0;try{const e={limit:1e3};if(this.queryForm.category){const t=await B.getEquipments({category:this.queryForm.category,limit:100});t.data&&t.data.items&&t.data.items.length>0&&(e.category=this.queryForm.category)}if(this.queryForm.status&&(e.status=this.queryForm.status,console.log(`设置状态参数为 "${this.queryForm.status}"`)),this.queryForm.dateRange&&2===this.queryForm.dateRange.length){const[t,a]=this.queryForm.dateRange;e.from_date=t.toISOString();const s=new Date(a);s.setHours(23,59,59,999),e.to_date=s.toISOString()}const t=await W.A.getReservations(e);let a=t.data.items;this.queryForm.status&&(console.log(`获取到状态为 ${this.queryForm.status} 的预约数量: ${a.length}`),a.forEach((e=>{console.log(`预约ID=${e.id}, 状态=${e.status}, 开始时间=${e.start_datetime}, 结束时间=${e.end_datetime}`)}))),a.sort(((e,t)=>t.id-e.id)),console.log(`按ID降序排序后的预约数量: ${a.length}`),this.reservations=a}catch(e){console.error("Failed to query public reservations:",e),this.$message.error(this.$t("error.queryFailed")),this.reservations=[]}finally{this.loading=!1}},resetQuery(){this.queryForm.category="",this.queryForm.status="",this.queryForm.dateRange=null,this.handleQuery()},formatDateTime(e,t,a){return U(a)},getStatusType(e){switch(e.status){case"cancelled":return"danger";case"expired":return"warning";case"in_use":return"primary";case"confirmed":return"success";default:return"info"}},getStatusText(e){switch(e.status){case"cancelled":return this.$t("reservation.statusCancelled");case"expired":return this.$t("reservation.statusExpired");case"in_use":return this.$t("reservation.statusInUse");case"confirmed":return this.$t("reservation.statusConfirmed");default:return e.status}},handleSizeChange(e){this.pageSize=e;const t=Math.ceil(this.reservations.length/this.pageSize);this.currentPage>t&&(this.currentPage=1)},handleCurrentChange(e){this.currentPage=e}}},G=Y;var J=(0,h.A)(G,z,M,!1,null,"51158506",null);const X=J.exports;var Z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"equipment-list"},[t("h1",{staticClass:"page-title"},[e._v(e._s(e.$t("equipment.list")))]),t("el-card",{staticClass:"filter-card"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:8,md:6}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("equipment.allCategories"),clearable:""},on:{change:e.handleFilterChange},model:{value:e.filter.category,callback:function(t){e.$set(e.filter,"category",t)},expression:"filter.category"}},e._l(e.categories,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t("el-col",{attrs:{xs:24,sm:8,md:6}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("equipment.allStatus"),clearable:""},on:{change:e.handleFilterChange},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}},[t("el-option",{attrs:{label:e.$t("equipment.available"),value:"available"}}),t("el-option",{attrs:{label:e.$t("equipment.maintenance"),value:"maintenance"}})],1)],1),t("el-col",{attrs:{xs:24,sm:8,md:12}},[t("el-input",{attrs:{placeholder:e.$t("equipment.searchPlaceholder"),clearable:""},on:{clear:e.handleFilterChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilterChange.apply(null,arguments)}},model:{value:e.filter.search,callback:function(t){e.$set(e.filter,"search",t)},expression:"filter.search"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleFilterChange},slot:"append"})],1)],1)],1)],1),e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:3,animated:""}})],1):t("div",[0===e.equipments.length?t("div",{staticClass:"empty-data"},[t("el-empty",{attrs:{description:e.$t("common.noData")}})],1):t("el-row",{attrs:{gutter:20}},e._l(e.equipments,(function(s){return t("el-col",{key:s.id,staticClass:"equipment-item",attrs:{xs:24,sm:12,md:8,lg:6}},[t("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"},nativeOn:{click:function(t){return e.viewEquipmentDetail(s.id)}}},[t("div",{staticClass:"equipment-image-container"},[t("img",{staticClass:"equipment-image",attrs:{src:s.image_path?e.getFullImageUrl(s.image_path):a(555),alt:s.name}})]),t("div",{staticClass:"equipment-info"},[t("h3",{staticClass:"equipment-name"},[e._v(e._s(s.name))]),t("p",{staticClass:"equipment-category"},[e._v(e._s(s.category))]),t("div",{staticClass:"equipment-meta"},[s.location?t("span",{staticClass:"equipment-location"},[t("i",{staticClass:"el-icon-location"}),e._v(" "+e._s(s.location)+" ")]):e._e(),"available"!==s.status?t("el-tag",{staticStyle:{"font-weight":"bold",padding:"0px 10px","font-size":"14px"},attrs:{type:"warning",size:"medium"}},[e._v(" "+e._s(e.$t("equipment.maintenance"))+" ")]):s.currently_reserved?t("el-tag",{staticStyle:{"font-weight":"bold",padding:"0px 10px","font-size":"14px"},attrs:{type:"danger",size:"medium"}},[e._v(" "+e._s(e.$t("equipment.inUse"))+" ")]):t("el-tag",{staticStyle:{"font-weight":"bold",padding:"0px 10px","font-size":"14px"},attrs:{type:"success",size:"medium"}},[e._v(" "+e._s(e.$t("equipment.available"))+" ")])],1),t("div",{staticClass:"equipment-actions"},[t("el-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.viewEquipmentDetail(s.id)}}},[e._v(" "+e._s(e.$t("equipment.viewDetail"))+" ")]),t("el-button",{attrs:{type:"primary",size:"small",disabled:"available"!==s.status||s.currently_reserved},on:{click:function(t){return t.stopPropagation(),e.reserveEquipment(s.id)}}},[e._v(" "+e._s(e.$t("equipment.reserve"))+" ")])],1)])])],1)})),1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handlePageChange}})],1)],1)],1)},K=[];const ee={name:"EquipmentList",data(){return{loading:!1,equipments:[],total:0,currentPage:1,pageSize:20,categories:[],filter:{category:"",status:"",search:""}}},computed:{...(0,l.L8)(["getEquipmentCategories"]),baseUrl(){return P.A.defaults.baseURL||"http://localhost:8000"}},created(){this.fetchData(),this.fetchCategories()},methods:{...(0,l.i0)(["fetchEquipmentCategories"]),async fetchData(){this.loading=!0;try{const e={page:this.currentPage,limit:this.pageSize,category:this.filter.category||void 0,status:this.filter.status||void 0,search:this.filter.search||void 0},t=await H.getEquipments(e);this.equipments=t.data.items,this.total=t.data.total}catch(e){console.error("Failed to fetch equipments:",e),this.$message.error(this.$t("common.error"))}finally{this.loading=!1}},async fetchCategories(){try{const e=await H.getCategories();this.categories=e.data.categories||[]}catch(e){console.error("Failed to fetch categories:",e),this.categories=[]}},handleFilterChange(){this.currentPage=1,this.fetchData()},handlePageChange(e){this.currentPage=e,this.fetchData()},viewEquipmentDetail(e){this.$router.push(`/equipment/${e}`)},reserveEquipment(e){this.$router.push(`/equipment/${e}/reserve`)},getFullImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?this.baseUrl+e:this.baseUrl+"/"+e:""}}},te=ee;var ae=(0,h.A)(te,Z,K,!1,null,"416496e4",null);const se=ae.exports;var re=function(){var e=this,t=e._self._c;return t("div",{staticClass:"equipment-detail"},[e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:10,animated:""}})],1):e.equipment?t("div",[t("div",{staticClass:"back-link"},[t("el-button",{attrs:{icon:"el-icon-arrow-left"},on:{click:function(t){return e.$router.push("/equipment")}}},[e._v(" "+e._s(e.$t("common.back"))+" ")])],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:24,md:10,lg:8}},[t("el-card",{staticClass:"image-card",attrs:{shadow:"never"}},[t("div",{staticClass:"equipment-image-container"},[t("img",{staticClass:"equipment-image",attrs:{src:e.equipment.image_path?e.getFullImageUrl(e.equipment.image_path):a(555),alt:e.equipment.name}})])])],1),t("el-col",{attrs:{xs:24,sm:24,md:14,lg:16}},[t("el-card",{staticClass:"info-card",attrs:{shadow:"never"}},[t("div",{staticClass:"equipment-header"},[t("h1",{staticClass:"equipment-name"},[e._v(e._s(e.equipment.name))]),t("el-tag",{attrs:{type:"available"===e.equipment.status?"success":"warning",size:"medium"}},[e._v(" "+e._s("available"===e.equipment.status?e.$t("equipment.available"):e.$t("equipment.maintenance"))+" ")])],1),t("el-divider"),t("el-descriptions",{attrs:{column:1,border:""}},[t("el-descriptions-item",{attrs:{label:e.$t("equipment.category")}},[e._v(" "+e._s(e.equipment.category)+" ")]),e.equipment.model?t("el-descriptions-item",{attrs:{label:e.$t("equipment.model")}},[e._v(" "+e._s(e.equipment.model)+" ")]):e._e(),e.equipment.location?t("el-descriptions-item",{attrs:{label:e.$t("equipment.location")}},[e._v(" "+e._s(e.equipment.location)+" ")]):e._e(),e.equipment.description?t("el-descriptions-item",{attrs:{label:e.$t("equipment.description")}},[e._v(" "+e._s(e.equipment.description)+" ")]):e._e(),e.equipment.user_guide?t("el-descriptions-item",{attrs:{label:e.$t("equipment.userGuide")}},[t("div",{staticClass:"user-guide-content rich-text-content",domProps:{innerHTML:e._s(e.equipment.user_guide)}})]):e._e(),e.equipment.video_tutorial?t("el-descriptions-item",{attrs:{label:e.$t("equipment.videoTutorial")}},[t("div",{staticClass:"video-container"},[t("iframe",{attrs:{src:e.equipment.video_tutorial,frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}})])]):e._e()],1),t("div",{staticClass:"action-buttons"},[t("el-button",{attrs:{type:"primary",size:"large",disabled:"available"!==e.equipment.status},on:{click:e.reserveEquipment}},[e._v(" "+e._s(e.$t("equipment.reserve"))+" ")]),t("el-button",{attrs:{type:"success",size:"large",disabled:"available"!==e.equipment.status},on:{click:e.recurringReserveEquipment}},[e._v(" "+e._s(e.$t("reservation.createRecurringReservation"))+" ")])],1)],1)],1)],1),t("el-card",{staticClass:"reservations-card",attrs:{shadow:"never"}},[t("div",{staticClass:"reservations-header",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(e.$t("equipment.currentReservations")))]),t("el-date-picker",{attrs:{type:"daterange","range-separator":"→","start-placeholder":e.$t("reservation.startTime"),"end-placeholder":e.$t("reservation.endTime"),"picker-options":e.pickerOptions,size:"small"},on:{change:e.fetchReservations},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e.loadingReservations?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:3,animated:""}})],1):0===e.reservations.length?t("div",{staticClass:"empty-reservations"},[t("el-empty",{attrs:{description:e.$t("equipment.noReservations")}})],1):t("div",{staticClass:"reservations-list"},[t("el-timeline",e._l(e.reservations,(function(a){return t("el-timeline-item",{key:a.id,attrs:{timestamp:e.formatDateTime(a.start_datetime)+" → "+e.formatDateTime(a.end_datetime),type:e.getTimelineItemType(a)}},[t("el-card",{staticClass:"reservation-card"},[t("div",{staticClass:"reservation-info"},[t("div",{staticClass:"reservation-user"},[t("span",{staticClass:"user-name"},[e._v(e._s(a.user_name))]),t("span",{staticClass:"user-department"},[e._v(e._s(a.user_department))])]),a.purpose?t("div",{staticClass:"reservation-purpose"},[t("strong",[e._v(e._s(e.$t("reservation.purpose"))+":")]),e._v(" "+e._s(a.purpose)+" ")]):e._e(),t("div",{staticClass:"reservation-status"},[t("el-tag",{attrs:{size:"small",type:e.getStatusTagType(a)}},[e._v(" "+e._s(e.getStatusText(a))+" ")])],1)])])],1)})),1)],1)])],1):t("div",{staticClass:"error-container"},[t("el-result",{attrs:{icon:"error",title:e.$t("error.errorMessage"),"sub-title":e.$t("equipment.notFound")},scopedSlots:e._u([{key:"extra",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push("/equipment")}}},[e._v(" "+e._s(e.$t("equipment.list"))+" ")])]},proxy:!0}])})],1)])},ie=[],ne=a(1981);const oe={name:"EquipmentDetail",data(){return{loading:!1,loadingReservations:!1,equipment:null,reservations:[],dateRange:[new Date,new Date((new Date).setDate((new Date).getDate()+7))],pickerOptions:{shortcuts:[{text:this.$t("common.today"),onClick(e){const t=new Date,a=new Date;e.$emit("pick",[a,t])}},{text:this.$t("common.week"),onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:this.$t("common.month"),onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}}]}}},computed:{baseUrl(){return P.A.defaults.baseURL||"http://localhost:8000"}},created(){this.fetchEquipment()},methods:{async fetchEquipment(){this.loading=!0;try{const e=this.$route.params.id,t=await H.getEquipment(e);this.equipment=t.data,this.fetchReservations()}catch(e){console.error("Failed to fetch equipment:",e),this.$message.error(this.$t("common.error")),this.equipment=null}finally{this.loading=!1}},async fetchReservations(){if(this.equipment){this.loadingReservations=!0;try{const e=this.equipment.id,t=this.formatDate(this.dateRange[0]),a=new Date(this.dateRange[1]);a.setHours(23,59,59,999);const s=a.toISOString(),r={equipment_id:e,from_date:t,to_date:s},i=await j.getReservations(r);this.reservations=i.data.items}catch(e){console.error("Failed to fetch reservations:",e),this.$message.error(this.$t("common.error")),this.reservations=[]}finally{this.loadingReservations=!1}}},reserveEquipment(){this.$router.push(`/equipment/${this.equipment.id}/reserve`)},recurringReserveEquipment(){this.$router.push(`/equipment/${this.equipment.id}/recurring-reserve`)},formatDateTime(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},formatDate(e){return e?`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`:""},getFullImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?this.baseUrl+e:this.baseUrl+"/"+e:""},getTimelineItemType(e){return"cancelled"===e.status?"info":(0,ne.Gl)(e.end_datetime)?"warning":"primary"},getStatusTagType(e){return"cancelled"===e.status?"info":(0,ne.Gl)(e.end_datetime)?"warning":"success"},getStatusText(e){return"cancelled"===e.status?this.$t("reservation.cancelled"):(0,ne.Gl)(e.end_datetime)?this.$t("reservation.expired"):this.$t("reservation.confirmed")}}},le=oe;var ce=(0,h.A)(le,re,ie,!1,null,"56142a26",null);const ue=ce.exports;var de=function(){var e=this,t=e._self._c;return t("div",{staticClass:"reservation-form"},[e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:10,animated:""}})],1):e.equipment?t("div",[t("div",{staticClass:"back-link"},[t("el-button",{attrs:{icon:"el-icon-arrow-left"},on:{click:function(t){return e.$router.push(`/equipment/${e.equipment.id}`)}}},[e._v(" "+e._s(e.$t("common.back"))+" ")])],1),t("h1",{staticClass:"page-title"},[e._v(e._s(e.$t("reservation.form")))]),t("el-card",{staticClass:"equipment-card",attrs:{shadow:"never"}},[t("div",{staticClass:"equipment-info"},[t("div",{staticClass:"equipment-image-container"},[t("img",{staticClass:"equipment-image",attrs:{src:e.equipment.image_path?e.getFullImageUrl(e.equipment.image_path):a(555),alt:e.equipment.name}})]),t("div",{staticClass:"equipment-details"},[t("h2",{staticClass:"equipment-name"},[e._v(e._s(e.equipment.name))]),t("p",{staticClass:"equipment-category"},[e._v(e._s(e.equipment.category))]),e.equipment.location?t("div",{staticClass:"equipment-location"},[t("i",{staticClass:"el-icon-location"}),e._v(" "+e._s(e.equipment.location)+" ")]):e._e(),t("el-tag",{staticStyle:{"font-weight":"bold",padding:"0px 10px","font-size":"14px"},attrs:{type:"available"===e.equipment.status?"success":"warning",size:"medium"}},[e._v(" "+e._s("available"===e.equipment.status?e.$t("equipment.available"):e.$t("equipment.maintenance"))+" ")])],1)])]),t("el-card",{staticClass:"form-card",attrs:{shadow:"never"}},[t("el-form",{ref:"reservationForm",attrs:{model:e.form,rules:e.rules,"label-position":"top",size:"medium"}},[t("el-divider",[e._v(e._s(e.$t("reservation.reservationType")))]),t("el-form-item",{attrs:{label:e.$t("reservation.reservationType"),prop:"reservationType"}},[t("el-radio-group",{on:{change:e.handleReservationTypeChange},model:{value:e.form.reservationType,callback:function(t){e.$set(e.form,"reservationType",t)},expression:"form.reservationType"}},[t("el-radio",{attrs:{label:"single"}},[e._v(e._s(e.$t("reservation.singleReservation")))]),t("el-radio",{attrs:{label:"recurring"}},[e._v(e._s(e.$t("reservation.recurringReservation")))])],1)],1),t("el-divider",[e._v(e._s(e.$t("reservation.selectTime")))]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.startTime"),prop:"startDateTime"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:e.$t("reservation.startTime"),"picker-options":e.startPickerOptions},on:{change:e.checkTimeAvailability},model:{value:e.form.startDateTime,callback:function(t){e.$set(e.form,"startDateTime",t)},expression:"form.startDateTime"}})],1)],1),t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.endTime"),prop:"endDateTime"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:e.$t("reservation.endTime"),"picker-options":e.endPickerOptions},on:{change:e.checkTimeAvailability},model:{value:e.form.endDateTime,callback:function(t){e.$set(e.form,"endDateTime",t)},expression:"form.endDateTime"}})],1)],1)],1),e.timeConflict?t("div",{staticClass:"time-conflict-warning"},[t("el-alert",{attrs:{title:e.$t("reservation.timeConflict"),type:"error",closable:!1,"show-icon":""}})],1):e._e(),t("el-divider",[e._v(e._s(e.$t("common.userInfo")))]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.userName"),prop:"userName"}},[t("el-input",{model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1)],1),t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.userDepartment"),prop:"userDepartment"}},[t("el-input",{model:{value:e.form.userDepartment,callback:function(t){e.$set(e.form,"userDepartment",t)},expression:"form.userDepartment"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.userContact"),prop:"userContact"}},[t("el-input",{model:{value:e.form.userContact,callback:function(t){e.$set(e.form,"userContact",t)},expression:"form.userContact"}})],1)],1),t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.userEmail"),prop:"userEmail"}},[t("el-input",{attrs:{type:"email"},model:{value:e.form.userEmail,callback:function(t){e.$set(e.form,"userEmail",t)},expression:"form.userEmail"}})],1)],1)],1),t("el-form-item",{attrs:{label:e.$t("reservation.purpose"),prop:"purpose"}},[t("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.form.purpose,callback:function(t){e.$set(e.form,"purpose",t)},expression:"form.purpose"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.submitting,disabled:e.timeConflict,icon:"el-icon-plus"},on:{click:e.submitForm}},[e._v(" "+e._s(e.$t("reservation.createReservation"))+" ")]),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.resetForm}},[e._v(e._s(e.$t("common.reset")))])],1)],1)],1),t("el-dialog",{attrs:{title:e.$t("reservation.createSuccess"),visible:e.successDialogVisible,width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.successDialogVisible=t}}},[t("div",{staticClass:"success-content"},[t("i",{staticClass:"el-icon-success success-icon"}),t("p",{staticClass:"success-message"},[e._v(e._s(e.$t("reservation.saveReservationCode")))]),t("div",{staticClass:"reservation-code"},[e._v(" "+e._s(e.reservationCode)+" ")]),t("p",{staticClass:"reservation-tip"},[e._v(e._s(e.$t("reservation.reservationCodeTip")))]),t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:e.viewReservation}},[e._v(e._s(e.$t("reservation.viewDetail")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.closeSuccessDialog}},[e._v(e._s(e.$t("common.confirm")))])],1)])])],1):t("div",{staticClass:"error-container"},[t("el-result",{attrs:{icon:"error",title:e.$t("error.errorMessage"),"sub-title":e.$t("equipment.notFound")},scopedSlots:e._u([{key:"extra",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push("/equipment")}}},[e._v(" "+e._s(e.$t("equipment.list"))+" ")])]},proxy:!0}])})],1)])},me=[];const pe={name:"ReservationForm",computed:{baseUrl(){return P.A.defaults.baseURL||"http://localhost:8000"}},data(){const e=(e,t,a)=>{t?this.form.startDateTime&&this.form.endDateTime&&this.form.startDateTime>=this.form.endDateTime?a(new Error(this.$t("reservation.invalidTime"))):a():a(new Error(this.$t("reservation.requiredField")))},t=(e,t,a)=>{if(t){const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;e.test(t)?a():a(new Error(this.$t("reservation.emailFormat")))}else a()};return{loading:!0,equipment:null,submitting:!1,timeConflict:!1,successDialogVisible:!1,reservationCode:"",qrcodeUrl:null,form:{reservationType:"single",startDateTime:null,endDateTime:null,userName:"",userDepartment:"",userContact:"",userEmail:"",purpose:""},rules:{startDateTime:[{required:!0,validator:e,trigger:"change"}],endDateTime:[{required:!0,validator:e,trigger:"change"}],userName:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"},{min:2,max:50,message:this.$t("reservation.nameLength"),trigger:"blur"}],userDepartment:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"}],userContact:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"}],userEmail:[{validator:t,trigger:"blur"}]},startPickerOptions:{disabledDate:e=>e.getTime()<Date.now()-864e5},endPickerOptions:{disabledDate:e=>this.form.startDateTime?e.getTime()<this.form.startDateTime.getTime():e.getTime()<Date.now()-864e5}}},created(){this.fetchEquipment()},methods:{async fetchEquipment(){this.loading=!0;try{const e=this.$route.params.id,t=await H.getEquipment(e);this.equipment=t.data,"available"!==this.equipment.status&&this.$message.warning(this.$t("equipment.notAvailable"))}catch(e){console.error("Failed to fetch equipment:",e),this.$message.error(this.$t("common.error"))}finally{this.loading=!1}},async checkTimeAvailability(){if(this.form.startDateTime&&this.form.endDateTime)try{const e=this.equipment.id,t=this.formatDateTime(this.form.startDateTime),a=this.formatDateTime(this.form.endDateTime),s=await H.getAvailability(e,t,a);this.timeConflict=s.data.available.includes(!1)}catch(e){console.error("Failed to check availability:",e),this.timeConflict=!0}},handleReservationTypeChange(e){"recurring"===e&&(this.$message.info(this.$t("reservation.recurringNotSupported")),this.form.reservationType="single")},formatDateTime(e){if(!e)return null;const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${t}-${a}-${s} ${r}:${i}:00`},submitForm(){this.$refs.reservationForm.validate((async e=>{if(!e)return!1;this.submitting=!0;try{const e={equipment_id:this.equipment.id,user_name:this.form.userName,user_department:this.form.userDepartment,user_contact:this.form.userContact,user_email:this.form.userEmail||void 0,start_datetime:this.formatDateTime(this.form.startDateTime),end_datetime:this.formatDateTime(this.form.endDateTime),purpose:this.form.purpose||void 0,lang:this.$i18n.locale},t=await j.createReservation(e);t.data.success?(this.reservationCode=t.data.data.reservation_code,this.successDialogVisible=!0,this.$refs.reservationForm.resetFields()):this.$message.error(t.data.message||this.$t("reservation.createFailed"))}catch(t){console.error("Failed to create reservation:",t),this.$message.error(this.$t("reservation.createFailed"))}finally{this.submitting=!1}}))},resetForm(){this.$refs.reservationForm.resetFields(),this.timeConflict=!1},viewReservation(){this.$router.push(`/reservation/${this.reservationCode}`)},closeSuccessDialog(){this.successDialogVisible=!1,this.$router.push("/equipment")},getFullImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:`${this.baseUrl}${e}`:""}}},ge=pe;var he=(0,h.A)(ge,de,me,!1,null,"dbff2ac6",null);const ve=he.exports;var fe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"recurring-reservation-form"},[e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:10,animated:""}})],1):e.equipment?t("div",[t("div",{staticClass:"back-link"},[t("el-button",{attrs:{icon:"el-icon-arrow-left"},on:{click:function(t){return e.$router.push(`/equipment/${e.equipment.id}`)}}},[e._v(" "+e._s(e.$t("common.back"))+" ")])],1),t("h1",{staticClass:"page-title"},[e._v(e._s(e.$t("reservation.recurringForm")))]),t("el-card",{staticClass:"equipment-card",attrs:{shadow:"never"}},[t("div",{staticClass:"equipment-info"},[t("div",{staticClass:"equipment-image-container"},[t("img",{staticClass:"equipment-image",attrs:{src:e.equipment.image_path?e.getFullImageUrl(e.equipment.image_path):a(555),alt:e.equipment.name}})]),t("div",{staticClass:"equipment-details"},[t("h2",{staticClass:"equipment-name"},[e._v(e._s(e.equipment.name))]),t("p",{staticClass:"equipment-category"},[e._v(e._s(e.equipment.category))]),e.equipment.location?t("div",{staticClass:"equipment-location"},[t("i",{staticClass:"el-icon-location"}),e._v(" "+e._s(e.equipment.location)+" ")]):e._e(),t("el-tag",{staticStyle:{"font-weight":"bold",padding:"0px 10px","font-size":"14px"},attrs:{type:"available"===e.equipment.status?"success":"warning",size:"medium"}},[e._v(" "+e._s("available"===e.equipment.status?e.$t("equipment.available"):e.$t("equipment.maintenance"))+" ")])],1)])]),t("el-card",{staticClass:"form-card",attrs:{shadow:"never"}},[t("el-form",{ref:"reservationForm",attrs:{model:e.form,rules:e.rules,"label-position":"top",size:"medium"}},[t("el-divider",[e._v(e._s(e.$t("reservation.recurringPattern")))]),t("el-form-item",{attrs:{label:e.$t("reservation.patternType"),prop:"patternType"}},[t("el-radio-group",{model:{value:e.form.patternType,callback:function(t){e.$set(e.form,"patternType",t)},expression:"form.patternType"}},[t("el-radio",{attrs:{label:"daily"}},[e._v(e._s(e.$t("reservation.daily")))]),t("el-radio",{attrs:{label:"weekly"}},[e._v(e._s(e.$t("reservation.weekly")))]),t("el-radio",{attrs:{label:"monthly"}},[e._v(e._s(e.$t("reservation.monthly")))])],1)],1),"weekly"===e.form.patternType?t("el-form-item",{attrs:{label:e.$t("reservation.daysOfWeek"),prop:"daysOfWeek"}},[t("el-checkbox-group",{model:{value:e.form.daysOfWeek,callback:function(t){e.$set(e.form,"daysOfWeek",t)},expression:"form.daysOfWeek"}},[t("el-checkbox",{attrs:{label:0}},[e._v(e._s(e.$t("reservation.sunday")))]),t("el-checkbox",{attrs:{label:1}},[e._v(e._s(e.$t("reservation.monday")))]),t("el-checkbox",{attrs:{label:2}},[e._v(e._s(e.$t("reservation.tuesday")))]),t("el-checkbox",{attrs:{label:3}},[e._v(e._s(e.$t("reservation.wednesday")))]),t("el-checkbox",{attrs:{label:4}},[e._v(e._s(e.$t("reservation.thursday")))]),t("el-checkbox",{attrs:{label:5}},[e._v(e._s(e.$t("reservation.friday")))]),t("el-checkbox",{attrs:{label:6}},[e._v(e._s(e.$t("reservation.saturday")))])],1)],1):e._e(),"monthly"===e.form.patternType?t("el-form-item",{attrs:{label:e.$t("reservation.daysOfMonth"),prop:"daysOfMonth"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:e.$t("reservation.selectDaysOfMonth")},model:{value:e.form.daysOfMonth,callback:function(t){e.$set(e.form,"daysOfMonth",t)},expression:"form.daysOfMonth"}},e._l(31,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:e.$t("reservation.dateRange"),prop:"dateRange"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"→","start-placeholder":e.$t("reservation.startDate"),"end-placeholder":e.$t("reservation.endDate"),"picker-options":e.dateRangePickerOptions},on:{change:e.checkTimeAvailability},model:{value:e.form.dateRange,callback:function(t){e.$set(e.form,"dateRange",t)},expression:"form.dateRange"}})],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.startTime"),prop:"startTime"}},[t("el-time-picker",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("reservation.startTime"),format:"HH:mm"},on:{change:e.checkTimeAvailability},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}})],1)],1),t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.endTime"),prop:"endTime"}},[t("el-time-picker",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("reservation.endTime"),format:"HH:mm"},on:{change:e.checkTimeAvailability},model:{value:e.form.endTime,callback:function(t){e.$set(e.form,"endTime",t)},expression:"form.endTime"}})],1)],1)],1),e.timeConflict?t("div",{staticClass:"time-conflict-warning"},[t("el-alert",{attrs:{title:e.$t("reservation.timeConflict"),type:"error",closable:!1,"show-icon":""}})],1):e._e(),t("el-divider",[e._v(e._s(e.$t("common.userInfo")))]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.userName"),prop:"userName"}},[t("el-input",{model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1)],1),t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.userDepartment"),prop:"userDepartment"}},[t("el-input",{model:{value:e.form.userDepartment,callback:function(t){e.$set(e.form,"userDepartment",t)},expression:"form.userDepartment"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.userContact"),prop:"userContact"}},[t("el-input",{model:{value:e.form.userContact,callback:function(t){e.$set(e.form,"userContact",t)},expression:"form.userContact"}})],1)],1),t("el-col",{attrs:{xs:24,sm:12}},[t("el-form-item",{attrs:{label:e.$t("reservation.userEmail"),prop:"userEmail"}},[t("el-input",{attrs:{type:"email"},model:{value:e.form.userEmail,callback:function(t){e.$set(e.form,"userEmail",t)},expression:"form.userEmail"}})],1)],1)],1),t("el-form-item",{attrs:{label:e.$t("reservation.purpose"),prop:"purpose"}},[t("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.form.purpose,callback:function(t){e.$set(e.form,"purpose",t)},expression:"form.purpose"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.submitting,disabled:e.timeConflict,icon:"el-icon-plus"},on:{click:e.submitForm}},[e._v(" "+e._s(e.$t("reservation.createRecurringReservation"))+" ")]),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.resetForm}},[e._v(e._s(e.$t("common.reset")))])],1)],1)],1),t("el-dialog",{attrs:{title:e.$t("reservation.createSuccess"),visible:e.successDialogVisible,width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.successDialogVisible=t}}},[t("div",{staticClass:"success-content"},[t("i",{staticClass:"el-icon-success success-icon"}),t("p",{staticClass:"success-message"},[e._v(e._s(e.$t("reservation.recurringReservationSuccess")))]),t("div",{staticClass:"reservation-summary"},[t("p",[t("strong",[e._v(e._s(e.$t("reservation.patternType"))+":")]),e._v(" "+e._s(e.getPatternTypeText()))]),"weekly"===e.form.patternType?t("p",[t("strong",[e._v(e._s(e.$t("reservation.daysOfWeek"))+":")]),e._v(" "+e._s(e.getWeekdaysText())+" ")]):e._e(),"monthly"===e.form.patternType?t("p",[t("strong",[e._v(e._s(e.$t("reservation.daysOfMonth"))+":")]),e._v(" "+e._s(e.getDaysOfMonthText())+" ")]):e._e(),t("p",[t("strong",[e._v(e._s(e.$t("reservation.dateRange"))+":")]),e._v(" "+e._s(e.formatDate(e.form.dateRange[0]))+" → "+e._s(e.formatDate(e.form.dateRange[1]))+" ")]),t("p",[t("strong",[e._v(e._s(e.$t("reservation.timeRange"))+":")]),e._v(" "+e._s(e.formatTime(e.form.startTime))+" → "+e._s(e.formatTime(e.form.endTime))+" ")])]),t("p",{staticClass:"reservation-tip"},[e._v(e._s(e.$t("reservation.recurringReservationTip")))]),t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:e.viewEquipment}},[e._v(e._s(e.$t("equipment.viewDetail")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.closeSuccessDialog}},[e._v(e._s(e.$t("common.confirm")))])],1)])])],1):t("div",{staticClass:"error-container"},[t("el-result",{attrs:{icon:"error",title:e.$t("error.errorMessage"),"sub-title":e.$t("equipment.notFound")},scopedSlots:e._u([{key:"extra",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push("/equipment")}}},[e._v(" "+e._s(e.$t("equipment.list"))+" ")])]},proxy:!0}])})],1)])},_e=[];const be={name:"RecurringReservationForm",computed:{baseUrl(){return P.A.defaults.baseURL||"http://localhost:8000"}},data(){const e=(e,t,a)=>{if(t)if(this.form.startTime&&this.form.endTime){const e=new Date(this.form.startTime),t=new Date(this.form.endTime);e>=t?a(new Error(this.$t("reservation.invalidTime"))):a()}else a();else a(new Error(this.$t("reservation.requiredField")))},t=(e,t,a)=>{t&&t[0]&&t[1]?a():a(new Error(this.$t("reservation.requiredField")))},a=(e,t,a)=>{"weekly"!==this.form.patternType||t&&0!==t.length?a():a(new Error(this.$t("reservation.selectDaysOfWeek")))},s=(e,t,a)=>{"monthly"!==this.form.patternType||t&&0!==t.length?a():a(new Error(this.$t("reservation.selectDaysOfMonth")))},r=(e,t,a)=>{if(t){const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;e.test(t)?a():a(new Error(this.$t("reservation.emailFormat")))}else a()};return{loading:!1,submitting:!1,equipment:null,timeConflict:!1,successDialogVisible:!1,recurringReservationId:null,form:{patternType:"weekly",daysOfWeek:[],daysOfMonth:[],dateRange:[],startTime:"",endTime:"",userName:"",userDepartment:"",userContact:"",userEmail:"",purpose:""},rules:{patternType:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"change"}],daysOfWeek:[{validator:a,trigger:"change"}],daysOfMonth:[{validator:s,trigger:"change"}],dateRange:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"change"},{validator:t,trigger:"change"}],startTime:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"change"},{validator:e,trigger:"change"}],endTime:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"change"},{validator:e,trigger:"change"}],userName:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"},{min:2,max:50,message:this.$t("common.lengthLimit",{min:2,max:50}),trigger:"blur"}],userDepartment:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"},{min:2,max:50,message:this.$t("common.lengthLimit",{min:2,max:50}),trigger:"blur"}],userContact:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"},{min:5,max:50,message:this.$t("common.lengthLimit",{min:5,max:50}),trigger:"blur"}],userEmail:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"},{validator:r,trigger:"blur"}],purpose:[{max:500,message:this.$t("common.lengthLimit",{max:500}),trigger:"blur"}]},dateRangePickerOptions:{disabledDate(e){return e.getTime()<Date.now()-864e5}}}},created(){this.fetchEquipment()},methods:{async fetchEquipment(){this.loading=!0;try{const e=this.$route.params.id,t=await H.getEquipment(e);this.equipment=t.data,"available"!==this.equipment.status&&this.$message.warning(this.$t("equipment.notAvailable"))}catch(e){console.error("Failed to fetch equipment:",e),this.$message.error(this.$t("common.error")),this.equipment=null}finally{this.loading=!1}},async checkTimeAvailability(){if(!this.form.dateRange||!this.form.dateRange[0]||!this.form.dateRange[1]||!this.form.startTime||!this.form.endTime)return void(this.timeConflict=!1);const e=new Date(this.form.startTime),t=new Date(this.form.endTime);if(e>=t)this.timeConflict=!0;else try{const e=this.equipment.id,t=this.formatDate(this.form.dateRange[0]),a=this.formatDate(this.form.dateRange[0]),s=await H.getAvailability(e,t,a);this.timeConflict=s.data.available.includes(!1),this.timeConflict&&this.$message.warning(this.$t("reservation.timeConflictWarning"))}catch(a){console.error("Failed to check availability:",a),this.$message.error(this.$t("common.error")),this.timeConflict=!0}},submitForm(){this.$refs.reservationForm.validate((async e=>{if(!e)return!1;if(this.timeConflict)return this.$message.error(this.$t("reservation.timeConflict")),!1;this.submitting=!0;try{const e=this.formatDate(this.form.dateRange[0]),t=this.formatDate(this.form.dateRange[1]),a=this.formatTime(this.form.startTime),s=this.formatTime(this.form.endTime),r={equipment_id:this.equipment.id,pattern_type:this.form.patternType,days_of_week:"weekly"===this.form.patternType?this.form.daysOfWeek:void 0,days_of_month:"monthly"===this.form.patternType?this.form.daysOfMonth:void 0,start_date:e,end_date:t,start_time:a,end_time:s,user_name:this.form.userName,user_department:this.form.userDepartment,user_contact:this.form.userContact,user_email:this.form.userEmail||void 0,purpose:this.form.purpose||void 0,lang:this.$i18n.locale},i=await V.createRecurringReservation(r);i.data.success?(this.recurringReservationId=i.data.data.id,this.successDialogVisible=!0):this.$message.error(i.data.message||this.$t("common.error"))}catch(t){console.error("Failed to create recurring reservation:",t),this.$message.error(this.$t("common.error"))}finally{this.submitting=!1}}))},resetForm(){this.$refs.reservationForm.resetFields(),this.timeConflict=!1},viewEquipment(){this.$router.push(`/equipment/${this.equipment.id}`)},closeSuccessDialog(){this.successDialogVisible=!1,this.resetForm(),this.$router.push("/equipment")},formatDate(e){if(!e)return"";const t=new Date(e),a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${r}`},formatTime(e){if(!e)return"";const t=new Date(e),a=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");return`${a}:${s}`},getPatternTypeText(){const e={daily:this.$t("reservation.daily"),weekly:this.$t("reservation.weekly"),monthly:this.$t("reservation.monthly")};return e[this.form.patternType]||this.form.patternType},getWeekdaysText(){if(!this.form.daysOfWeek||0===this.form.daysOfWeek.length)return"";const e=[this.$t("reservation.sunday"),this.$t("reservation.monday"),this.$t("reservation.tuesday"),this.$t("reservation.wednesday"),this.$t("reservation.thursday"),this.$t("reservation.friday"),this.$t("reservation.saturday")];return this.form.daysOfWeek.map((t=>e[t])).join(", ")},getDaysOfMonthText(){return this.form.daysOfMonth&&0!==this.form.daysOfMonth.length?this.form.daysOfMonth.sort(((e,t)=>e-t)).join(", "):""},getFullImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?this.baseUrl+e:this.baseUrl+"/"+e:""}}},ye=be;var $e=(0,h.A)(ye,fe,_e,!1,null,"7a58c6b9",null);const we=$e.exports;var Se=function(){var e=this,t=e._self._c;return t("div",{staticClass:"reservation-query"},[t("h1",{staticClass:"page-title"},[e._v(e._s(e.$t("reservation.personalManagement")))]),t("div",{staticClass:"query-card"},[t("el-card",{attrs:{shadow:"never"}},[t("el-form",{ref:"personalQueryForm",attrs:{model:e.personalQueryForm,rules:e.personalQueryRules,"label-position":"top"},nativeOn:{submit:function(t){return t.preventDefault(),e.handlePersonalQuery.apply(null,arguments)}}},[t("el-form-item",{attrs:{label:e.$t("reservation.code"),prop:"reservationCode"}},[t("el-input",{attrs:{placeholder:e.$t("reservation.codeOrContactRequired")},model:{value:e.personalQueryForm.reservationCode,callback:function(t){e.$set(e.personalQueryForm,"reservationCode",t)},expression:"personalQueryForm.reservationCode"}})],1),t("el-form-item",{attrs:{label:e.$t("reservation.userContact"),prop:"userContact"}},[t("el-input",{attrs:{placeholder:e.$t("reservation.contactOrCodeRequired")},model:{value:e.personalQueryForm.userContact,callback:function(t){e.$set(e.personalQueryForm,"userContact",t)},expression:"personalQueryForm.userContact"}})],1),t("el-form-item",[t("div",{staticClass:"form-tip"},[t("i",{staticClass:"el-icon-info"}),t("span",[e._v(e._s(e.$t("reservation.queryTip")))])])]),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search",loading:e.personalLoading},on:{click:e.handlePersonalQuery}},[e._v(" "+e._s(e.$t("reservation.queryButton"))+" ")]),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.resetForm}},[e._v(e._s(e.$t("common.reset")))])],1)],1)],1)],1),e.personalQueryResults.length>1?t("div",{staticClass:"query-results"},[t("el-card",{attrs:{shadow:"never"}},[t("div",{staticStyle:{"font-size":"16px","font-weight":"bold"},attrs:{slot:"header"},slot:"header"},[t("i",{staticClass:"el-icon-document"}),t("span",[e._v(e._s(e.$t("reservation.queryResults")))])]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.personalQueryResults,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"reservation_code",label:e.$t("reservation.code"),"min-width":"120"}}),t("el-table-column",{attrs:{prop:"equipment_name",label:e.$t("reservation.equipmentName"),"min-width":"120"}}),t("el-table-column",{attrs:{prop:"start_datetime",label:e.$t("reservation.startTime"),"min-width":"160",formatter:e.formatDateTime}}),t("el-table-column",{attrs:{prop:"end_datetime",label:e.$t("reservation.endTime"),"min-width":"160",formatter:e.formatDateTime}}),t("el-table-column",{attrs:{prop:"status",label:e.$t("common.status"),width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusType(a.row)}},[e._v(e._s(e.getStatusText(a.row)))])]}}],null,!1,772818733)}),t("el-table-column",{attrs:{label:e.$t("common.operation"),width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.$router.push(`/reservation/${a.row.reservation_code}`)}}},[e._v(" "+e._s(e.$t("common.view"))+" ")])]}}],null,!1,1335539939)})],1)],1)],1):e._e(),e.showInstructions?t("div",{staticClass:"instructions-card"},[t("el-card",{attrs:{shadow:"hover"}},[t("div",{staticStyle:{"font-size":"16px","font-weight":"bold"},attrs:{slot:"header"},slot:"header"},[t("i",{staticClass:"el-icon-info",staticStyle:{color:"#409EFF","margin-right":"5px"}}),t("span",[e._v(e._s(e.$t("common.instructions")))])]),t("div",{staticClass:"instructions-content"},[t("p",[e._v(e._s(e.$t("reservation.queryInstructions")))]),t("ul",[t("li",[t("i",{staticClass:"el-icon-arrow-right",staticStyle:{color:"#409EFF","margin-right":"5px"}}),e._v(e._s(e.$t("reservation.queryInstruction1")))]),t("li",[t("i",{staticClass:"el-icon-arrow-right",staticStyle:{color:"#409EFF","margin-right":"5px"}}),e._v(e._s(e.$t("reservation.queryInstruction2")))]),t("li",[t("i",{staticClass:"el-icon-arrow-right",staticStyle:{color:"#409EFF","margin-right":"5px"}}),e._v(e._s(e.$t("reservation.queryInstruction3")))])])])])],1):e._e(),e.notFound?t("div",{staticClass:"not-found-card"},[t("el-card",{attrs:{shadow:"never"}},[t("el-result",{attrs:{icon:"error",title:e.$t("reservation.reservationNotFound"),"sub-title":e.$t("reservation.checkCodeAndContact")}})],1)],1):e._e()])},Ce=[];const qe={name:"ReservationQuery",data(){return{personalLoading:!1,showInstructions:!0,notFound:!1,personalQueryForm:{reservationCode:"",userContact:""},personalQueryResults:[],personalQueryRules:{reservationCode:[{required:!1,message:this.$t("reservation.requiredField"),trigger:"blur"},{min:6,max:20,message:this.$t("common.lengthLimit",{min:6,max:20}),trigger:"blur"}],userContact:[{required:!1,message:this.$t("reservation.requiredField"),trigger:"blur"}]}}},created(){const e=this.$route.query.code;e&&(this.personalQueryForm.reservationCode=e,this.$nextTick((()=>{this.handlePersonalQuery()})))},methods:{handlePersonalQuery(){if(!this.personalQueryForm.reservationCode&&!this.personalQueryForm.userContact)return this.$message.error(this.$t("reservation.atLeastOneField")),!1;this.$refs.personalQueryForm.validate((async e=>{if(!e)return!1;this.personalLoading=!0,this.showInstructions=!1,this.notFound=!1;try{if(this.personalQueryForm.reservationCode)try{const e=await j.getReservationByCode(this.personalQueryForm.reservationCode);if(e.data.success)return console.log("找到普通预约，跳转到预约详情页:",this.personalQueryForm.reservationCode),void this.$router.push(`/reservation/${this.personalQueryForm.reservationCode}`);try{const e=await V.getRecurringReservationByCode(this.personalQueryForm.reservationCode);if(e.data.success)return console.log("找到循环预约，跳转到循环预约详情页:",e.data.data.id),void this.$router.push(`/recurring-reservation/${e.data.data.id}`)}catch(t){console.error("Failed to query by reservation code (recurring):",t)}}catch(a){try{const e=await V.getRecurringReservationByCode(this.personalQueryForm.reservationCode);if(e.data.success)return console.log("找到循环预约，跳转到循环预约详情页:",e.data.data.id),void this.$router.push(`/recurring-reservation/${e.data.data.id}`)}catch(t){console.error("Failed to query by reservation code (recurring):",t)}}if(this.personalQueryForm.userContact)try{const e=await j.getReservations({user_contact:this.personalQueryForm.userContact,limit:50});if(e.data.items&&e.data.items.length>0){if(1===e.data.items.length){const t=e.data.items[0];return void this.$router.push(`/reservation/${t.reservation_code}`)}return void(this.personalQueryResults=e.data.items)}}catch(s){console.error("Failed to query by contact:",s)}this.notFound=!0}catch(a){console.error("Failed to query personal reservation:",a),this.notFound=!0}finally{this.personalLoading=!1}}))},formatDateTime(e,t,a){if(!a)return"";const s=new Date(a);return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")} ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`},getStatusType(e){const t=(e.status||"").toLowerCase();switch(console.log("status for switch:",e.status,"->",t),t){case"cancelled":return"danger";case"expired":return"warning";case"in_use":return"primary";case"confirmed":return"success";default:return"info"}},getStatusText(e){const t=(e.status||"").toLowerCase();switch(console.log("status for switch:",e.status,"->",t),t){case"cancelled":return this.$t("reservation.cancelled");case"expired":return this.$t("reservation.expired");case"in_use":return this.$t("reservation.inUse");case"confirmed":return this.$t("reservation.confirmed");default:return e.status}},resetForm(){this.$refs.personalQueryForm.resetFields(),this.notFound=!1,this.showInstructions=!0,this.personalQueryResults=[]}}},Te=qe;var Re=(0,h.A)(Te,Se,Ce,!1,null,"616f7b44",null);const ke=Re.exports;var De=function(){var e=this,t=e._self._c;return t("div",{staticClass:"reservation-detail"},[e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:10,animated:""}})],1):e.reservation?t("div",[t("div",{staticClass:"back-link"},[t("el-button",{attrs:{icon:"el-icon-arrow-left"},on:{click:e.goBack}},[e._v(" "+e._s(e.$t("common.back"))+" ")])],1),t("h1",{staticClass:"page-title"},[e._v(e._s(e.$t("reservation.detail")))]),t("div",{staticClass:"reservation-status-card",class:e.getStatusClass(e.reservation.status)},[t("div",{staticClass:"status-icon"},[t("i",{class:e.getStatusIcon(e.reservation.status)})]),t("div",{staticClass:"status-text"},[t("h2",[e._v(e._s(e.getStatusText(e.reservation.status)))]),t("p",[e._v(e._s(e.$t("reservation.code"))+": "+e._s(e.reservation.reservation_code))])])]),t("el-card",{staticClass:"detail-card",attrs:{shadow:"never"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(e.$t("reservation.detail")))])]),t("el-descriptions",{attrs:{column:1,border:""}},[t("el-descriptions-item",{attrs:{label:e.$t("reservation.equipmentName")}},[e._v(" "+e._s(e.reservation.equipment_name)+" ")]),e.reservation.equipment_category?t("el-descriptions-item",{attrs:{label:e.$t("equipment.category")}},[e._v(" "+e._s(e.reservation.equipment_category)+" ")]):e._e(),e.reservation.equipment_location?t("el-descriptions-item",{attrs:{label:e.$t("equipment.location")}},[e._v(" "+e._s(e.reservation.equipment_location)+" ")]):e._e(),t("el-descriptions-item",{attrs:{label:e.$t("reservation.startTime")}},[e._v(" "+e._s(e.formatDateTime(e.reservation.start_datetime))+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.endTime")}},[e._v(" "+e._s(e.formatDateTime(e.reservation.end_datetime))+" ")]),e.reservation.purpose?t("el-descriptions-item",{attrs:{label:e.$t("reservation.purpose")}},[e._v(" "+e._s(e.reservation.purpose)+" ")]):e._e()],1)],1),t("el-card",{staticClass:"user-card",attrs:{shadow:"never"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(e.$t("common.userInfo")))])]),t("el-descriptions",{attrs:{column:1,border:""}},[t("el-descriptions-item",{attrs:{label:e.$t("reservation.userName")}},[e._v(" "+e._s(e.reservation.user_name)+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.userDepartment")}},[e._v(" "+e._s(e.reservation.user_department)+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.userContact")}},[e._v(" "+e._s(e.reservation.user_contact)+" ")]),e.reservation.user_email?t("el-descriptions-item",{attrs:{label:e.$t("reservation.userEmail")}},[e._v(" "+e._s(e.reservation.user_email)+" ")]):e._e()],1)],1),e.canCancel?t("div",{staticClass:"action-buttons"},[t("el-button",{attrs:{type:"danger",icon:"el-icon-close"},on:{click:e.showCancelDialog}},[e._v(" "+e._s(e.$t("reservation.cancel"))+" ")])],1):e._e(),t("el-dialog",{attrs:{title:e.$t("reservation.cancelConfirmation"),visible:e.cancelDialogVisible,width:"400px"},on:{"update:visible":function(t){e.cancelDialogVisible=t}}},[t("p",[e._v(e._s(e.$t("reservation.cancelConfirmationMessage")))]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.cancelDialogVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),t("el-button",{attrs:{type:"danger",loading:e.cancelling},on:{click:e.cancelReservation}},[e._v(" "+e._s(e.$t("reservation.confirm"))+" ")])],1)])],1):t("div",{staticClass:"error-container"},[t("el-result",{attrs:{icon:"error",title:e.$t("error.errorMessage"),"sub-title":e.$t("reservation.reservationNotFound")},scopedSlots:e._u([{key:"extra",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push("/reservation/query")}}},[e._v(" "+e._s(e.$t("reservation.query"))+" ")])]},proxy:!0}])})],1)])},xe=[];const Ee={name:"ReservationDetail",props:{isAdmin:{type:Boolean,default:!1}},data(){return{loading:!0,reservation:null,cancelDialogVisible:!1,cancelling:!1}},computed:{canCancel(){return!!this.reservation&&"confirmed"===this.reservation.status}},created(){this.fetchReservation()},methods:{async fetchReservation(){this.loading=!0;try{const e=this.$route.params.code;let t;t=this.isAdmin?await j.getReservation(e):await j.getReservationByCode(e),t.data.success?this.reservation=t.data.data:(this.$message.error(t.data.message||this.$t("reservation.notFound")),this.reservation=null)}catch(e){console.error("Failed to fetch reservation:",e),this.$message.error(this.$t("common.error")),this.reservation=null}finally{this.loading=!1}},goBack(){"admin"===this.$route.query.from?this.$router.push("/admin/reservations"):"query"===this.$route.query.from?this.$router.push("/reservation/query"):this.$router.go(-1)},formatDateTime(e){return(0,ne.Yq)(e)},getStatusClass(e){const t={confirmed:"status-confirmed",cancelled:"status-cancelled",completed:"status-completed",in_use:"status-in-use",expired:"status-expired"};return t[e]||"status-unknown"},getStatusIcon(e){const t={confirmed:"el-icon-check",cancelled:"el-icon-close",completed:"el-icon-success",in_use:"el-icon-time",expired:"el-icon-warning"};return t[e]||"el-icon-question"},getStatusText(e){const t={confirmed:this.$t("reservation.statusConfirmed"),cancelled:this.$t("reservation.statusCancelled"),completed:this.$t("reservation.statusCompleted"),in_use:this.$t("reservation.statusInUse"),expired:this.$t("reservation.statusExpired")};return t[e]||this.$t("reservation.statusUnknown")},showCancelDialog(){this.cancelDialogVisible=!0},async cancelReservation(){this.cancelling=!0;try{const e=await j.cancelReservation(this.reservation.reservation_code,{reservation_number:this.reservation.reservation_number});e.data.success?(this.$message.success(this.$t("reservation.cancelSuccess")),this.cancelDialogVisible=!1,await this.fetchReservation()):this.$message.error(e.data.message||this.$t("reservation.cancelFailed"))}catch(e){console.error("Failed to cancel reservation:",e),this.$message.error(this.$t("reservation.cancelFailed"))}finally{this.cancelling=!1}}}},Ae=Ee;var Fe=(0,h.A)(Ae,De,xe,!1,null,"b5a268ea",null);const Ie=Fe.exports;var Le=function(){var e=this,t=e._self._c;return t("div",{staticClass:"recurring-reservation-detail"},[e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:10,animated:""}})],1):e.error?t("div",{staticClass:"error-container"},[t("el-result",{attrs:{icon:"error",title:e.$t("common.error"),"sub-title":e.errorMessage},scopedSlots:e._u([{key:"extra",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push("/")}}},[e._v(e._s(e.$t("common.backToHome")))])]},proxy:!0}])})],1):t("div",{staticClass:"content-container"},[t("div",{staticClass:"header-actions"},[t("el-button",{attrs:{icon:"el-icon-back"},on:{click:e.goBack}},[e._v(e._s(e.$t("common.back")))]),t("el-button",{attrs:{type:"danger",disabled:"cancelled"===e.recurringReservation.status},on:{click:e.showCancelDialog}},[e._v(" "+e._s(e.$t("reservation.cancelRecurringReservation"))+" ")])],1),t("el-card",{staticClass:"reservation-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(e.$t("reservation.recurringReservationDetails")))]),t("el-tag",{attrs:{type:e.getStatusType(e.recurringReservation),size:"medium"}},[e._v(" "+e._s(e.getStatusText(e.recurringReservation))+" ")])],1),t("div",{staticClass:"reservation-info"},[t("div",{staticClass:"info-section"},[t("h3",[e._v(e._s(e.$t("reservation.reservationInfo")))]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.code"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.recurringReservation.reservation_code))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.pattern"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.getPatternText(e.recurringReservation.pattern_type)))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.dateRange"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.formatDate(e.recurringReservation.start_date))+" - "+e._s(e.formatDate(e.recurringReservation.end_date)))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.timeRange"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.formatTime(e.recurringReservation.start_time))+" - "+e._s(e.formatTime(e.recurringReservation.end_time)))])]),e.recurringReservation.days_of_week&&e.recurringReservation.days_of_week.length>0?t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.daysOfWeek"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.formatDaysOfWeek(e.recurringReservation.days_of_week)))])]):e._e(),e.recurringReservation.days_of_month&&e.recurringReservation.days_of_month.length>0?t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.daysOfMonth"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.formatDaysOfMonth(e.recurringReservation.days_of_month)))])]):e._e(),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.purpose"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.recurringReservation.purpose||e.$t("common.notProvided")))])])]),t("div",{staticClass:"info-section"},[t("h3",[e._v(e._s(e.$t("equipment.equipmentInfo")))]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("equipment.name"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.recurringReservation.equipment_name))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("equipment.category"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.recurringReservation.equipment_category))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("equipment.location"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.recurringReservation.equipment_location||e.$t("common.notProvided")))])])]),t("div",{staticClass:"info-section"},[t("h3",[e._v(e._s(e.$t("reservation.userInfo")))]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.userName"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.recurringReservation.user_name))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.userDepartment"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.recurringReservation.user_department))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.userContact"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.recurringReservation.user_contact))])]),e.recurringReservation.user_email?t("div",{staticClass:"info-row"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("reservation.userEmail"))+":")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.recurringReservation.user_email))])]):e._e()])])]),t("el-card",{staticClass:"child-reservations-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(e.$t("reservation.childReservations")))]),t("el-switch",{attrs:{"active-text":e.$t("reservation.includePast")},on:{change:e.loadChildReservations},model:{value:e.includePastReservations,callback:function(t){e.includePastReservations=t},expression:"includePastReservations"}})],1),e.childReservationsLoading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:5,animated:""}})],1):0===e.childReservations.length?t("div",{staticClass:"empty-state"},[t("el-empty",{attrs:{description:e.$t("reservation.noChildReservations")}})],1):t("div",{staticClass:"child-reservations-list"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.childReservations,border:"",stripe:"","row-class-name":e.getRowClassName}},[t("el-table-column",{attrs:{type:"index",label:e.$t("common.id"),width:"60"}}),t("el-table-column",{attrs:{prop:"reservation_number",label:e.$t("reservation.number"),width:"160"}}),t("el-table-column",{attrs:{prop:"reservation_code",label:e.$t("reservation.code"),width:"120"}}),t("el-table-column",{attrs:{prop:"start_datetime",label:e.$t("reservation.startTime"),width:"150",formatter:e.formatDateTime}}),t("el-table-column",{attrs:{prop:"end_datetime",label:e.$t("reservation.endTime"),width:"150",formatter:e.formatDateTime}}),t("el-table-column",{attrs:{prop:"status",label:e.$t("reservation.status"),width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getChildStatusType(a.row),size:"medium"}},[e._v(" "+e._s(e.getChildStatusText(a.row))+" ")])]}}])}),t("el-table-column",{attrs:{label:e.$t("common.actions"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-view",circle:""},on:{click:function(t){return e.viewChildReservation(a.row)}}}),t("el-button",{attrs:{size:"mini",type:"danger",disabled:"cancelled"===a.row.status||"expired"===a.row.status,icon:"el-icon-delete",circle:""},on:{click:function(t){return e.cancelChildReservation(a.row)}}})]}}])})],1)],1)])],1),t("el-dialog",{attrs:{title:e.$t("reservation.cancelRecurringReservation"),visible:e.cancelDialogVisible,width:"500px"},on:{"update:visible":function(t){e.cancelDialogVisible=t}}},[t("div",{staticClass:"cancel-options"},[t("p",[e._v(e._s(e.$t("reservation.cancelRecurringReservationConfirm")))]),t("div",{staticClass:"email-input"},[t("el-form-item",{attrs:{label:e.$t("reservation.userEmail"),prop:"userEmail"}},[t("el-input",{attrs:{placeholder:e.$t("reservation.emailForConfirmation")},model:{value:e.userEmail,callback:function(t){e.userEmail=t},expression:"userEmail"}})],1)],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.cancelDialogVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),t("el-button",{attrs:{type:"danger",loading:e.cancelLoading},on:{click:e.confirmCancel}},[e._v(e._s(e.$t("common.confirm")))])],1)])],1)},Ne=[];const Pe={name:"RecurringReservationDetail",data(){return{recurringReservationId:null,recurringReservation:null,childReservations:[],loading:!0,childReservationsLoading:!1,error:!1,errorMessage:"",includePastReservations:!0,cancelDialogVisible:!1,userEmail:"",cancelLoading:!1,fromChildReservation:!1,highlightReservationNumber:null}},props:{id:{type:[String,Number],required:!1}},created(){this.recurringReservationId=this.id||this.$route.params.id,console.log("Recurring reservation ID:",this.recurringReservationId),this.fromChildReservation="true"===this.$route.query.fromChild,this.$route.query.reservation_number&&(this.highlightReservationNumber=this.$route.query.reservation_number,console.log("高亮显示预约序号:",this.highlightReservationNumber)),this.loadRecurringReservation()},activated(){this.checkChildReservationUpdates()},methods:{async loadRecurringReservation(){this.loading=!0,this.error=!1;try{const e=await V.getRecurringReservation(this.recurringReservationId);e.data.success?(this.recurringReservation=e.data.data,this.userEmail=this.recurringReservation.user_email||"",this.loadChildReservations()):(this.error=!0,this.errorMessage=e.data.message||this.$t("reservation.failedToLoadReservation"))}catch(e){console.error("Failed to load recurring reservation:",e),this.error=!0,this.errorMessage=e.response?.data?.detail||this.$t("reservation.failedToLoadReservation")}finally{this.loading=!1}},async loadChildReservations(){this.childReservationsLoading=!0;try{const e=await V.getChildReservations(this.recurringReservationId,1);if(e.data.success){if(this.childReservations=e.data.reservations||[],!this.includePastReservations){const e=new Date;this.childReservations=this.childReservations.filter((t=>{const a=new Date(t.end_datetime);return a>=e||"cancelled"===t.status}))}this.childReservations.sort(((e,t)=>{const a=e.reservation_number?parseInt(e.reservation_number.replace(/\D/g,"")):0,s=t.reservation_number?parseInt(t.reservation_number.replace(/\D/g,"")):0;return a-s})),console.log("Child reservations loaded:",this.childReservations.length)}else this.$message.error(e.data.message||this.$t("reservation.failedToLoadChildReservations"))}catch(e){console.error("Failed to load child reservations:",e),this.$message.error(this.$t("reservation.failedToLoadChildReservations"))}finally{this.childReservationsLoading=!1}},goBack(){this.$router.push("/reservation/query")},viewChildReservation(e){e.reservation_number?(console.log("通过预约序号查看子预约详情:",e.reservation_number),this.$router.push({path:`/reservation/number/${e.reservation_number}`,query:{child:"true",recurringId:this.recurringReservation.id}}),localStorage.setItem("current_reservation_number",e.reservation_number),console.log("查看子预约详情:",{id:e.id,reservation_code:e.reservation_code,reservation_number:e.reservation_number,startTime:e.start_datetime,endTime:e.end_datetime})):e.id?(this.$router.push({path:`/reservation/${e.reservation_code}`,query:{child:"true",id:e.id,recurringId:this.recurringReservation.id,startTime:e.start_datetime,endTime:e.end_datetime}}),console.log("使用旧方法查看子预约详情:",{id:e.id,reservation_code:e.reservation_code,startTime:e.start_datetime,endTime:e.end_datetime})):this.$message.warning("无法查看子预约详情，缺少预约序号和ID")},async cancelChildReservation(e){try{console.log("准备取消子预约:",e),console.log("子预约序号:",e.reservation_number);const t=await this.$confirm(this.$t("reservation.cancelConfirmation"),this.$t("common.warning"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"});if("confirm"===t){const t={user_email:this.recurringReservation.user_email};e.reservation_number?(t.reservation_number=e.reservation_number,console.log("预约序号参数存在:",e.reservation_number)):console.warn("预约序号参数不存在，将取消所有具有相同预约码的预约"),console.log("取消子预约请求参数:",t),console.log("预约码:",e.reservation_code);const a=await j.cancelReservation(e.reservation_code,t);console.log("取消子预约响应:",a.data),a.data.success?(this.$message.success(this.$t("reservation.cancelSuccess")),e.status="cancelled",this.saveChildReservationStatus(e,"cancelled"),console.log("子预约已取消，即将刷新页面..."),setTimeout((()=>{window.location.reload(!0)}),1e3)):this.$message.error(a.data.message||this.$t("reservation.cancelFailed"))}}catch(t){"cancel"!==t&&(console.error("Failed to cancel reservation:",t),this.$message.error(this.$t("reservation.cancelFailed")))}},saveChildReservationStatus(e,t){if(!e)return;const a=`reservation_status_${e.reservation_code}`,s={statusText:this.getChildStatusText({...e,status:t}),statusType:this.getChildStatusType({...e,status:t}),dbStatus:t,forcedStatus:t,timestamp:(new Date).getTime(),permanent:!0,reservationCode:e.reservation_code};console.log("保存子预约状态到localStorage:",s),localStorage.setItem(a,JSON.stringify(s))},checkChildReservationUpdates(){console.log("检查子预约状态是否发生变化");const e=`recurring_reservation_${this.recurringReservationId}_child_status_changed`,t=localStorage.getItem(e);if(t)try{const a=JSON.parse(t),s=(new Date).getTime(),r=3e5;if(s-a.timestamp<=r)return console.log("检测到子预约状态变更，刷新列表:",a),localStorage.removeItem(e),void this.loadChildReservations();localStorage.removeItem(e)}catch(a){console.error("解析子预约状态变更标记时出错:",a)}if(this.childReservations.length>0){let e=!1;for(let t=0;t<this.childReservations.length;t++){const s=this.childReservations[t],r=`reservation_status_${s.reservation_code}`,i=localStorage.getItem(r);if(i)try{const t=JSON.parse(i),a=(new Date).getTime(),n=3e5;if(a-t.timestamp<=n){if(console.log(`检测到子预约 ${s.reservation_code} 的状态可能已更改，保存的状态:`,t),"cancelled"===t.forcedStatus||t.statusText===this.$t("reservation.cancelled")&&"danger"===t.statusType){console.log(`子预约 ${s.reservation_code} 已被标记为已取消，需要刷新列表`),e=!0;break}}else localStorage.removeItem(r)}catch(a){console.error(`解析子预约 ${s.reservation_code} 的保存状态时出错:`,a)}}e&&(console.log("检测到子预约状态变更，刷新列表"),this.loadChildReservations())}},showCancelDialog(){this.cancelDialogVisible=!0},async confirmCancel(){this.cancelLoading=!0;try{const e=await V.cancelRecurringReservation(this.recurringReservationId,this.userEmail||null);e.data.success?(this.$message.success(this.$t("reservation.cancelSuccess")),this.cancelDialogVisible=!1,this.loadRecurringReservation()):this.$message.error(e.data.message||this.$t("reservation.cancelFailed"))}catch(e){console.error("Failed to cancel recurring reservation:",e),this.$message.error(this.$t("reservation.cancelFailed"))}finally{this.cancelLoading=!1}},formatDate(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},formatTime(e){return e?e.substring(0,5):""},formatDateTime(e,t,a){if(!a)return"";const s=new Date(a);return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")} ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`},formatDaysOfWeek(e){if(!e||0===e.length)return"";const t=[this.$t("reservation.sunday"),this.$t("reservation.monday"),this.$t("reservation.tuesday"),this.$t("reservation.wednesday"),this.$t("reservation.thursday"),this.$t("reservation.friday"),this.$t("reservation.saturday")];return e.map((e=>t[e])).join(", ")},formatDaysOfMonth(e){return e&&0!==e.length?e.join(", "):""},getPatternText(e){const t={daily:this.$t("reservation.daily"),weekly:this.$t("reservation.weekly"),monthly:this.$t("reservation.monthly"),custom:this.$t("reservation.custom")};return t[e]||e},getStatusType(e){return"cancelled"===e.status?"danger":"success"},getStatusText(e){return"cancelled"===e.status?this.$t("reservation.cancelled"):this.$t("reservation.active")},getChildStatusType(e){if("cancelled"===e.status)return"danger";if((0,ne.Gl)(e.end_datetime))return"warning";const t=new Date,a=new Date(e.start_datetime),s=new Date(e.end_datetime);return t>=a&&t<=s?"primary":"success"},getChildStatusText(e){if("cancelled"===e.status)return this.$t("reservation.cancelled");if((0,ne.Gl)(e.end_datetime))return this.$t("reservation.expired");const t=new Date,a=new Date(e.start_datetime),s=new Date(e.end_datetime);return t>=a&&t<=s?this.$t("reservation.ongoing"):this.$t("reservation.confirmed")},getRowClassName({row:e}){return this.highlightReservationNumber&&e.reservation_number===this.highlightReservationNumber?"highlighted-row":""}}},Oe=Pe;var ze=(0,h.A)(Oe,Le,Ne,!1,null,"687fc3cb",null);const Me=ze.exports;var Ue=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-login"},[t("div",{staticClass:"login-container"},[t("div",{staticClass:"login-header"},[t("img",{staticClass:"login-logo",attrs:{src:a(3153),alt:"Logo"}}),t("h1",[e._v(e._s(e.$t("admin.login")))])]),t("el-card",{staticClass:"login-card",attrs:{shadow:"never"}},[t("el-form",{ref:"loginForm",attrs:{model:e.loginForm,rules:e.loginRules,"label-position":"top"},nativeOn:{submit:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[t("el-form-item",{attrs:{label:e.$t("admin.username"),prop:"username"}},[t("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:e.$t("admin.username")},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),t("el-form-item",{attrs:{label:e.$t("admin.password"),prop:"password"}},[t("el-input",{attrs:{"prefix-icon":"el-icon-lock",type:"password",placeholder:e.$t("admin.password"),"show-password":""},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),t("el-form-item",[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary","native-type":"submit",loading:e.loading}},[e._v(" "+e._s(e.$t("admin.loginButton"))+" ")])],1),t("div",{staticClass:"backend-status"},[t("span",[e._v("后端服务状态: ")]),"online"===e.backendStatus?t("el-tag",{attrs:{type:"success",size:"small"}},[e._v("在线")]):"partial"===e.backendStatus?t("el-tag",{attrs:{type:"warning",size:"small"}},[e._v("部分可用")]):"offline"===e.backendStatus?t("el-tag",{attrs:{type:"danger",size:"small"}},[e._v("离线")]):"error"===e.backendStatus?t("el-tag",{attrs:{type:"danger",size:"small"}},[e._v("错误")]):e.checkingBackend?t("el-tag",{attrs:{type:"info",size:"small"}},[e._v("检查中...")]):t("el-tag",{attrs:{type:"info",size:"small"}},[e._v("未知")]),t("el-button",{attrs:{type:"text",size:"small",loading:e.checkingBackend},on:{click:e.checkBackendConnection}},[e._v("重新检查")])],1),"offline"===e.backendStatus||"error"===e.backendStatus?t("el-alert",{attrs:{title:"无法连接到后端服务",type:"error",description:"请确保后端服务已启动并运行在 http://localhost:8000","show-icon":"",closable:!1}}):e._e()],1)],1),t("div",{staticClass:"login-footer"},[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$router.push("/")}}},[e._v(" "+e._s(e.$t("common.back"))+" "+e._s(e.$t("nav.home"))+" ")])],1)],1)])},Be=[];const We={name:"AdminLogin",data(){return{loading:!1,loginForm:{username:"",password:""},loginRules:{username:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"},{min:3,max:20,message:this.$t("common.lengthLimit",{min:3,max:20}),trigger:"blur"}],password:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"},{min:6,max:20,message:this.$t("common.lengthLimit",{min:6,max:20}),trigger:"blur"}]},backendStatus:null,checkingBackend:!1}},mounted(){this.checkBackendConnection()},methods:{...(0,l.i0)(["login"]),async checkBackendConnection(){this.checkingBackend=!0,this.backendStatus=null;try{const e=await this.$http.get("/api/health",{timeout:5e3});200===e.status?(this.backendStatus="online",console.log("Backend is online:",e.data)):(this.backendStatus="error",console.error("Backend health check failed:",e))}catch(e){this.backendStatus="offline",console.error("Backend connection error:",e);try{await this.$http.get("/",{timeout:5e3}),this.backendStatus="partial",console.log("Backend root is accessible but API is not")}catch(t){console.error("Backend root is also not accessible")}}finally{this.checkingBackend=!1}},handleLogin(){this.$refs.loginForm.validate((async e=>{if(!e)return!1;this.loading=!0;try{const e=await this.login({username:this.loginForm.username,password:this.loginForm.password});if(e){this.$message.success(this.$t("admin.loginSuccess"));const e=this.$route.query.redirect||"/admin/dashboard";this.$router.replace(e)}else this.$message.error(this.$t("admin.loginFailed")+" - 请检查后端服务是否正常运行"),console.log("登录失败，请检查后端服务是否在 "+this.$http.defaults.baseURL+" 运行")}catch(t){console.error("Login error:",t),this.$message.error(this.$t("admin.loginFailed"))}finally{this.loading=!1}}))}}},He=We;var Qe=(0,h.A)(He,Ue,Be,!1,null,"52f1911e",null);const je=Qe.exports;var Ve=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-dashboard"},[t("div",{staticClass:"page-header"},[t("h1",{staticClass:"page-title"},[e._v(e._s(e.$t("admin.dashboard")))])]),t("el-row",{staticClass:"stats-row",attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:12,md:6}},[t("el-card",{staticClass:"stats-card primary",attrs:{shadow:"hover"}},[t("div",{staticClass:"stats-content"},[t("div",{staticClass:"stats-value"},[e._v(e._s(e.stats.totalEquipment))]),t("div",{staticClass:"stats-label"},[e._v(e._s(e.$t("admin.totalEquipment")))])]),t("i",{staticClass:"el-icon-s-grid stats-icon"})])],1),t("el-col",{attrs:{xs:24,sm:12,md:6}},[t("el-card",{staticClass:"stats-card success",attrs:{shadow:"hover"}},[t("div",{staticClass:"stats-content"},[t("div",{staticClass:"stats-value"},[e._v(e._s(e.stats.availableEquipment))]),t("div",{staticClass:"stats-label"},[e._v(e._s(e.$t("admin.availableEquipment")))])]),t("i",{staticClass:"el-icon-s-cooperation stats-icon"})])],1),t("el-col",{attrs:{xs:24,sm:12,md:6}},[t("el-card",{staticClass:"stats-card warning",attrs:{shadow:"hover"}},[t("div",{staticClass:"stats-content"},[t("div",{staticClass:"stats-value"},[e._v(e._s(e.stats.totalReservation))]),t("div",{staticClass:"stats-label"},[e._v(e._s(e.$t("admin.totalReservation")))])]),t("i",{staticClass:"el-icon-s-order stats-icon"})])],1),t("el-col",{attrs:{xs:24,sm:12,md:6}},[t("el-card",{staticClass:"stats-card danger",attrs:{shadow:"hover"}},[t("div",{staticClass:"stats-content"},[t("div",{staticClass:"stats-value"},[e._v(e._s(e.stats.activeReservation))]),t("div",{staticClass:"stats-label"},[e._v(e._s(e.$t("admin.activeReservation")))])]),t("i",{staticClass:"el-icon-s-claim stats-icon"})])],1)],1),t("el-card",{staticClass:"recent-reservations",attrs:{shadow:"hover"}},[t("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"header-with-info"},[t("span",[e._v(e._s(e.$t("admin.recentReservations")))]),t("el-tooltip",{attrs:{content:"显示最近创建的10条预约记录",placement:"top"}},[t("i",{staticClass:"el-icon-info info-icon"})])],1),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$router.push("/admin/reservation")}}},[e._v(" "+e._s(e.$t("common.more"))+" "),t("i",{staticClass:"el-icon-arrow-right"})])],1),e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:5,animated:""}})],1):0===e.recentReservations.length?t("div",{staticClass:"empty-data"},[t("el-empty",{attrs:{description:e.$t("common.noData")}})],1):t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.recentReservations,"default-sort":{prop:"created_at",order:"descending"},"header-align":"center","cell-class-name":"text-center",border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"reservation_number",label:e.$t("reservation.number"),"min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(a.row.reservation_number||"-"))])]}}])}),t("el-table-column",{attrs:{prop:"reservation_code",label:e.$t("reservation.code"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{color:"#F56C6C","font-weight":"bold"}},[e._v(e._s(a.row.reservation_code))])]}}])}),t("el-table-column",{attrs:{prop:"equipment_name",label:e.$t("reservation.equipmentName"),"min-width":"120"}}),t("el-table-column",{attrs:{prop:"user_name",label:e.$t("reservation.userName"),"min-width":"100"}}),t("el-table-column",{attrs:{prop:"user_department",label:e.$t("reservation.userDepartment"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.user_department||"-")+" ")]}}])}),t("el-table-column",{attrs:{prop:"user_contact",label:e.$t("reservation.userContact"),"min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.user_contact||"-")+" ")]}}])}),t("el-table-column",{attrs:{prop:"start_datetime",label:e.$t("reservation.startTime"),"min-width":"150",formatter:e.formatDateTime}}),t("el-table-column",{attrs:{prop:"end_datetime",label:e.$t("reservation.endTime"),"min-width":"150",formatter:e.formatDateTime}}),t("el-table-column",{attrs:{prop:"status",label:e.$t("reservation.status"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{staticStyle:{"font-weight":"bold",padding:"0px 10px","font-size":"14px"},attrs:{type:e.getStatusType(a.row),size:"medium"}},[e._v(" "+e._s(e.getStatusText(a.row))+" ")])]}}])}),t("el-table-column",{attrs:{label:e.$t("common.operation"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.viewReservation(a.row)}}},[e._v(" "+e._s(e.$t("admin.viewReservation"))+" ")])]}}])})],1)],1)],1)},Ye=[];const Ge={name:"AdminDashboard",data(){return{loading:!1,stats:{totalEquipment:0,availableEquipment:0,totalReservation:0,activeReservation:0},recentReservations:[]}},created(){this.fetchData()},methods:{async fetchData(){this.loading=!0;try{const e=await P.A.get("/api/statistics/dashboard"),t=e.data;this.stats.totalEquipment=t.total_equipment,this.stats.availableEquipment=t.available_equipment,this.stats.totalReservation=t.total_reservation,this.stats.activeReservation=t.active_reservation,this.recentReservations=t.recent_reservations.map((e=>({id:e.id,reservation_number:e.reservation_number,reservation_code:e.reservation_code,equipment_id:e.equipment_id,equipment_name:e.equipment_name,user_name:e.user_name,user_department:e.user_department||"",user_contact:e.user_contact||"",start_datetime:e.start_datetime,end_datetime:e.end_datetime,status:e.status,created_at:e.created_at})))}catch(e){console.error("Failed to fetch dashboard data:",e),this.$message.error(this.$t("common.error"))}finally{this.loading=!1}},formatDateTime(e,t,a){if(!a)return"";const s=new Date(a);return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")} ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`},getStatusType(e){if("cancelled"===e.status)return"danger";if((0,ne.Gl)(e.end_datetime))return"warning";const t=new Date,a=new Date(e.start_datetime),s=new Date(e.end_datetime);return t>=a&&t<=s?"primary":"success"},getStatusText(e){if("cancelled"===e.status)return this.$t("reservation.cancelled");if((0,ne.Gl)(e.end_datetime))return this.$t("reservation.expired");const t=new Date,a=new Date(e.start_datetime),s=new Date(e.end_datetime);return t>=a&&t<=s?this.$t("reservation.inUse"):this.$t("reservation.confirmed")},viewReservation(e){const t=this.getStatusText(e),a=this.getStatusType(e);console.log("计算的状态信息:",{statusText:t,statusType:a,dbStatus:e.status,startTime:e.start_datetime,endTime:e.end_datetime,reservationNumber:e.reservation_number});const s={path:`/admin/reservation/${e.reservation_code}`,query:{startTime:e.start_datetime,endTime:e.end_datetime,displayStatus:t,displayStatusType:a,reservationNumber:e.reservation_number}};localStorage.setItem("show_reservation_number_notification","true"),localStorage.removeItem("current_reservation_number"),e.reservation_number&&(localStorage.setItem("current_reservation_number",e.reservation_number),console.log("保存预约序号到localStorage:",e.reservation_number),localStorage.setItem("force_use_reservation_number","true")),this.$router.push(s)}}},Je=Ge;var Xe=(0,h.A)(Je,Ve,Ye,!1,null,"57f204ac",null);const Ze=Xe.exports;var Ke=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-equipment"},[t("div",{staticClass:"page-header"},[t("h2",[e._v("设备管理")]),t("div",{staticClass:"page-actions"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v(" 添加设备 ")])],1)]),t("el-card",{staticClass:"filter-card"},[t("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:e.filter}},[t("el-form-item",{attrs:{label:e.$t("equipment.category")}},[t("el-select",{attrs:{placeholder:e.$t("equipment.allCategories"),clearable:""},on:{change:e.handleFilterChange},model:{value:e.filter.category,callback:function(t){e.$set(e.filter,"category",t)},expression:"filter.category"}},e._l(e.categories,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("equipment.status")}},[t("el-select",{attrs:{placeholder:e.$t("equipment.allStatus"),clearable:""},on:{change:e.handleFilterChange},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}},[t("el-option",{attrs:{label:e.$t("equipment.available"),value:"available"}}),t("el-option",{attrs:{label:e.$t("equipment.maintenance"),value:"maintenance"}})],1)],1),t("el-form-item",[t("el-input",{attrs:{placeholder:e.$t("equipment.searchPlaceholder"),clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilterChange.apply(null,arguments)}},model:{value:e.filter.search,callback:function(t){e.$set(e.filter,"search",t)},expression:"filter.search"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleFilterChange},slot:"append"})],1)],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.equipments,border:"",stripe:"","header-align":"center","cell-class-name":"text-center"}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t("el-table-column",{attrs:{prop:"name",label:"设备名称",width:"120"}}),t("el-table-column",{attrs:{prop:"category",label:"设备类别",width:"120"}}),t("el-table-column",{attrs:{prop:"location",label:"设备位置",width:"100"}}),t("el-table-column",{attrs:{prop:"description",label:"设备描述","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.description||"无")+" ")]}}])}),t("el-table-column",{attrs:{prop:"status",label:"设备状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:"available"===a.row.status?"success":"warning",size:"small"}},[e._v(" "+e._s("available"===a.row.status?"可用":"维护中")+" ")])]}}])}),t("el-table-column",{attrs:{label:"设备图片",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",[t("el-image",{class:s.row.image_path?"preview-image":"default-image",staticStyle:{width:"60px",height:"60px"},attrs:{src:s.row.image_path?e.getFullImageUrl(s.row.image_path):a(555),"preview-src-list":s.row.image_path?[e.getFullImageUrl(s.row.image_path)]:[],fit:"contain"},on:{error:()=>e.handleImageLoadError(s.row)}})],1)]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v(" 编辑 ")]),a.row.image_path?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleUploadImage(a.row)}}},[e._v(" 更换图片 ")]):e._e(),t("el-button",{staticClass:"danger-button",attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v(" 删除 ")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handlePageChange}})],1),t("el-dialog",{attrs:{title:"add"===e.dialogType?"添加设备":"编辑设备",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.resetForm}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"设备名称",prop:"name"}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"设备类别",prop:"category"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"","allow-create":"","default-first-option":""},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.categories,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t("el-form-item",{attrs:{label:"设备型号",prop:"model"}},[t("el-input",{model:{value:e.form.model,callback:function(t){e.$set(e.form,"model",t)},expression:"form.model"}})],1),t("el-form-item",{attrs:{label:"设备位置",prop:"location"}},[t("el-input",{model:{value:e.form.location,callback:function(t){e.$set(e.form,"location",t)},expression:"form.location"}})],1),t("el-form-item",{attrs:{label:"设备状态",prop:"status"}},[t("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[t("el-radio",{attrs:{label:"available"}},[e._v("可用")]),t("el-radio",{attrs:{label:"maintenance"}},[e._v("维护中")])],1)],1),t("el-form-item",{attrs:{label:"设备描述",prop:"description"}},[t("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),t("el-form-item",{attrs:{label:"使用指南",prop:"user_guide"}},[t("rich-text-editor",{attrs:{placeholder:"请输入设备的详细使用步骤、注意事项等信息..."},model:{value:e.form.user_guide,callback:function(t){e.$set(e.form,"user_guide",t)},expression:"form.user_guide"}})],1),t("el-form-item",{attrs:{label:"视频教程",prop:"video_tutorial"}},[t("el-input",{attrs:{placeholder:"请输入视频链接，支持YouTube、Bilibili等平台"},model:{value:e.form.video_tutorial,callback:function(t){e.$set(e.form,"video_tutorial",t)},expression:"form.video_tutorial"}},[t("template",{slot:"prepend"},[t("el-select",{staticStyle:{width:"120px"},on:{change:e.handleVideoTypeChange},model:{value:e.videoType,callback:function(t){e.videoType=t},expression:"videoType"}},[t("el-option",{attrs:{label:"YouTube",value:"youtube"}}),t("el-option",{attrs:{label:"Bilibili",value:"bilibili"}}),t("el-option",{attrs:{label:"其他",value:"other"}})],1)],1)],2),t("div",{staticClass:"video-tip"},[e._v("输入视频链接后可以在设备详情页面查看视频教程")])],1),t("el-form-item",{attrs:{label:"设备图片"}},[t("el-upload",{staticClass:"equipment-image-uploader",attrs:{action:e.uploadUrl,headers:e.uploadHeaders,"show-file-list":!1,"on-success":e.handleUploadSuccess,"on-error":e.handleUploadError,"before-upload":e.beforeUpload,multiple:!1,name:"file","with-credentials":!0}},[e.form.image_path?t("img",{staticClass:"equipment-image",attrs:{src:e.getFullImageUrl(e.form.image_path)}}):t("img",{staticClass:"equipment-image default-equipment-image",attrs:{src:a(555)}})]),t("div",{staticClass:"image-tip"},[e._v("建议尺寸：800x600像素，最大8MB")]),t("div",{staticClass:"manual-upload"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.triggerManualUpload}},[e._v("手动上传")]),t("input",{ref:"manualFileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.handleManualFileChange}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.submitting},on:{click:e.submitForm}},[e._v("保存")])],1)],1),t("el-dialog",{attrs:{title:"上传设备图片",visible:e.uploadDialogVisible,width:"30%"},on:{"update:visible":function(t){e.uploadDialogVisible=t}}},[t("el-upload",{staticClass:"equipment-image-uploader",attrs:{action:e.uploadUrl,headers:e.uploadHeaders,data:{equipment_id:e.currentEquipment.id},"show-file-list":!1,"on-success":e.handleImageUploadSuccess,"on-error":e.handleUploadError,"before-upload":e.beforeUpload,multiple:!1,name:"file","with-credentials":!0}},[e.imageUrl?t("img",{staticClass:"equipment-image",attrs:{src:e.getFullImageUrl(e.imageUrl)}}):t("img",{staticClass:"equipment-image default-equipment-image",attrs:{src:a(555)}})]),t("div",{staticClass:"image-tip"},[e._v("建议尺寸：800x600像素，最大8MB")]),t("div",{staticClass:"manual-upload"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.triggerDialogManualUpload}},[e._v("手动上传")]),t("input",{ref:"dialogManualFileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.handleDialogManualFileChange}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.uploadDialogVisible=!1}}},[e._v("取消")])],1)],1)],1)},et=[],tt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"rich-text-editor"},[t("quill-editor",{attrs:{options:e.editorOptions,placeholder:e.placeholder},on:{change:e.onChange},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),e.showTip?t("div",{staticClass:"editor-tip"},[e._v(e._s(e.$t("admin.richTextEditorTip")))]):e._e()],1)},at=[];const st={name:"RichTextEditor",props:{value:{type:String,default:""},placeholder:{type:String,default:""},showTip:{type:Boolean,default:!0}},data(){return{content:this.value,editorOptions:{modules:{toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]],handlers:{image:this.imageHandler}}},placeholder:this.placeholder,theme:"snow"}}},computed:{...(0,l.L8)(["getToken"])},watch:{value(e){e!==this.content&&(this.content=e)}},methods:{onChange(){this.$emit("input",this.content),this.$emit("change",this.content)},imageHandler(){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=async()=>{const t=e.files[0];if(t)if(t.type.startsWith("image/"))if(t.size>5242880)this.$message.error(this.$t("admin.imageSizeError"));else try{const e=new FormData;e.append("file",t);const a=this.$loading({lock:!0,text:this.$t("common.uploading"),spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),s=await P.A.post("/api/upload/editor-image",e,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${this.getToken}`}});a.close();const r=s.data.url,i=this.$refs.quillEditor.quill,n=i.getSelection();i.insertEmbed(n.index,"image",r),i.setSelection(n.index+1),this.$message.success(this.$t("admin.imageUploadSuccess"))}catch(a){console.error("上传图片失败:",a),this.$message.error(this.$t("admin.imageUploadError"))}else this.$message.error(this.$t("admin.imageTypeError"))}}}},rt=st;var it=(0,h.A)(rt,tt,at,!1,null,"5aeab854",null);const nt=it.exports,ot={name:"AdminEquipment",components:{RichTextEditor:nt},data(){return{loading:!1,submitting:!1,equipments:[],total:0,currentPage:1,pageSize:10,categories:[],filter:{category:"",status:"",search:""},dialogVisible:!1,dialogType:"add",form:{id:null,name:"",category:"",model:"",location:"",status:"available",description:"",user_guide:"",image_path:""},rules:{name:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"blur"}],category:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"change"}],status:[{required:!0,message:this.$t("reservation.requiredField"),trigger:"change"}]},uploadDialogVisible:!1,currentEquipment:{},imageUrl:"",uploadUrl:P.A.defaults.baseURL+"/api/equipment/upload-image",videoType:"youtube",editorOptions:{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},placeholder:"",theme:"snow"}}},computed:{getToken(){return localStorage.getItem("token")||""},uploadHeaders(){return{Authorization:`Bearer ${localStorage.getItem("token")||""}`}},baseUrl(){return P.A.defaults.baseURL||"http://localhost:8000"}},created(){this.fetchData(),this.fetchCategories()},methods:{async fetchData(){try{this.loading=!0;const e={page:this.currentPage,limit:this.pageSize,category:this.filter.category||void 0,status:this.filter.status||void 0,search:this.filter.search||void 0},t=await H.getEquipments(e);this.equipments=t.data.items,this.total=t.data.total}catch(e){console.error("获取设备列表失败:",e),this.$message.error(this.$t("error.serverError"))}finally{this.loading=!1}},async fetchCategories(){try{const e=await Q.getAllCategories();this.categories=e.data.map((e=>e.name))}catch(e){console.error("获取设备类别失败:",e)}},handleFilterChange(){this.currentPage=1,this.fetchData()},handlePageChange(e){this.currentPage=e,this.fetchData()},handleAdd(){this.dialogType="add",this.form={id:null,name:"",category:"",model:"",location:"",status:"available",description:"",user_guide:"",video_tutorial:"",image_path:""},this.dialogVisible=!0},handleEdit(e){this.dialogType="edit",this.form={...e},this.dialogVisible=!0},handleDelete(e){this.$confirm(this.$t("admin.confirmDeleteEquipment"),this.$t("common.warning"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then((async()=>{try{this.loading=!0,await H.deleteEquipment(e.id),this.$message.success(this.$t("admin.equipmentDeleted")),this.fetchData()}catch(t){console.error("删除设备失败:",t),this.$message.error(this.$t("error.serverError"))}finally{this.loading=!1}})).catch((()=>{}))},handleUploadImage(e){this.currentEquipment=e,this.imageUrl=e.image_path||"",this.uploadDialogVisible=!0},submitForm(){this.$refs.form.validate((async e=>{if(e)try{if(this.submitting=!0,"add"===this.dialogType){await H.createEquipment(this.form);this.$message.success(this.$t("admin.equipmentAdded"))}else{await H.updateEquipment(this.form.id,this.form);this.$message.success(this.$t("admin.equipmentUpdated"))}this.dialogVisible=!1,this.fetchData()}catch(t){console.error("保存设备失败:",t),this.$message.error(this.$t("error.serverError"))}finally{this.submitting=!1}}))},resetForm(){this.$refs.form&&this.$refs.form.resetFields()},beforeUpload(e){const t=e.type.startsWith("image/"),a=e.size/1024/1024<8;return t?!!a||(this.$message.error(this.$t("admin.imageSizeError").replace("2MB","8MB")),!1):(this.$message.error(this.$t("admin.imageTypeError")),!1)},handleUploadSuccess(e){this.form.image_path=e.data.image_url,this.$message.success(this.$t("admin.imageUploadSuccess"))},handleImageUploadSuccess(e){this.imageUrl=e.data.image_url,this.currentEquipment.image_path=e.data.image_url;const t=this.equipments.findIndex((e=>e.id===this.currentEquipment.id));-1!==t&&this.$set(this.equipments,t,{...this.currentEquipment}),this.$message.success(this.$t("admin.imageUploadSuccess")),setTimeout((()=>{this.uploadDialogVisible=!1}),1500)},handleUploadError(e,t){console.error("上传图片失败:",e),console.log("文件信息:",t?{name:t.name,size:t.size,type:t.type,lastModified:t.lastModified}:"No file info");let a=this.$t("admin.imageUploadError");e.response&&e.response.data&&(console.error("错误响应数据:",e.response.data),e.response.data.detail&&(a+=": "+e.response.data.detail)),this.$message.error(a)},handleVideoTypeChange(){if(this.form.video_tutorial){let e="";if(this.form.video_tutorial.includes("youtube.com")||this.form.video_tutorial.includes("youtu.be")){const t=this.form.video_tutorial.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/);t&&t[1]&&(e=t[1])}else if(this.form.video_tutorial.includes("bilibili.com")){const t=this.form.video_tutorial.match(/bilibili\.com\/video\/([^\/?]+)/);t&&t[1]&&(e=t[1].replace("BV",""))}if(e)switch(this.videoType){case"youtube":this.form.video_tutorial=`https://www.youtube.com/embed/${e}`;break;case"bilibili":this.form.video_tutorial=`https://player.bilibili.com/player.html?bvid=BV${e}`;break;default:break}}},getFullImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?this.baseUrl+e:this.baseUrl+"/"+e:""},triggerManualUpload(){this.$refs.manualFileInput.click()},async handleManualFileChange(e){const t=e.target.files[0];if(!t)return;const a=t.type.startsWith("image/"),s=t.size/1024/1024<8;if(!a)return void this.$message.error(this.$t("admin.imageTypeError"));if(!s)return void this.$message.error(this.$t("admin.imageSizeError").replace("2MB","8MB"));const r=new FormData;r.append("file",t);try{this.loading=!0;const e=await P.A.post(this.uploadUrl,r,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")||""}`}});this.form.image_path=e.data.data.image_url,this.$message.success(this.$t("admin.imageUploadSuccess"))}catch(i){console.error("手动上传图片失败:",i),console.log("文件信息:",{name:t.name,size:t.size,type:t.type,lastModified:t.lastModified});let e=this.$t("admin.imageUploadError");i.response&&i.response.data&&(console.error("错误响应数据:",i.response.data),i.response.data.detail&&(e+=": "+i.response.data.detail)),this.$message.error(e)}finally{this.loading=!1,this.$refs.manualFileInput.value=""}},triggerDialogManualUpload(){this.$refs.dialogManualFileInput.click()},handleImageLoadError(e){console.log("图片加载失败，使用默认图片",e),e&&e.image_path&&this.$set(e,"image_path","")},async handleDialogManualFileChange(e){const t=e.target.files[0];if(!t)return;const a=t.type.startsWith("image/"),s=t.size/1024/1024<8;if(!a)return void this.$message.error(this.$t("admin.imageTypeError"));if(!s)return void this.$message.error(this.$t("admin.imageSizeError").replace("2MB","8MB"));const r=new FormData;r.append("file",t),this.currentEquipment.id&&r.append("equipment_id",this.currentEquipment.id);try{this.loading=!0;const e=await P.A.post(this.uploadUrl,r,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")||""}`}});this.imageUrl=e.data.data.image_url,this.currentEquipment.image_path=e.data.data.image_url;const t=this.equipments.findIndex((e=>e.id===this.currentEquipment.id));-1!==t&&this.$set(this.equipments,t,{...this.currentEquipment}),this.$message.success(this.$t("admin.imageUploadSuccess")),setTimeout((()=>{this.uploadDialogVisible=!1}),1500)}catch(i){console.error("手动上传图片失败:",i),console.log("文件信息:",{name:t.name,size:t.size,type:t.type,lastModified:t.lastModified});let e=this.$t("admin.imageUploadError");i.response&&i.response.data&&(console.error("错误响应数据:",i.response.data),i.response.data.detail&&(e+=": "+i.response.data.detail)),this.$message.error(e)}finally{this.loading=!1,this.$refs.dialogManualFileInput.value=""}}}},lt=ot;var ct=(0,h.A)(lt,Ke,et,!1,null,"4db06f5f",null);const ut=ct.exports;var dt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-category"},[t("h1",{staticClass:"page-title"},[e._v("设备类别管理")]),t("div",{staticClass:"action-bar"},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 添加类别 ")]),t("div",{staticClass:"search-box"},[t("el-input",{attrs:{placeholder:"搜索类别名称",clearable:""},on:{clear:e.handleFilterChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilterChange.apply(null,arguments)}},model:{value:e.filter.search,callback:function(t){e.$set(e.filter,"search",t)},expression:"filter.search"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleFilterChange},slot:"append"})],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.categories,border:"",stripe:"","header-align":"center","cell-class-name":"text-center"}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t("el-table-column",{attrs:{prop:"name",label:"类别名称","min-width":"150"}}),t("el-table-column",{attrs:{prop:"description",label:"描述","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.description||"无")+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v(" 编辑 ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v(" 删除 ")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:e.total,"current-page":e.currentPage,"page-size":e.pageSize},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handlePageChange}})],1),t("el-dialog",{attrs:{title:"add"===e.dialogType?"添加类别":"编辑类别",visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.resetForm}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"类别名称",prop:"name"}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"描述",prop:"description"}},[t("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.submitting},on:{click:e.submitForm}},[e._v("保存")])],1)],1)],1)},mt=[];const pt={name:"AdminCategory",data(){return{loading:!1,submitting:!1,categories:[],total:0,currentPage:1,pageSize:10,filter:{search:""},dialogVisible:!1,dialogType:"add",form:{id:null,name:"",description:""},rules:{name:[{required:!0,message:"请输入类别名称",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}]}}},computed:{...(0,l.L8)(["getToken"])},created(){this.fetchData()},methods:{async fetchData(){try{this.loading=!0;const e={skip:(this.currentPage-1)*this.pageSize,limit:this.pageSize,search:this.filter.search||void 0},t=await Q.getCategories(e);this.categories=t.data.items,this.total=t.data.total}catch(e){console.error("获取类别列表失败:",e),this.$message.error("获取类别列表失败")}finally{this.loading=!1}},handleFilterChange(){this.currentPage=1,this.fetchData()},handlePageChange(e){this.currentPage=e,this.fetchData()},handleAdd(){this.dialogType="add",this.form={id:null,name:"",description:""},this.dialogVisible=!0},handleEdit(e){this.dialogType="edit",this.form={...e},this.dialogVisible=!0},handleDelete(e){this.$confirm("确定要删除该类别吗？删除后不可恢复，且可能影响已使用该类别的设备。","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{this.loading=!0,await Q.deleteCategory(e.id),this.$message.success("类别已删除"),this.fetchData()}catch(t){console.error("删除类别失败:",t),this.$message.error("删除类别失败")}finally{this.loading=!1}})).catch((()=>{}))},submitForm(){this.$refs.form.validate((async e=>{if(e)try{this.submitting=!0,"add"===this.dialogType?(await Q.createCategory(this.form),this.$message.success("类别添加成功")):(await Q.updateCategory(this.form.id,this.form),this.$message.success("类别更新成功")),this.dialogVisible=!1,this.fetchData()}catch(t){console.error("保存类别失败:",t),t.response&&t.response.data&&t.response.data.detail?this.$message.error(t.response.data.detail):this.$message.error("保存类别失败")}finally{this.submitting=!1}}))},resetForm(){this.$refs.form&&this.$refs.form.resetFields()}}},gt=pt;var ht=(0,h.A)(gt,dt,mt,!1,null,"8479515a",null);const vt=ht.exports;var ft=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-reservation"},[t("div",{staticClass:"page-header"},[t("h1",{staticClass:"page-title"},[e._v(e._s(e.$t("admin.reservation")))])]),t("el-card",{staticClass:"filter-card",attrs:{shadow:"hover"}},[t("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:e.filter}},[t("el-form-item",{attrs:{label:e.$t("reservation.code")}},[t("el-input",{attrs:{placeholder:e.$t("reservation.queryPlaceholder"),clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilterChange.apply(null,arguments)}},model:{value:e.filter.code,callback:function(t){e.$set(e.filter,"code",t)},expression:"filter.code"}})],1),t("el-form-item",{attrs:{label:e.$t("reservation.userName")}},[t("el-input",{attrs:{placeholder:e.$t("reservation.userName"),clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilterChange.apply(null,arguments)}},model:{value:e.filter.userName,callback:function(t){e.$set(e.filter,"userName",t)},expression:"filter.userName"}})],1),t("el-form-item",{attrs:{label:e.$t("reservation.status")}},[t("el-select",{attrs:{placeholder:e.$t("equipment.allStatus"),clearable:""},on:{change:e.handleFilterChange},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}},[t("el-option",{attrs:{label:e.$t("reservation.confirmed"),value:"confirmed"}}),t("el-option",{attrs:{label:e.$t("reservation.inUse"),value:"in_use"}}),t("el-option",{attrs:{label:e.$t("reservation.expired"),value:"expired"}}),t("el-option",{attrs:{label:e.$t("reservation.cancelled"),value:"cancelled"}})],1)],1),t("el-form-item",{attrs:{label:e.$t("reservation.dateRange")}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":e.$t("reservation.startDate"),"end-placeholder":e.$t("reservation.endDate"),"value-format":"yyyy-MM-dd"},on:{change:e.handleFilterChange},model:{value:e.filter.dateRange,callback:function(t){e.$set(e.filter,"dateRange",t)},expression:"filter.dateRange"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilterChange}},[e._v(" "+e._s(e.$t("common.search"))+" ")]),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.resetFilter}},[e._v(" "+e._s(e.$t("common.reset"))+" ")])],1)],1)],1),t("el-card",{staticClass:"reservation-list",attrs:{shadow:"hover"}},[e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:10,animated:""}})],1):0===e.reservations.length?t("div",{staticClass:"empty-data"},[t("el-empty",{attrs:{description:e.$t("common.noData")}})],1):t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.reservations,"default-sort":{prop:"id",order:"descending"},"header-align":"center","cell-class-name":"text-center",border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"id",label:e.$t("common.id"),"min-width":"60",sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(a.row.id))])]}}])}),t("el-table-column",{attrs:{prop:"reservation_number",label:e.$t("reservation.number"),"min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(a.row.reservation_number||"-"))])]}}])}),t("el-table-column",{attrs:{prop:"reservation_code",label:e.$t("reservation.code"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{color:"#F56C6C","font-weight":"bold"}},[e._v(e._s(a.row.reservation_code))])]}}])}),t("el-table-column",{attrs:{prop:"equipment_name",label:e.$t("reservation.equipmentName"),"min-width":"120"}}),t("el-table-column",{attrs:{prop:"user_name",label:e.$t("reservation.userName"),"min-width":"100"}}),t("el-table-column",{attrs:{prop:"user_department",label:e.$t("reservation.userDepartment"),"min-width":"100"}}),t("el-table-column",{attrs:{prop:"user_contact",label:e.$t("reservation.userContact"),"min-width":"120"}}),t("el-table-column",{attrs:{prop:"start_datetime",label:e.$t("reservation.startTime"),"min-width":"150",formatter:e.formatDateTime}}),t("el-table-column",{attrs:{prop:"end_datetime",label:e.$t("reservation.endTime"),"min-width":"150",formatter:e.formatDateTime}}),t("el-table-column",{attrs:{prop:"status",label:e.$t("reservation.status"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{staticStyle:{"font-weight":"bold",padding:"0px 10px","font-size":"14px"},attrs:{type:e.getStatusType(a.row),size:"medium"}},[e._v(" "+e._s(e.getStatusText(a.row))+" ")])]}}])}),t("el-table-column",{attrs:{label:e.$t("common.operation"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.viewReservation(a.row)}}},[e._v(" "+e._s(e.$t("admin.viewReservation"))+" ")])]}}])})],1),e.reservations.length>0?t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handlePageChange}})],1):e._e()],1)],1)},_t=[];const bt={name:"AdminReservation",data(){return{loading:!1,reservations:[],total:0,currentPage:1,pageSize:10,filter:{code:"",userName:"",status:"",dateRange:[]},savedState:null}},created(){this.restoreState()},activated(){const e=localStorage.getItem("force_refresh_reservation_list");if("true"===e)return console.log("检测到强制刷新标记，重新获取数据"),localStorage.removeItem("force_refresh_reservation_list"),void this.fetchData();this.restoreState(),this.checkReservationUpdates()},deactivated(){this.saveState()},beforeRouteLeave(e,t,a){e.path.includes("/admin/reservation/")&&"/admin/reservation"!==e.path&&this.saveState(),a()},methods:{async fetchData(){this.loading=!0,console.log("Fetching data with filter:",this.filter),console.log("Current page:",this.currentPage);try{const e=(new Date).getTime();console.log("添加时间戳参数:",e);const t={skip:(this.currentPage-1)*this.pageSize,limit:this.pageSize,reservation_code:this.filter.code||void 0,user_name:this.filter.userName||void 0,_t:e,sort_by:"id",sort_order:"desc"};this.filter.dateRange&&2===this.filter.dateRange.length&&(t.from_date=this.filter.dateRange[0],t.to_date=this.filter.dateRange[1]),this.filter.status&&(console.log("Filtering by status:",this.filter.status),t.status=this.filter.status,console.log(`Setting status parameter to "${this.filter.status}"`)),console.log("Fetching reservations with params:",t);const a=await j.getReservations(t);console.log("API Response:",a);let s=a.data.items||[];console.log("Received reservations:",s),this.filter.status&&(console.log(`获取到状态为 ${this.filter.status} 的预约数量: ${s.length}`),s.forEach((e=>{console.log(`预约ID=${e.id}, 状态=${e.status}, 开始时间=${e.start_datetime}, 结束时间=${e.end_datetime}`)}))),console.log("Filtered reservations:",s),this.reservations=s,"in_use"===this.filter.status||"expired"===this.filter.status||"confirmed"===this.filter.status||"cancelled"===this.filter.status?(this.total=s.length,console.log(`Temporary total based on current page: ${this.total}`),this.fetchTotalForSpecialStatus()):(this.total=a.data.total,console.log(`Total from API response: ${this.total}`))}catch(e){console.error("Failed to fetch reservations:",e),this.$message.error(this.$t("error.serverError"))}finally{this.loading=!1}},formatDateTime(e,t,a){if(!a)return"";const s=new Date(a);return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")} ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`},getStatusType(e){switch(e.status){case"cancelled":return"danger";case"expired":return"warning";case"in_use":return"primary";case"confirmed":return"success";default:return"info"}},getStatusText(e){switch(e.status){case"cancelled":return this.$t("reservation.statusCancelled");case"expired":return this.$t("reservation.statusExpired");case"in_use":return this.$t("reservation.statusInUse");case"confirmed":return this.$t("reservation.statusConfirmed");default:return e.status}},handleFilterChange(){this.currentPage=1,this.fetchData()},resetFilter(){this.filter={code:"",userName:"",status:"",dateRange:[]},this.handleFilterChange()},handlePageChange(e){this.currentPage=e,this.fetchData()},viewReservation(e){const t=this.getStatusText(e),a=this.getStatusType(e);console.log("计算的状态信息:",{statusText:t,statusType:a,dbStatus:e.status,startTime:e.start_datetime,endTime:e.end_datetime,reservationNumber:e.reservation_number});const s={path:`/admin/reservation/${e.reservation_code}`,query:{startTime:e.start_datetime,endTime:e.end_datetime,displayStatus:t,displayStatusType:a,reservationNumber:e.reservation_number}};localStorage.setItem("show_reservation_number_notification","true"),localStorage.removeItem("current_reservation_number"),e.reservation_number&&(localStorage.setItem("current_reservation_number",e.reservation_number),console.log("保存预约序号到localStorage:",e.reservation_number),localStorage.setItem("force_use_reservation_number","true")),this.$router.push(s)},async fetchTotalForSpecialStatus(){try{console.log("Fetching total for special status:",this.filter.status),console.log("Current page before fetchTotal:",this.currentPage);const e=this.currentPage,t=(new Date).getTime();console.log("添加时间戳参数:",t);const a={limit:1e3,skip:0,reservation_code:this.filter.code||void 0,user_name:this.filter.userName||void 0,_t:t,sort_by:"id",sort_order:"desc"};this.filter.dateRange&&2===this.filter.dateRange.length&&(a.from_date=this.filter.dateRange[0],a.to_date=this.filter.dateRange[1]);const s={...a,status:this.filter.status};console.log(`直接获取状态为 ${this.filter.status} 的预约`);const r=await j.getReservations(s);let i=r.data.items||[];console.log(`Total reservations before filtering: ${i.length}`);const n=new Date;console.log(`当前日期: ${n}`),console.log(`获取到状态为 ${this.filter.status} 的预约数量: ${i.length}`),i.forEach((e=>{console.log(`预约ID=${e.id}, 状态=${e.status}, 开始时间=${e.start_datetime}, 结束时间=${e.end_datetime}`)})),this.total=i.length,console.log(`Updated total to: ${this.total}`),"expired"===this.filter.status?i.sort(((e,t)=>new Date(t.end_datetime)-new Date(e.end_datetime))):"in_use"===this.filter.status?i.sort(((e,t)=>new Date(t.start_datetime)-new Date(e.start_datetime))):"confirmed"===this.filter.status?i.sort(((e,t)=>new Date(e.start_datetime)-new Date(t.start_datetime))):"cancelled"===this.filter.status&&i.sort(((e,t)=>new Date(t.end_datetime)-new Date(e.end_datetime)));const o=Math.ceil(i.length/this.pageSize)||1,l=Math.min(e,o);console.log(`计算页数: 总记录数=${i.length}, 每页记录数=${this.pageSize}, 最大页数=${o}, 目标页码=${l}`);const c=(l-1)*this.pageSize,u=Math.min(c+this.pageSize,i.length),d=i.slice(c,u);console.log(`当前页数据范围: 开始索引=${c}, 结束索引=${u}, 当前页记录数=${d.length}`),d.length>0?(this.reservations=d,this.currentPage!==l&&(console.log(`更新页码: 从 ${this.currentPage} 到 ${l}`),this.$nextTick((()=>{this.currentPage=l}))),console.log(`更新当前页面的预约列表: ${this.reservations.length} 条记录`)):i.length>0?(console.log("当前页没有数据，回到第一页"),this.reservations=i.slice(0,this.pageSize),1!==this.currentPage&&this.$nextTick((()=>{this.currentPage=1}))):(this.reservations=[],console.log("没有找到符合条件的预约")),console.log("Current page after fetchTotal:",this.currentPage)}catch(e){console.error("Failed to fetch total for special status:",e)}},saveState(){this.savedState={filter:{...this.filter},currentPage:this.currentPage},console.log("Saved state:",this.savedState)},restoreState(){this.savedState?(this.filter={...this.savedState.filter},this.currentPage=this.savedState.currentPage,console.log("Restored state:",this.savedState),this.fetchData()):this.fetchData()},openReservationDetail(e){console.log("打开预约详情:",e);const t=this.getStatusText(e),a=this.getStatusType(e),s=e.status||"confirmed",r=e.start_datetime,i=e.end_datetime;console.log("计算的状态信息:",{statusText:t,statusType:a,dbStatus:s,startTime:r,endTime:i});const n=`reservation_status_${e.reservation_code}`,o={statusText:t,statusType:a,dbStatus:s,timestamp:(new Date).getTime()};console.log("Saved state:",o),localStorage.setItem(n,JSON.stringify(o)),this.$router.push({name:"AdminReservationDetail",params:{code:e.reservation_code},query:{displayStatus:t,displayStatusType:a,startTime:r,endTime:i}})},async checkReservationUpdates(){if(this.reservations.length>0)for(let t=0;t<this.reservations.length;t++){const a=this.reservations[t],s=`reservation_status_${a.reservation_code}`,r=localStorage.getItem(s);if(r)try{const e=JSON.parse(r),i=(new Date).getTime(),n=3e5;i-e.timestamp<=n?(console.log(`检测到预约 ${a.reservation_code} 的状态可能已更改，保存的状态:`,e),("cancelled"===e.forcedStatus||e.statusText===this.$t("reservation.cancelled")&&"danger"===e.statusType)&&(console.log(`预约 ${a.reservation_code} 已被标记为已取消，将在界面上更新`),this.reservations[t].status="cancelled",this.$forceUpdate())):(console.log(`预约 ${a.reservation_code} 的保存状态已过期，移除`),localStorage.removeItem(s))}catch(e){console.error("解析保存的状态时出错:",e)}}}}},yt=bt;var $t=(0,h.A)(yt,ft,_t,!1,null,"e530181c",null);const wt=$t.exports;var St=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-reservation-detail"},[t("div",{staticClass:"page-header"},[t("h1",{staticClass:"page-title"},[e._v(e._s(e.$t("reservation.detail")))]),t("el-button",{attrs:{icon:"el-icon-back"},on:{click:e.goBack}},[e._v(" "+e._s(e.$t("common.back"))+" ")])],1),e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:10,animated:""}})],1):e.reservation?t("div",[t("el-card",{staticClass:"detail-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(e.$t("reservation.detail")))]),t("el-tag",{attrs:{type:e.displayStatusType}},[e._v(" "+e._s(e.displayStatusText)+" ")])],1),t("el-descriptions",{attrs:{column:2,border:""}},[t("el-descriptions-item",{attrs:{label:e.$t("reservation.code")}},[e._v(" "+e._s(e.reservation.reservation_code)+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.status")}},[t("el-tag",{attrs:{type:e.displayStatusType}},[e._v(" "+e._s(e.displayStatusText)+" ")])],1),t("el-descriptions-item",{attrs:{label:e.$t("reservation.equipmentName")}},[t("router-link",{attrs:{to:`/equipment/${e.reservation.equipment_id}`}},[e._v(" "+e._s(e.reservation.equipment_name)+" ")])],1),t("el-descriptions-item",{attrs:{label:e.$t("common.createTime")}},[e._v(" "+e._s(e.formatDateTime(e.reservation.created_at))+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.startTime")}},[e._v(" "+e._s(e.formatDateTime(e.reservation.start_datetime))+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.endTime")}},[e._v(" "+e._s(e.formatDateTime(e.reservation.end_datetime))+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.userName")}},[e._v(" "+e._s(e.reservation.user_name)+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.userDepartment")}},[e._v(" "+e._s(e.reservation.user_department)+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.userContact")}},[e._v(" "+e._s(e.reservation.user_contact)+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.userEmail")}},[e._v(" "+e._s(e.reservation.user_email||"-")+" ")]),t("el-descriptions-item",{attrs:{label:e.$t("reservation.purpose"),span:2}},[e._v(" "+e._s(e.reservation.purpose||"-")+" ")])],1),t("div",{staticClass:"actions"},[e.displayStatusText===e.$t("reservation.confirmed")?t("el-button",{attrs:{type:"danger"},on:{click:e.handleCancel}},[e._v(" "+e._s(e.$t("reservation.cancelReservation"))+" ")]):e._e(),e.displayStatusText===e.$t("reservation.inUse")?t("el-button",{attrs:{type:"primary"},on:{click:e.handleReturn}},[e._v(" "+e._s(e.$t("reservation.earlyReturn"))+" ")]):e._e()],1)],1)],1):t("el-card",{staticClass:"error-card"},[t("div",{staticClass:"error-message"},[t("i",{staticClass:"el-icon-warning-outline"}),t("p",[e._v(e._s(e.$t("reservation.reservationNotFound")))])]),t("el-button",{attrs:{type:"primary"},on:{click:e.goBack}},[e._v(" "+e._s(e.$t("common.back"))+" ")])],1),t("el-dialog",{attrs:{title:e.$t("common.warning"),visible:e.cancelDialogVisible,width:"30%"},on:{"update:visible":function(t){e.cancelDialogVisible=t}}},[t("span",[e._v(e._s(e.$t("reservation.confirmCancel")))]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.cancelDialogVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),t("el-button",{attrs:{type:"danger",loading:e.submitting},on:{click:e.confirmCancel}},[e._v(e._s(e.$t("common.confirm")))])],1)]),t("el-dialog",{attrs:{title:e.$t("reservation.earlyReturn"),visible:e.returnDialogVisible,width:"30%"},on:{"update:visible":function(t){e.returnDialogVisible=t}}},[t("span",[e._v(e._s(e.$t("reservation.confirmEarlyReturn")))]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.returnDialogVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.submitting},on:{click:e.confirmReturn}},[e._v(e._s(e.$t("common.confirm")))])],1)])],1)},Ct=[];const qt={name:"AdminReservationDetail",data(){return{loading:!1,submitting:!1,reservation:null,cancelDialogVisible:!1,returnDialogVisible:!1,forcedStatusText:null,forcedStatusType:null,dateMatches:!1,statusUpdated:!1,forcedStatus:null,reservationStatusCacheKey:""}},created(){this.fetchReservation(),window.addEventListener("beforeunload",this.saveState)},destroyed(){window.removeEventListener("beforeunload",this.saveState)},mounted(){this.loadReservation()},watch:{$route:{handler:function(e,t){e.params.code===t.params.code&&e.query.reservationNumber===t.query.reservationNumber||(console.log("路由参数变化，重新获取数据"),this.fetchReservation())},deep:!0}},beforeRouteUpdate(e,t,a){console.log("路由参数更新，重新获取数据"),this.fetchReservation(),a()},computed:{getStatusTagText(){if(!this.reservation)return"";const e=this.getSavedState();if(e&&e.statusText)return console.log("Using saved status text:",e.statusText),e.statusText;const t=this.getStatusText(this.reservation);return console.log("Computed status text:",t),t},getStatusTagType(){if(!this.reservation)return"";const e=this.getSavedState();if(e&&e.statusType)return console.log("Using saved status type:",e.statusType),e.statusType;const t=this.getStatusType(this.reservation);return console.log("Computed status type:",t),t},displayStatusText(){if(this.$route.query.displayStatus)return console.log("使用URL传递的状态文本:",this.$route.query.displayStatus),this.$route.query.displayStatus;if(this.forcedStatusText)return console.log("使用强制状态文本:",this.forcedStatusText),this.forcedStatusText;const e=this.getSavedState();if(e&&e.statusText)return console.log("使用本地存储的状态文本:",e.statusText),e.statusText;if(!this.reservation)return"";const t=new Date,a=new Date(this.reservation.end_datetime);if(a<t)return console.log("实时计算：预定已过期"),this.$t("reservation.expired");const s=new Date(this.reservation.start_datetime);return t>=s&&t<=a?(console.log("实时计算：预定使用中"),this.$t("reservation.inUse")):"cancelled"===this.reservation.status?(console.log("数据库标记为已取消"),this.$t("reservation.cancelled")):(console.log("实时计算：预定已确认"),this.$t("reservation.confirmed"))},displayStatusType(){if(this.$route.query.displayStatusType)return console.log("使用URL传递的状态类型:",this.$route.query.displayStatusType),this.$route.query.displayStatusType;if(this.forcedStatusType)return console.log("使用强制状态类型:",this.forcedStatusType),this.forcedStatusType;const e=this.getSavedState();if(e&&e.statusType)return console.log("使用本地存储的状态类型:",e.statusType),e.statusType;if(!this.reservation)return"";const t=new Date,a=new Date(this.reservation.end_datetime);if(a<t)return"warning";const s=new Date(this.reservation.start_datetime);return t>=s&&t<=a?"primary":"cancelled"===this.reservation.status?"danger":"success"},formattedStartTime(){return this.reservation?this.formatDateTime(this.reservation.start_datetime):""},formattedEndTime(){return this.reservation?this.formatDateTime(this.reservation.end_datetime):""}},methods:{isReservationExpired:ne.Gl,async fetchReservation(){this.loading=!0;try{const a=this.$route.params.code;console.log("Fetching reservation with code:",a);const s=this.$route.query.startTime,r=this.$route.query.endTime;let i=this.$route.query.reservationNumber;if(!i){const e=localStorage.getItem("current_reservation_number");e&&(console.log("从localStorage中获取预约序号:",e),i=e)}const n=localStorage.getItem("force_use_reservation_number");"true"===n&&(console.log("强制使用预约序号查询"),localStorage.removeItem("force_use_reservation_number")),console.log("URL 时间参数:",s,r),console.log("预约序号:",i);let o={};const l=(new Date).getTime();if(o._t=l,console.log("添加时间戳参数:",l),s&&r&&(o.start_time=s,o.end_time=r,console.log("Including time parameters in API request:",o)),i&&(o.reservation_number=i,console.log("Including reservation number in API request:",o)),i){console.log("使用预约序号查询:",i);try{const e=await j.getReservationByNumber(i);if(console.log("通过预约序号查询结果:",e),e.data&&e.data.success){console.log("通过预约序号查询成功"),this.reservation=e.data.data,console.log("Original reservation data:",this.reservation);const t=localStorage.getItem("show_reservation_number_notification");return"true"===t&&(this.$notify({title:"预约详情",message:`当前查看的是预约序号: ${this.reservation.reservation_number}`,type:"info",duration:5e3}),localStorage.removeItem("show_reservation_number_notification")),s&&r&&(console.log("使用URL参数覆盖显示时间 - 原始时间:",this.reservation.start_datetime,this.reservation.end_datetime),this.originalStartTime=this.reservation.start_datetime,this.originalEndTime=this.reservation.end_datetime,this.reservation.start_datetime=s,this.reservation.end_datetime=r,console.log("覆盖后的显示时间:",this.reservation.start_datetime,this.reservation.end_datetime)),console.log("Status from API:",this.reservation.status),console.log("Current time:",new Date),this.reservation.status||(console.warn("API returned empty status, setting default to confirmed"),this.reservation.status="confirmed"),console.log(`最终数据库状态: ${this.reservation.status}，展示状态为: ${this.getStatusText(this.reservation)}`),void(this.loading=!1)}console.warn("通过预约序号查询失败，将使用预约码查询")}catch(e){console.error("通过预约序号查询出错:",e),console.warn("将使用预约码查询")}}console.log("Calling API with code and params:",a,o);const c=await j.getReservationByCode(a,o);if(console.log("API Response:",c),c.data&&c.data.success){if(this.reservation=c.data.data,console.log("Original reservation data:",this.reservation),this.reservation.reservation_number&&this.$notify({title:"预约详情",message:`当前查看的是预约序号: ${this.reservation.reservation_number}`,type:"info",duration:5e3}),s&&r&&(console.log("使用URL参数覆盖显示时间 - 原始时间:",this.reservation.start_datetime,this.reservation.end_datetime),this.originalStartTime=this.reservation.start_datetime,this.originalEndTime=this.reservation.end_datetime,this.reservation.start_datetime=s,this.reservation.end_datetime=r,console.log("覆盖后的显示时间:",this.reservation.start_datetime,this.reservation.end_datetime)),console.log("Status from API:",this.reservation.status),console.log("Current time:",new Date),this.reservation.status||(console.warn("API returned empty status, setting default to confirmed"),this.reservation.status="confirmed"),this.reservation.reservation_number){const e=`reservation_status_${this.reservation.reservation_number}`,a=localStorage.getItem(e);if(a)try{const e=JSON.parse(a);console.log("找到预约序号缓存状态:",e),e.reservationNumber===this.reservation.reservation_number?"cancelled"!==e.dbStatus&&"cancelled"!==e.forcedStatus||(console.log("使用缓存中的已取消状态覆盖API返回状态，仅适用于预约序号:",this.reservation.reservation_number),this.reservation.status="cancelled",this.forcedStatus="cancelled",this.forcedStatusText=this.$t("reservation.cancelled"),this.forcedStatusType="danger"):console.log("缓存状态预约序号不匹配，不应用缓存状态")}catch(t){console.error("解析缓存状态出错:",t)}}console.log(`最终数据库状态: ${this.reservation.status}，展示状态为: ${this.getStatusText(this.reservation)}`)}else{const e=c.data?c.data.message:this.$t("reservation.reservationNotFound");this.$message.error(e),this.reservation=null}}catch(e){console.error("Failed to fetch reservation:",e),this.$message.error(this.$t("error.serverError")),this.reservation=null}finally{this.loading=!1}},async loadReservation(){try{this.loading=!0;const e=this.$route.params.code;if(!e)return this.error="预约码不存在",void(this.loading=!1);const t={},a=(new Date).getTime();t._t=a,console.log("添加时间戳参数:",a);const s=this.$route.query.startTime,r=this.$route.query.endTime;s&&(t.start_time=s,console.log("查询开始时间:",s)),r&&(t.end_time=r,console.log("查询结束时间:",r));const i=await this.$api.reservation.getReservationByCode(e,t);console.log("预约API响应:",i),i.success?(this.reservation=i.data,this.dateMatches=!!i.data.date_matches,console.log("日期是否匹配:",this.dateMatches),"confirmed"===this.reservation.status?(this.statusText=this.$t("reservation.confirmed"),this.statusType="success"):"cancelled"===this.reservation.status&&(this.statusText=this.$t("reservation.cancelled"),this.statusType="danger",this.dateMatches&&(this.forcedStatus="cancelled",console.log("强制使用取消状态"))),this.reservation.equipment_id&&this.loadEquipment(this.reservation.equipment_id)):this.error=i.message||"获取预约信息失败"}catch(e){console.error("加载预约详情出错:",e),this.error="加载预约详情出错: "+(e.message||e)}finally{this.loading=!1}},formatDateTime(e){if(!e)return"-";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},getStatusText(e){if(console.log("Checking status from API:",e.status),"cancelled"===e.status)return console.log("Using cancelled status from API"),this.$t("reservation.cancelled");if((0,ne.Gl)(e.end_datetime))return console.log("Calculated status: expired"),this.$t("reservation.expired");const t=new Date,a=new Date(e.start_datetime),s=new Date(e.end_datetime);return t>=a&&t<=s?(console.log("Calculated status: in use"),this.$t("reservation.inUse")):(console.log("Calculated status: confirmed"),this.$t("reservation.confirmed"))},getStatusType(e){if("cancelled"===e.status)return"danger";if((0,ne.Gl)(e.end_datetime))return"warning";const t=new Date,a=new Date(e.start_datetime),s=new Date(e.end_datetime);return t>=a&&t<=s?"primary":"success"},isReservationInProgress(e){if(!e)return!1;const t=new Date,a=new Date(e.start_datetime),s=new Date(e.end_datetime);return t>=a&&t<=s},handleCancel(){this.cancelDialogVisible=!0},handleReturn(){this.returnDialogVisible=!0},async confirmCancel(){this.submitting=!0;try{if(this.reservation.recurring_reservation_id){console.log("Cancelling a child reservation of recurring reservation:",this.reservation.recurring_reservation_id);const e=this.reservation.reservation_code,t=this.reservation.reservation_number,a=await j.cancelReservation(e);if(console.log("Cancel child reservation response:",a),a.data){if("预定已取消"===a.data.message||a.data.message.includes("已取消"))return console.log("预定已经处于取消状态，视为取消成功"),this.cancelDialogVisible=!1,this.reservation.status="cancelled",this.forceUpdateStatus("cancelled"),t&&this.saveStatusByReservationNumber(t,"cancelled"),this.$message.success(this.$t("reservation.cancelSuccess")),void this.$confirm("已成功取消此子预约。是否查看循环预约详情？","操作成功",{confirmButtonText:"查看循环预约",cancelButtonText:"留在当前页面",type:"success"}).then((()=>{this.$router.push(`/admin/recurring-reservation/${this.reservation.recurring_reservation_id}`)})).catch((()=>{this.fetchReservation()}));if(a.data.success)this.cancelDialogVisible=!1,this.reservation.status="cancelled",this.forceUpdateStatus("cancelled"),t&&this.saveStatusByReservationNumber(t,"cancelled"),this.$message.success(this.$t("reservation.cancelSuccess")),this.$confirm("已成功取消此子预约。是否查看循环预约详情？","操作成功",{confirmButtonText:"查看循环预约",cancelButtonText:"留在当前页面",type:"success"}).then((()=>{this.$router.push(`/admin/recurring-reservation/${this.reservation.recurring_reservation_id}`)})).catch((()=>{this.fetchReservation()}));else{const e=a.data.message||this.$t("reservation.cancelFailed");this.$message.error(e),this.cancelDialogVisible=!1}}}else{const e={};this.reservation.reservation_number?(e.reservation_number=this.reservation.reservation_number,console.log("预约序号参数存在:",this.reservation.reservation_number)):console.warn("预约序号参数不存在，将取消所有具有相同预约码的预约"),console.log("取消预约请求参数:",e);const t=await j.cancelReservation(this.reservation.reservation_code,e);if(console.log("Cancel response:",t),t.data){if("预定已取消"===t.data.message||t.data.message.includes("已取消"))return console.log("预定已经处于取消状态，视为取消成功"),this.cancelDialogVisible=!1,this.$message.success(this.$t("reservation.cancelSuccess")),console.log("预约已取消，即将刷新页面..."),void setTimeout((()=>{window.location.href="#/admin/reservation",window.location.reload(!0)}),1e3);if(t.data.success)this.cancelDialogVisible=!1,this.$message.success(this.$t("reservation.cancelSuccess")),console.log("预约已取消，即将刷新页面..."),setTimeout((()=>{window.location.href="#/admin/reservation",window.location.reload(!0)}),1e3);else{const e=t.data.message||this.$t("reservation.cancelFailed");this.$message.error(e),this.cancelDialogVisible=!1}}}}catch(e){console.error("Failed to cancel reservation:",e),this.$message.error(this.$t("error.serverError")),this.cancelDialogVisible=!1}finally{this.submitting=!1}},async confirmReturn(){this.submitting=!0;try{const e={early_return:!0};this.reservation.reservation_number?(e.reservation_number=this.reservation.reservation_number,console.log("提前归还 - 预约序号参数存在:",this.reservation.reservation_number)):console.warn("提前归还 - 预约序号参数不存在，将取消所有具有相同预约码的预约"),console.log("提前归还 - 请求参数:",e);const t=await j.cancelReservation(this.reservation.reservation_code,e);if(console.log("Return response:",t),t.data&&t.data.success)this.returnDialogVisible=!1,this.$message.success(this.$t("reservation.returnSuccess")),this.fetchReservation();else{const e=t.data?t.data.message:this.$t("reservation.returnFailed");this.$message.error(e),this.returnDialogVisible=!1}}catch(e){console.error("Failed to return equipment:",e),this.$message.error(this.$t("error.serverError")),this.returnDialogVisible=!1}finally{this.submitting=!1}},goBack(){window.history.length>1?this.$router.go(-1):this.$router.push("/admin/reservation")},saveState(){if(!this.reservation)return;const e=this.getStatusText(this.reservation),t=this.getStatusType(this.reservation),a=`reservation_status_${this.reservation.reservation_code}`,s={statusText:e,statusType:t,timestamp:(new Date).getTime()};console.log("Saving state to localStorage:",s),localStorage.setItem(a,JSON.stringify(s))},getSavedState(){if(!this.reservation)return null;const e=`reservation_status_${this.reservation.reservation_code}`,t=localStorage.getItem(e);if(!t)return null;try{const a=JSON.parse(t);console.log("Retrieved saved state:",a);const s=(new Date).getTime(),r=3e5;return s-a.timestamp>r?(console.log("Saved state is expired, removing it"),localStorage.removeItem(e),null):a}catch(a){return console.error("Error parsing saved state:",a),null}},updateUrlWithNewStatus(e){console.log("更新URL状态为:",e);let t="",a="";if("cancelled"===e)t=this.$t("reservation.cancelled"),a="danger";else if("confirmed"===e){const e=new Date,s=new Date(this.reservation.start_datetime),r=new Date(this.reservation.end_datetime);e>=s&&e<=r?(t=this.$t("reservation.inUse"),a="primary"):(0,ne.Gl)(this.reservation.end_datetime)?(t=this.$t("reservation.expired"),a="warning"):(t=this.$t("reservation.confirmed"),a="success")}console.log("新状态文本和类型:",t,a);const s={...this.$route.query,displayStatus:t,displayStatusType:a};this.$router.replace({path:this.$route.path,query:s}).catch((e=>{if("NavigationDuplicated"!==e.name)throw e}))},forceUpdateStatus(e){console.log("强制更新状态为:",e);let t="",a="";if("cancelled"===e){if(t=this.$t("reservation.cancelled"),a="danger",this.reservation&&this.reservation.reservation_number){const e=`reservation_status_${this.reservation.reservation_number}`,t={statusText:this.$t("reservation.cancelled"),statusType:"danger",dbStatus:"cancelled",forcedStatus:"cancelled",timestamp:(new Date).getTime(),permanent:!0,reservationNumber:this.reservation.reservation_number};console.log("永久保存特定预约序号的已取消状态:",t),localStorage.setItem(e,JSON.stringify(t))}this.reservation&&(this.reservation.status="cancelled"),this.forcedStatusText=t,this.forcedStatusType=a,this.forcedStatus="cancelled"}else if("confirmed"===e){const e=new Date,s=new Date(this.reservation.start_datetime),r=new Date(this.reservation.end_datetime);if(e>=s&&e<=r?(t=this.$t("reservation.inUse"),a="primary"):(0,ne.Gl)(this.reservation.end_datetime)?(t=this.$t("reservation.expired"),a="warning"):(t=this.$t("reservation.confirmed"),a="success"),this.reservation&&(this.reservation.status="confirmed",this.reservation.reservation_number)){const e=`reservation_status_${this.reservation.reservation_number}`;localStorage.removeItem(e)}this.forcedStatusText=t,this.forcedStatusType=a,this.forcedStatus="confirmed"}this.updateUrlWithNewStatus(e)},saveStatusByReservationNumber(e,t){if(!e)return;console.log("通过预约序号保存状态:",e,t);const a=`reservation_status_${e}`;let s="",r="";"cancelled"===t?(s=this.$t("reservation.cancelled"),r="danger"):"confirmed"===t&&(s=this.$t("reservation.confirmed"),r="success");const i={statusText:s,statusType:r,dbStatus:t,forcedStatus:t,timestamp:(new Date).getTime(),permanent:!0,reservationNumber:e};console.log("保存预约序号状态到缓存:",a,i),localStorage.setItem(a,JSON.stringify(i))},isTimeMatching(e,t,a,s){if(!e||!t||!a||!s)return!1;console.log("比较时间参数:",{urlStartTime:e,urlEndTime:t,resStartTime:a,resEndTime:s});const r=e=>{try{const t=new Date(e);if(isNaN(t.getTime()))return e;const a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${r}`}catch(t){return console.error("格式化时间出错:",t),e}},i=r(e),n=r(t),o=r(a),l=r(s);console.log("格式化后的时间比较:",{urlStartFormatted:i,urlEndFormatted:n,resStartFormatted:o,resEndFormatted:l});const c=i===o&&n===l;return console.log("时间匹配结果:",c),c},isExactTimeMatching(e,t,a,s){if(!e||!t||!a||!s)return!1;console.log("精确比较时间参数:",{urlStartTime:e,urlEndTime:t,resStartTime:a,resEndTime:s});try{let r,i;if("string"===typeof e)if(e.includes("T"))r=new Date(e);else{const t=e.split(" ");if(2===t.length){const e=t[0].split("-"),a=t[1].split(":");r=new Date(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2]),parseInt(a[0]),parseInt(a[1]))}else r=new Date(e)}else r=new Date(e);if("string"===typeof t)if(t.includes("T"))i=new Date(t);else{const e=t.split(" ");if(2===e.length){const t=e[0].split("-"),a=e[1].split(":");i=new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]),parseInt(a[0]),parseInt(a[1]))}else i=new Date(t)}else i=new Date(t);let n=new Date(a),o=new Date(s);const l=e=>isNaN(e.getTime())?(console.error("无效的日期对象:",e),""):`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,c=l(r),u=l(i),d=l(n),m=l(o);console.log("格式化后的精确时间比较:",{urlStartFormatted:c,urlEndFormatted:u,resStartFormatted:d,resEndFormatted:m});const p=c===d&&u===m;return console.log("精确时间匹配结果:",p),p}catch(r){return console.error("精确比较时间出错:",r),!1}}}},Tt=qt;var Rt=(0,h.A)(Tt,St,Ct,!1,null,"6d2ffa65",null);const kt=Rt.exports;var Dt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-settings"},[t("el-tabs",{on:{"tab-click":e.handleTabClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"基础设置",name:"base"}},[t("p",[e._v("（这里是原有系统设置内容）")])]),t("el-tab-pane",{attrs:{label:"邮件设置",name:"email"}},[t("el-form",{attrs:{model:e.emailSettings,"label-width":"120px"},nativeOn:{submit:function(t){return t.preventDefault(),e.saveEmailSettings.apply(null,arguments)}}},[t("el-form-item",{attrs:{label:"SMTP服务器"}},[t("el-input",{model:{value:e.emailSettings.smtp_server,callback:function(t){e.$set(e.emailSettings,"smtp_server",t)},expression:"emailSettings.smtp_server"}})],1),t("el-form-item",{attrs:{label:"端口"}},[t("el-input",{attrs:{type:"number"},model:{value:e.emailSettings.smtp_port,callback:function(t){e.$set(e.emailSettings,"smtp_port",t)},expression:"emailSettings.smtp_port"}})],1),t("el-form-item",{attrs:{label:"发件人邮箱"}},[t("el-input",{model:{value:e.emailSettings.sender_email,callback:function(t){e.$set(e.emailSettings,"sender_email",t)},expression:"emailSettings.sender_email"}})],1),t("el-form-item",{attrs:{label:"发件人名称"}},[t("el-input",{model:{value:e.emailSettings.sender_name,callback:function(t){e.$set(e.emailSettings,"sender_name",t)},expression:"emailSettings.sender_name"}})],1),t("el-form-item",{attrs:{label:"SMTP用户名"}},[t("el-input",{model:{value:e.emailSettings.smtp_username,callback:function(t){e.$set(e.emailSettings,"smtp_username",t)},expression:"emailSettings.smtp_username"}})],1),t("el-form-item",{attrs:{label:"SMTP密码"}},[t("el-input",{attrs:{"show-password":""},model:{value:e.emailSettings.smtp_password,callback:function(t){e.$set(e.emailSettings,"smtp_password",t)},expression:"emailSettings.smtp_password"}})],1),t("el-form-item",{attrs:{label:"抄送人列表"}},[t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"多个邮箱请用逗号分隔，例如：admin1@example.com, admin2@example.com"},model:{value:e.emailSettings.cc_list,callback:function(t){e.$set(e.emailSettings,"cc_list",t)},expression:"emailSettings.cc_list"}}),t("div",{staticClass:"form-tip"},[e._v("多个邮箱请用逗号分隔，所有发出的邮件都会抄送给这些邮箱")])],1),t("el-form-item",{attrs:{label:"密送人列表"}},[t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"多个邮箱请用逗号分隔，例如：manager1@example.com, manager2@example.com"},model:{value:e.emailSettings.bcc_list,callback:function(t){e.$set(e.emailSettings,"bcc_list",t)},expression:"emailSettings.bcc_list"}}),t("div",{staticClass:"form-tip"},[e._v("多个邮箱请用逗号分隔，所有发出的邮件都会密送给这些邮箱")])],1),t("el-form-item",{attrs:{label:"使用SSL"}},[t("el-switch",{model:{value:e.emailSettings.use_ssl,callback:function(t){e.$set(e.emailSettings,"use_ssl",t)},expression:"emailSettings.use_ssl"}})],1),t("el-form-item",{attrs:{label:"启用邮件功能"}},[t("el-switch",{model:{value:e.emailSettings.enabled,callback:function(t){e.$set(e.emailSettings,"enabled",t)},expression:"emailSettings.enabled"}})],1),t("el-form-item",{attrs:{label:"测试收件人邮箱"}},[t("el-input",{model:{value:e.testEmail,callback:function(t){e.testEmail=t},expression:"testEmail"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",loading:e.testLoading},on:{click:e.testEmailSend}},[e._v("测试邮件")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveEmailSettings}},[e._v("保存")])],1)],1)],1),t("el-tab-pane",{attrs:{label:"邮件模板",name:"template"}},[t("div",{staticStyle:{"margin-bottom":"10px"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.openTemplateDialog()}}},[e._v("新增模板")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.templateList,border:""}},[t("el-table-column",{attrs:{prop:"name",label:"模板名称","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.editRow!==a.row.id?t("span",[e._v(e._s(a.row.name))]):t("el-input",{attrs:{size:"small"},model:{value:e.editCache.name,callback:function(t){e.$set(e.editCache,"name",t)},expression:"editCache.name"}})]}}])}),t("el-table-column",{attrs:{prop:"template_key",label:"模板键名","min-width":"120"}}),t("el-table-column",{attrs:{prop:"subject",label:"主题","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.editRow!==a.row.id?t("span",[e._v(e._s(a.row.subject))]):t("el-input",{attrs:{size:"small"},model:{value:e.editCache.subject,callback:function(t){e.$set(e.editCache,"subject",t)},expression:"editCache.subject"}})]}}])}),t("el-table-column",{attrs:{prop:"language",label:"语言","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.editRow!==a.row.id?t("span",[e._v(e._s(a.row.language))]):t("el-select",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:e.editCache.language,callback:function(t){e.$set(e.editCache,"language",t)},expression:"editCache.language"}},[t("el-option",{attrs:{label:"中文",value:"zh_CN"}}),t("el-option",{attrs:{label:"English",value:"en"}})],1)]}}])}),t("el-table-column",{attrs:{prop:"content_html",label:"HTML内容","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.editRow!==a.row.id?t("span",{staticStyle:{"white-space":"pre-line","word-break":"break-all","max-width":"400px",display:"inline-block"}},[e._v(" "+e._s(a.row.content_html)+" ")]):t("el-input",{attrs:{type:"textarea",rows:4,size:"small"},model:{value:e.editCache.content_html,callback:function(t){e.$set(e.editCache,"content_html",t)},expression:"editCache.content_html"}})]}}])}),t("el-table-column",{attrs:{label:"操作","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.editRow===a.row.id?[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.saveEdit(a.row)}}},[e._v("保存")]),t("el-button",{attrs:{size:"mini"},on:{click:e.cancelEdit}},[e._v("取消")])]:[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.startEdit(a.row)}}},[e._v("编辑")]),t("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(t){return e.deleteTemplate(a.row)}}},[e._v("删除")])]]}}])})],1),t("el-dialog",{attrs:{title:e.templateDialogTitle,visible:e.templateDialogVisible,width:"600px"},on:{"update:visible":function(t){e.templateDialogVisible=t}}},[t("el-form",{ref:"templateFormRef",attrs:{model:e.templateForm,"label-width":"100px",rules:e.templateRules}},[t("el-form-item",{attrs:{label:"模板名称",prop:"name"}},[t("el-input",{model:{value:e.templateForm.name,callback:function(t){e.$set(e.templateForm,"name",t)},expression:"templateForm.name"}})],1),t("el-form-item",{attrs:{label:"模板键名",prop:"template_key"}},[t("el-input",{model:{value:e.templateForm.template_key,callback:function(t){e.$set(e.templateForm,"template_key",t)},expression:"templateForm.template_key"}})],1),t("el-form-item",{attrs:{label:"主题",prop:"subject"}},[t("el-input",{model:{value:e.templateForm.subject,callback:function(t){e.$set(e.templateForm,"subject",t)},expression:"templateForm.subject"}})],1),t("el-form-item",{attrs:{label:"语言",prop:"language"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.templateForm.language,callback:function(t){e.$set(e.templateForm,"language",t)},expression:"templateForm.language"}},[t("el-option",{attrs:{label:"中文",value:"zh_CN"}}),t("el-option",{attrs:{label:"English",value:"en"}})],1)],1),t("el-form-item",{attrs:{label:"HTML内容",prop:"content_html"}},[t("el-input",{attrs:{type:"textarea",rows:8,placeholder:"支持Jinja2变量，如 reservation.user_name"},model:{value:e.templateForm.content_html,callback:function(t){e.$set(e.templateForm,"content_html",t)},expression:"templateForm.content_html"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.templateDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveTemplate}},[e._v("保存")])],1)],1)],1),t("el-tab-pane",{attrs:{label:"邮件日志",name:"log"}},[t("el-form",{staticStyle:{"margin-bottom":"10px"},attrs:{inline:!0,size:"small"}},[t("el-form-item",{attrs:{label:"状态"}},[t("el-select",{attrs:{clearable:"",placeholder:"全部"},model:{value:e.logFilter.status,callback:function(t){e.$set(e.logFilter,"status",t)},expression:"logFilter.status"}},[t("el-option",{attrs:{label:"成功",value:"success"}}),t("el-option",{attrs:{label:"失败",value:"failed"}})],1)],1),t("el-form-item",{attrs:{label:"事件类型"}},[t("el-input",{attrs:{placeholder:"如 reservation_created",clearable:""},model:{value:e.logFilter.event_type,callback:function(t){e.$set(e.logFilter,"event_type",t)},expression:"logFilter.event_type"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.fetchLogs}},[e._v("查询")]),t("el-button",{on:{click:e.clearLogFilter}},[e._v("重置")])],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.logList,border:""}},[t("el-table-column",{attrs:{prop:"recipient",label:"收件人","min-width":"120"}}),t("el-table-column",{attrs:{prop:"subject",label:"主题","min-width":"150"}}),t("el-table-column",{attrs:{prop:"event_type",label:"事件类型","min-width":"120"}}),t("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:"success"===a.row.status?"success":"danger"}},[e._v(" "+e._s("success"===a.row.status?"成功":"失败")+" ")])]}}])}),t("el-table-column",{attrs:{prop:"created_at",label:"时间","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.created_at))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.showLogContent(a.row)}}},[e._v("查看内容")])]}}])})],1),t("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{background:"",layout:"prev, pager, next, jumper",total:e.logTotal,"page-size":e.logPageSize,"current-page":e.logPage},on:{"update:currentPage":function(t){e.logPage=t},"update:current-page":function(t){e.logPage=t},"current-change":e.fetchLogs}}),t("el-dialog",{attrs:{title:"邮件内容",visible:e.logContentDialogVisible,width:"60%"},on:{"update:visible":function(t){e.logContentDialogVisible=t}}},[e.selectedLog&&e.selectedLog.content_html?t("div",{domProps:{innerHTML:e._s(e.selectedLog.content_html)}}):t("div",[e._v("暂无内容")])])],1),e.isSuperAdmin?t("el-tab-pane",{attrs:{label:"数据库表查看",name:"db-viewer"}},[t("DatabaseViewer",{ref:"dbViewer"})],1):e._e()],1)],1)},xt=[],Et=a(9515);const At={name:"AdminSettings",components:{DatabaseViewer:Et["default"]},data(){return{activeTab:"base",emailSettings:{smtp_server:"",smtp_port:587,sender_email:"",sender_name:"",smtp_username:"",smtp_password:"",cc_list:"",bcc_list:"",use_ssl:!0,enabled:!1},templateList:[],templateDialogVisible:!1,templateDialogTitle:"新增模板",templateForm:{id:null,name:"",template_key:"",subject:"",content_html:"",language:"zh_CN"},templateRules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],template_key:[{required:!0,message:"请输入模板键名",trigger:"blur"}],subject:[{required:!0,message:"请输入主题",trigger:"blur"}],content_html:[{required:!0,message:"请输入HTML内容",trigger:"blur"}],language:[{required:!0,message:"请选择语言",trigger:"change"}]},logList:[],logTotal:0,logPage:1,logPageSize:10,logFilter:{status:"",event_type:""},testEmail:"",testLoading:!1,editRow:null,editCache:{},logContentDialogVisible:!1,selectedLog:null}},computed:{...(0,l.aH)({user:e=>e.user}),isSuperAdmin(){return this.user&&"superadmin"===this.user.role}},created(){this.fetchEmailSettings(),this.fetchTemplates(),this.fetchLogs()},methods:{handleTabClick(e){"db-viewer"===e.name&&this.$refs.dbViewer&&this.$refs.dbViewer.initIfNeeded()},async fetchEmailSettings(){try{const e=await P.A.get("/api/admin/email/settings");this.emailSettings=e.data}catch(e){this.$message.error("获取邮件设置失败")}},async saveEmailSettings(){try{await P.A.post("/api/admin/email/settings",this.emailSettings),this.$message.success("保存成功")}catch(e){this.$message.error("保存失败")}},async fetchTemplates(){try{const e=await P.A.get("/api/admin/email/templates");this.templateList=e.data}catch(e){this.$message.error("获取模板失败")}},openTemplateDialog(e){e?(this.templateDialogTitle="编辑模板",this.templateForm={...e}):(this.templateDialogTitle="新增模板",this.templateForm={id:null,name:"",template_key:"",subject:"",content_html:"",language:"zh_CN"}),this.templateDialogVisible=!0},async saveTemplate(){this.$refs.templateFormRef.validate((async e=>{if(e)try{this.templateForm.id?(await P.A.put(`/api/admin/email/templates/${this.templateForm.id}`,this.templateForm),this.$message.success("更新成功")):(await P.A.post("/api/admin/email/templates",this.templateForm),this.$message.success("新增成功")),this.templateDialogVisible=!1,this.fetchTemplates()}catch(t){this.$message.error(t.response?.data?.detail||"保存失败")}}))},async deleteTemplate(e){this.$confirm("确定要删除该模板吗？","提示",{type:"warning"}).then((async()=>{await P.A.delete(`/api/admin/email/templates/${e.id}`),this.$message.success("删除成功"),this.fetchTemplates()})).catch((()=>{}))},async fetchLogs(){try{const e={skip:(this.logPage-1)*this.logPageSize,limit:this.logPageSize,status:this.logFilter.status,event_type:this.logFilter.event_type},t=await P.A.get("/api/admin/email/logs",{params:e});this.logList=t.data.items,this.logTotal=t.data.total}catch(e){this.$message.error("获取日志失败")}},clearLogFilter(){this.logFilter={status:"",event_type:""},this.logPage=1,this.fetchLogs()},async deleteLog(e){this.$confirm("确定要删除该日志吗？","提示",{type:"warning"}).then((async()=>{await P.A.delete(`/api/admin/email/logs/${e.id}`),this.$message.success("删除成功"),this.fetchLogs()})).catch((()=>{}))},formatDate(e){if(!e)return"";let t="string"!==typeof e||e.endsWith("Z")?new Date(e):new Date(e+"Z");return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},async testEmailSend(){if(this.testEmail){this.testLoading=!0;try{const e={...this.emailSettings,to_email:this.testEmail},t=await P.A.post("/api/admin/email/test",e);t.data.success?this.$message.success(t.data.message):this.$message.error(t.data.message)}catch(e){this.$message.error("请求失败")}finally{this.testLoading=!1}}else this.$message.warning("请输入测试收件人邮箱")},startEdit(e){this.editRow=e.id,this.editCache={...e}},cancelEdit(){this.editRow=null,this.editCache={}},async saveEdit(e){try{await this.$confirm("确定保存修改吗？","提示",{type:"warning"}),await P.A.put(`/api/admin/email/templates/${e.id}`,this.editCache),this.$message.success("保存成功"),this.editRow=null,this.editCache={},this.fetchTemplates()}catch(t){this.$message.error(t.response?.data?.detail||"保存失败")}},showLogContent(e){this.selectedLog=e,window.selectedLog=e,this.logContentDialogVisible=!0}}},Ft=At;var It=(0,h.A)(Ft,Dt,xt,!1,null,"7d863603",null);const Lt=It.exports;var Nt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"not-found"},[t("div",{staticClass:"error-container"},[t("div",{staticClass:"error-code"},[e._v("404")]),t("h1",[e._v(e._s(e.$t("error.notFound")))]),t("p",[e._v(e._s(e.$t("error.errorMessage")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.goHome}},[e._v(" "+e._s(e.$t("error.backHome"))+" ")])],1)])},Pt=[];const Ot={name:"NotFound",methods:{goHome(){this.$router.push("/")}}},zt=Ot;var Mt=(0,h.A)(zt,Nt,Pt,!1,null,"0e5e6202",null);const Ut=Mt.exports;s["default"].use(N.Ay);const Bt=[{path:"/",name:"home",component:X,meta:{title:"首页"}},{path:"/calendar",name:"calendar",component:()=>a.e(425).then(a.bind(a,6425)),meta:{title:"calendar.title"}},{path:"/equipment",name:"equipment-list",component:se,meta:{title:"设备列表"}},{path:"/equipment/:id",name:"equipment-detail",component:ue,meta:{title:"设备详情"}},{path:"/equipment/:id/reserve",name:"reservation-form",component:ve,meta:{title:"预定设备"}},{path:"/equipment/:id/recurring-reserve",name:"recurring-reservation-form",component:we,meta:{title:"循环预约设备"}},{path:"/reservation/query",name:"reservation-query",component:ke,meta:{title:"查询预定"}},{path:"/reservation/number/:number",name:"reservation-detail-by-number",component:Ie,meta:{title:"预定详情"}},{path:"/reservation/:code",name:"reservation-detail",component:Ie,meta:{title:"预定详情"}},{path:"/recurring-reservation/:id",name:"recurring-reservation-detail",component:Me,meta:{title:"循环预约详情"},props:!0},{path:"/admin/login",name:"admin-login",component:je,meta:{title:"管理员登录"}},{path:"/admin",component:()=>a.e(551).then(a.bind(a,8551)),meta:{title:"管理控制台",requiresAuth:!0},children:[{path:"",redirect:"/admin/dashboard"},{path:"dashboard",name:"admin-dashboard",component:Ze,meta:{title:"控制台",requiresAuth:!0}},{path:"equipment",name:"admin-equipment",component:ut,meta:{title:"设备管理",requiresAuth:!0}},{path:"category",name:"admin-category",component:vt,meta:{title:"设备类别管理",requiresAuth:!0}},{path:"reservation",name:"admin-reservation",component:wt,meta:{title:"预定管理",requiresAuth:!0}},{path:"reservation/:code",name:"admin-reservation-detail",component:kt,meta:{title:"预定详情",requiresAuth:!0}},{path:"settings",name:"admin-settings",component:Lt,meta:{title:"系统设置",requiresAuth:!0}},{path:"db-viewer",name:"admin-db-viewer",component:()=>Promise.resolve().then(a.bind(a,9515)),meta:{title:"数据库表查看",requiresAuth:!0}}]},{path:"*",name:"not-found",component:Ut,meta:{title:"页面未找到"}}],Wt=new N.Ay({mode:"hash",base:"/static/frontend/",routes:Bt});Wt.beforeEach(((e,t,a)=>{if(e.path.startsWith("/recurring-reservation/")&&"recurring-reservation-detail"!==e.name){const t=e.path.split("/").pop();a({name:"recurring-reservation-detail",params:{id:t}})}else a()}));const Ht=Wt;var Qt=a(9143),jt=a.n(Qt),Vt=a(9522),Yt=a(1040),Gt=a(2467),Jt=a(4130),Xt=a.n(Jt);Xt().configure({showSpinner:!1});Ht.beforeEach(((e,t,a)=>{Xt().start(),document.title=e.meta.title?`${e.meta.title} - HTNIA设备预定系统`:"HTNIA设备预定系统";const s=O.getters.isLoggedIn,r=e.matched.some((e=>e.meta.requiresAuth));return"/admin/login"===e.path&&s?(a("/admin/dashboard"),void Xt().done()):r&&!s?(a(`/admin/login?redirect=${e.path}`),void Xt().done()):void a()})),Ht.afterEach((()=>{Xt().done()}));const Zt={common:{appName:"设备预定系统",loading:"加载中...",success:"成功",downloadSuccess:"下载成功",error:"错误",warning:"警告",info:"信息",confirm:"确认",cancel:"取消",save:"保存",edit:"编辑",delete:"删除",search:"搜索",reset:"重置",submit:"提交",back:"返回",more:"更多",all:"全部",yes:"是",no:"否",noData:"暂无数据",operation:"操作",actions:"操作",status:"状态",createTime:"创建时间",updateTime:"更新时间",userInfo:"用户信息",instructions:"使用说明",today:"今天",week:"周",month:"月",notProvided:"未提供",id:"序号",view:"查看"},nav:{home:"首页",equipment:"设备列表",reservation:"预定管理",query:"查询预定",admin:"管理控制台",login:"登录",logout:"退出登录",calendar:"日历视图"},home:{welcome:"欢迎使用设备预定系统",description:"这是一个简单易用的设备预定系统，您可以在这里预定学校IT部门的各种设备。",reserveEquipment:"预定设备",queryReservation:"查询预定",instructions:"使用说明",step1:"浏览可用设备并选择您需要的设备",step2:"选择预定时间段",step3:"填写您的个人信息",step4:"提交预定申请",step5:"记录预定码，用于后续查询或取消预定",contactInfo:"如有任何问题，请联系IT部门。",viewReservations:"查看预定情况",viewReservationsDesc:"查看设备的预定情况，帮助您合理安排预定计划。",browseEquipment:"浏览设备",myReservations:"我的预定管理",myReservationsDesc:"创建新预定、查询和管理您的预定记录，修改或取消已有预定。",manageReservations:"管理预定",publicQuery:"公共预定查询",noRecordsFound:"没有找到符合条件的预定记录"},equipment:{description:"浏览并预定系统中可用的各种设备。",list:"设备列表",detail:"设备详情",name:"设备名称",category:"设备类别",model:"设备型号",location:"设备位置",status:"设备状态",description:"设备描述",userGuide:"使用指南",userGuidePlaceholder:"请输入设备的详细使用步骤、注意事项等信息...",videoTutorial:"视频教程",image:"设备图片",videoTutorialPlaceholder:"请输入视频链接，支持YouTube、Bilibili等平台",available:"可用",maintenance:"维护中",inUse:"使用中",reserve:"预定此设备",viewDetail:"查看详情",noDescription:"暂无描述",filter:"筛选",allCategories:"所有类别",allStatus:"所有状态",searchPlaceholder:"搜索设备名称、型号或位置",currentReservations:"当前预定情况",noReservations:"当前没有预定记录",equipmentInfo:"设备信息"},reservation:{description:"轻松创建、管理和跟踪您的设备预定。",queryDescription:"使用预定码或联系方式查询您的预定详情。",form:"预定表单",detail:"预定详情",query:"查询预定",publicQuery:"公开查询",personalManagement:"个人预约管理",queryResults:"查询结果",noReservationsFound:"没有找到预约记录",tryDifferentCriteria:"请尝试不同的查询条件",dateRange:"日期范围",startDate:"开始日期",endDate:"结束日期",selectDateRange:"选择日期范围",checkCodeAndContact:"请检查预定码和联系方式是否正确",queryInstructions:"使用预定码或联系方式查询您的预定信息：",queryInstruction1:"输入您的预定码或预定时使用的联系方式",queryInstruction2:'点击"查询"按钮查看预定详情',queryInstruction3:"在预定详情页面可以查看、修改或取消预定",code:"预定码",number:"预约序号",equipmentName:"设备名称",userName:"用户姓名",userDepartment:"用户部门",userContact:"联系方式",userEmail:"用户邮箱（可选）",startTime:"开始时间",endTime:"结束时间",purpose:"使用目的（可选）",status:"状态",reservationInfo:"预约信息",userInfo:"用户信息",active:"活跃",ongoing:"进行中",confirmed:"已确认",cancelled:"已取消",expired:"已过期",inUse:"使用中",statusConfirmed:"已确认",statusCancelled:"已取消",statusExpired:"已过期",statusInUse:"使用中",reserver:"预定人",department:"预定部门",createReservation:"创建预定",updateReservation:"更新预定",cancelReservation:"取消预定",confirmCancel:"确认取消预定？",cancelReason:"取消原因",cancelSuccess:"预定已取消",earlyReturn:"提前归还",confirmEarlyReturn:"确认提前归还设备？",returnReason:"归还原因",returnSuccess:"设备已归还",returnFailed:"归还失败",createSuccess:"预定创建成功",updateSuccess:"预定已更新",queryPlaceholder:"请输入预定码",contactPlaceholder:"请输入预定时使用的联系方式",codeOrContactRequired:"请输入预定码（或联系方式）",contactOrCodeRequired:"请输入联系方式（或预定码）",atLeastOneField:"请至少填写预定码或联系方式中的一项",queryTip:"您可以填写预定码或联系方式中的任意一项进行查询。如果填写联系方式，将显示您的所有预定。",queryButton:"查询",reservationNotFound:"预定不存在",cancelFailed:"取消预定失败",selectDate:"选择日期",selectTime:"选择时间",timeConflict:"所选时间段已被预定",invalidTime:"开始时间必须早于结束时间",requiredField:"此字段为必填项",emailFormat:"请输入正确的邮箱格式",phoneFormat:"请输入正确的手机号格式",saveReservationCode:"请保存您的预定码",viewDetail:"查看预定详情",reservationCodeTip:"您可以使用预定码查询、修改或取消预定。",reservationType:"预约类型",singleReservation:"单次预约",recurringReservation:"循环预约",recurringForm:"循环预约表单",recurringPattern:"循环模式",patternType:"重复模式",daily:"每天",weekly:"每周",monthly:"每月",daysOfWeek:"每周几",daysOfMonth:"每月几号",sunday:"周日",monday:"周一",tuesday:"周二",wednesday:"周三",thursday:"周四",friday:"周五",saturday:"周六",selectDaysOfWeek:"请选择每周几",selectDaysOfMonth:"请选择每月几号",dateRange:"日期范围",timeRange:"时间范围",createRecurringReservation:"创建循环预约",recurringReservationSuccess:"循环预约创建成功",recurringReservationTip:"系统已为您创建了一系列预约，您可以在预约查询页面查看详情。",timeConflictWarning:"注意：系统只检查了第一天的时间冲突，实际预约可能会有部分时间段冲突。",recurringReservationNotice:"循环预约提示",partOfRecurringReservation:"这是循环预约的一部分",viewRecurringReservation:"查看循环预约",recurringReservationDetails:"循环预约详情",childReservations:"子预约列表",noChildReservations:"没有子预约记录",includePast:"包含已过期预约",cancelRecurringReservation:"取消循环预约",cancelRecurringReservationConfirm:"您确定要取消此循环预约吗？这将取消所有未完成的预约。",cancelConfirmation:"您确定要取消此预约吗？",emailForConfirmation:"用于接收确认邮件的邮箱",pattern:"预约模式"},admin:{uploadImage:"上传图片",changeImage:"更换图片",uploadEquipmentImage:"上传设备图片",imageTip:"建议尺寸：800x600像素，最大8MB",imageTypeError:"只允许上传图片文件",imageSizeError:"图片大小不能超过8MB",imageUploadSuccess:"图片上传成功",imageUploadError:"图片上传失败",richTextEditorTip:"您可以使用富文本编辑器添加格式化文本、列表、链接等内容",videoTutorialTip:"输入视频链接后可以在设备详情页面查看视频教程",importExport:"导入/导出",importEquipment:"导入设备",exportEquipment:"导出设备",downloadTemplate:"下载模板",importSuccess:"设备导入成功",importError:"设备导入失败",exportError:"设备导出失败",templateError:"模板下载失败",login:"管理员登录",dashboard:"控制台",equipment:"设备管理",reservation:"预定管理",settings:"系统设置",username:"用户名",password:"密码",loginButton:"登录",loginSuccess:"登录成功",loginFailed:"登录失败，请检查用户名和密码",welcome:"欢迎，",statistics:"统计数据",totalEquipment:"设备总数",availableEquipment:"可用设备",totalReservation:"预定总数",activeReservation:"活跃预定",recentReservations:"最近预定",addEquipment:"添加设备",editEquipment:"编辑设备",deleteEquipment:"删除设备",confirmDeleteEquipment:"确认删除此设备？",equipmentDeleted:"设备已删除",equipmentAdded:"设备已添加",equipmentUpdated:"设备已更新",viewReservation:"查看预定",reservationDetail:"预定详情",systemSettings:"系统设置",siteName:"站点名称",maintenanceMode:"维护模式",reservationLimitPerDay:"每日预定限制",allowEquipmentConflict:"允许设备冲突",advanceReservationDays:"提前预定天数",settingsSaved:"设置已保存"},error:{notFound:"页面未找到",backHome:"返回首页",serverError:"服务器错误",unauthorized:"未授权访问",forbidden:"禁止访问",errorMessage:"出错了！",queryFailed:"查询失败，请稍后重试"},calendar:{title:"预约日历",month:"月",week:"周",day:"日",today:"今天",loadFailed:"加载日历数据失败",noEvents:"没有预约记录",partOfRecurringReservation:"这是循环预约的一部分",reservationInfo:"预约信息"}},Kt={common:{appName:"Equipment Reservation System",loading:"Loading...",success:"Success",downloadSuccess:"Download successful",error:"Error",warning:"Warning",info:"Information",confirm:"Confirm",cancel:"Cancel",save:"Save",edit:"Edit",delete:"Delete",search:"Search",reset:"Reset",submit:"Submit",back:"Back",more:"More",all:"All",yes:"Yes",no:"No",noData:"No Data",operation:"Operation",actions:"Actions",status:"Status",createTime:"Create Time",updateTime:"Update Time",userInfo:"User Information",instructions:"Instructions",today:"Today",week:"Week",month:"Month",notProvided:"Not Provided",id:"ID",view:"View"},nav:{home:"Home",equipment:"Equipment List",reservation:"Reservation Management",query:"Query Reservation",admin:"Admin Console",login:"Login",logout:"Logout",calendar:"Calendar View"},home:{welcome:"Welcome to Equipment Reservation System",description:"This is a simple and easy-to-use equipment reservation system where you can reserve various equipment from the school IT department.",reserveEquipment:"Reserve Equipment",queryReservation:"Query Reservation",instructions:"Instructions",step1:"Browse available equipment and select the one you need",step2:"Choose reservation time slot",step3:"Fill in your personal information",step4:"Submit reservation request",step5:"Record the reservation code for future query or cancellation",contactInfo:"If you have any questions, please contact the IT department.",viewReservations:"View Reservations",viewReservationsDesc:"View equipment reservation status to help you plan your reservations.",browseEquipment:"Browse Equipment",myReservations:"My Reservations",myReservationsDesc:"Create new reservations, query and manage your reservation records, modify or cancel existing reservations.",manageReservations:"Manage Reservations",publicQuery:"Public Reservation Query",noRecordsFound:"No matching reservation records found"},equipment:{description:"Browse and reserve various equipment available in our system.",list:"Equipment List",detail:"Equipment Detail",name:"Equipment Name",category:"Category",model:"Model",location:"Location",status:"Status",description:"Description",userGuide:"User Guide",userGuidePlaceholder:"Please enter detailed usage steps, precautions and other information...",videoTutorial:"Video Tutorial",videoTutorialPlaceholder:"Please enter video link, supporting YouTube, Bilibili, etc.",available:"Available",maintenance:"Maintenance",inUse:"In Use",reserve:"Reserve This Equipment",viewDetail:"View Detail",noDescription:"No description",filter:"Filter",allCategories:"All Categories",allStatus:"All Status",searchPlaceholder:"Search equipment name, model or location",currentReservations:"Current Reservations",noReservations:"No reservation records",equipmentInfo:"Equipment Information"},reservation:{description:"Create, manage and track your equipment reservations easily.",queryDescription:"Find your reservation details using reservation code or contact information.",form:"Reservation Form",detail:"Reservation Detail",query:"Query Reservation",publicQuery:"Public Query",personalManagement:"Personal Reservation Management",queryResults:"Query Results",noReservationsFound:"No Reservations Found",noRecordsFound:"No matching reservation records found",tryDifferentCriteria:"Please try different query criteria",dateRange:"Date Range",startDate:"Start Date",endDate:"End Date",selectDateRange:"Select Date Range",checkCodeAndContact:"Please check your reservation code and contact information",queryInstructions:"Query your reservation information using reservation code or contact:",queryInstruction1:"Enter your reservation code or contact used when reserving",queryInstruction2:'Click "Query" button to view reservation details',queryInstruction3:"You can view, modify or cancel your reservation on the detail page",code:"Reservation Code",equipmentName:"Equipment Name",userName:"User Name",userDepartment:"User Department",userContact:"Contact",userEmail:"Email (Optional)",startTime:"Start Time",endTime:"End Time",purpose:"Purpose (Optional)",status:"Status",reservationInfo:"Reservation Information",userInfo:"User Information",number:"Reservation Number",active:"Active",ongoing:"In Progress",confirmed:"Confirmed",cancelled:"Cancelled",expired:"Expired",inUse:"In Use",statusConfirmed:"Confirmed",statusCancelled:"Cancelled",statusExpired:"Expired",statusInUse:"In Use",reserver:"Reserver",department:"Department",createReservation:"Create Reservation",updateReservation:"Update Reservation",cancelReservation:"Cancel Reservation",confirmCancel:"Confirm to cancel the reservation?",cancelReason:"Cancel Reason",cancelSuccess:"Reservation cancelled",earlyReturn:"Early Return",confirmEarlyReturn:"Confirm to return the equipment early?",returnReason:"Return Reason",returnSuccess:"Equipment returned",returnFailed:"Return failed",createSuccess:"Reservation created successfully",updateSuccess:"Reservation updated",queryPlaceholder:"Please enter reservation code",contactPlaceholder:"Please enter the contact used when reserving",codeOrContactRequired:"Please enter reservation code (or contact)",contactOrCodeRequired:"Please enter contact (or reservation code)",atLeastOneField:"Please fill in at least one of reservation code or contact",queryTip:"You can fill in either reservation code or contact for query. If you fill in contact, all your reservations will be displayed.",queryButton:"Query",reservationNotFound:"Reservation not found",cancelFailed:"Failed to cancel reservation",selectDate:"Select Date",selectTime:"Select Time",timeConflict:"The selected time slot has been reserved",invalidTime:"Start time must be earlier than end time",requiredField:"This field is required",emailFormat:"Please enter a valid email format",phoneFormat:"Please enter a valid phone number format",saveReservationCode:"Please save your reservation code",viewDetail:"View Reservation Details",reservationCodeTip:"You can use the reservation code to query, modify or cancel the reservation.",reservationType:"Reservation Type",singleReservation:"Single Reservation",recurringReservation:"Recurring Reservation",recurringForm:"Recurring Reservation Form",recurringPattern:"Recurring Pattern",patternType:"Pattern Type",daily:"Daily",weekly:"Weekly",monthly:"Monthly",daysOfWeek:"Days of Week",daysOfMonth:"Days of Month",sunday:"Sunday",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",selectDaysOfWeek:"Please select days of week",selectDaysOfMonth:"Please select days of month",dateRange:"Date Range",timeRange:"Time Range",createRecurringReservation:"Create Recurring Reservation",recurringReservationSuccess:"Recurring Reservation Created Successfully",recurringReservationTip:"The system has created a series of reservations for you. You can view the details on the reservation query page.",timeConflictWarning:"Note: The system only checked the time conflict for the first day, actual reservations may have partial time conflicts.",recurringReservationNotice:"Recurring Reservation Notice",partOfRecurringReservation:"This is part of a recurring reservation",viewRecurringReservation:"View Recurring Reservation",recurringReservationDetails:"Recurring Reservation Details",childReservations:"Child Reservations",noChildReservations:"No child reservations found",includePast:"Include past reservations",cancelRecurringReservation:"Cancel Recurring Reservation",cancelRecurringReservationConfirm:"Are you sure you want to cancel this recurring reservation? This will cancel all unfinished reservations.",emailForConfirmation:"Email for confirmation",pattern:"Reservation Pattern"},admin:{uploadImage:"Upload Image",changeImage:"Change Image",uploadEquipmentImage:"Upload Equipment Image",imageTip:"Recommended size: 300x200px, max 2MB",imageTypeError:"Only image files are allowed",imageSizeError:"Image size cannot exceed 2MB",imageUploadSuccess:"Image uploaded successfully",imageUploadError:"Failed to upload image",richTextEditorTip:"You can use the rich text editor to add formatted text, lists, links, etc.",videoTutorialTip:"Enter video link to display video tutorial on equipment detail page",importExport:"Import/Export",importEquipment:"Import Equipment",exportEquipment:"Export Equipment",downloadTemplate:"Download Template",importSuccess:"Equipment imported successfully",importError:"Failed to import equipment",exportError:"Failed to export equipment",templateError:"Failed to download template",login:"Admin Login",dashboard:"Dashboard",equipment:"Equipment Management",reservation:"Reservation Management",settings:"System Settings",username:"Username",password:"Password",loginButton:"Login",loginSuccess:"Login successful",loginFailed:"Login failed, please check username and password",welcome:"Welcome, ",statistics:"Statistics",totalEquipment:"Total Equipment",availableEquipment:"Available Equipment",totalReservation:"Total Reservations",activeReservation:"Active Reservations",recentReservations:"Recent Reservations",addEquipment:"Add Equipment",editEquipment:"Edit Equipment",deleteEquipment:"Delete Equipment",confirmDeleteEquipment:"Confirm to delete this equipment?",equipmentDeleted:"Equipment deleted",equipmentAdded:"Equipment added",equipmentUpdated:"Equipment updated",viewReservation:"View Reservation",reservationDetail:"Reservation Detail",systemSettings:"System Settings",siteName:"Site Name",maintenanceMode:"Maintenance Mode",reservationLimitPerDay:"Reservation Limit Per Day",allowEquipmentConflict:"Allow Equipment Conflict",advanceReservationDays:"Advance Reservation Days",settingsSaved:"Settings saved"},error:{notFound:"Page Not Found",backHome:"Back to Home",serverError:"Server Error",unauthorized:"Unauthorized Access",forbidden:"Forbidden Access",errorMessage:"Oops! Something went wrong!"},calendar:{title:"Reservation Calendar",month:"Month",week:"Week",day:"Day",today:"Today",loadFailed:"Failed to load calendar data",noEvents:"No reservations found",partOfRecurringReservation:"This is part of a recurring reservation",reservationInfo:"Reservation Information"}};s["default"].use(Vt.A),P.A.defaults.baseURL="http://10.6.240.41:8000",P.A.defaults.timeout=3e4,console.log("API Base URL:",P.A.defaults.baseURL),P.A.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e))),P.A.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(s["default"].prototype.$message({message:"您的会话已过期，请重新登录",type:"warning",duration:3e3}),O.dispatch("logout"),"/admin/login"!==Ht.currentRoute.path&&Ht.push("/admin/login")),Promise.reject(e)))),s["default"].prototype.$http=P.A;const ea=new Vt.A({locale:O.state.language||"zh-CN",messages:{"zh-CN":{...Zt,el:Gt["default"].el},en:{...Kt,el:Yt.A.el}},silentTranslationWarn:!0});O.watch((e=>e.language),(e=>{ea.locale=e,document.querySelector("html").setAttribute("lang",e),console.log("Language changed to:",e)})),s["default"].use(jt(),{i18n:(e,t)=>ea.t(e,t)}),s["default"].filter("dateFormat",(function(e,t="YYYY-MM-DD HH:mm"){return e?(0,ne.Yq)(e,t,!0):""})),s["default"].config.productionTip=!1,new s["default"]({router:Ht,store:O,i18n:ea,render:e=>e(L)}).$mount("#app")},3153:(e,t,a)=>{e.exports=a.p+"img/logo.dc7f28d5.png"},3914:(e,t,a)=>{e.exports=a.p+"img/logo.02b9288e.svg"},8650:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(4373);const r={createReservation(e){return s.A.post("/api/reservation",e)},getReservations(e){return s.A.get("/api/reservation",{params:e})},getReservation(e){const t=(new Date).getTime();return s.A.get(`/api/reservation/${e}`,{params:{_t:t}})},getReservationByCode(e,t={}){const a=(new Date).getTime();t={...t,_t:a};const r=`/api/reservation/code/${e}`;return console.log(`API请求: ${r}`,"参数:",t),s.A.get(r,{params:t}).then((e=>(console.log(`API响应: ${r}`,e.data),e.data&&e.data.success&&e.data.data&&console.log(`预约状态: ${e.data.data.status}`),e))).catch((e=>{throw console.error(`API错误: ${r}`,e),e}))},updateReservation(e,t){return s.A.put(`/api/reservation/code/${e}`,t)},cancelReservation(e,t={}){const a=(new Date).getTime();return t._t||(t._t=a),t.reservation_number?console.log("取消预约 - 预约序号:",t.reservation_number):console.warn("取消预约 - 未提供预约序号，将取消所有具有相同预约码的预约"),console.log("取消预约请求参数:",t),console.log("取消预约请求URL:",`/api/reservation/cancel/code/${e}`),s.A.post(`/api/reservation/cancel/code/${e}`,t)},getEquipmentAvailability(e,t){return s.A.get(`/api/equipment/${e}/availability`,{params:t})}}},9515:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var s=function(){var e=this,t=e._self._c;return e.isSuperAdmin?t("div",{staticClass:"db-viewer"},[t("el-row",[t("el-col",{staticClass:"db-tables-list",attrs:{span:4}},[t("el-card",{staticStyle:{height:"100%"},attrs:{shadow:"never"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("b",[e._v("数据库表")])]),t("el-scrollbar",{staticStyle:{height:"70vh"}},[t("el-menu",{attrs:{"default-active":e.selectedTable},on:{select:e.handleTableSelect}},e._l(e.tables,(function(a){return t("el-menu-item",{key:a,attrs:{index:a}},[e._v(" "+e._s(a)+" ")])})),1)],1)],1)],1),t("el-col",{staticClass:"db-table-content",attrs:{span:20}},[t("el-card",{staticStyle:{"min-height":"70vh"},attrs:{shadow:"never"}},[t("div",{staticClass:"db-table-header",attrs:{slot:"header"},slot:"header"},[e.selectedTable?t("span",[t("b",[e._v(e._s(e.selectedTable))]),e._v("（共 "+e._s(e.total)+" 条）")]):e._e(),e.selectedTable?t("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",icon:"el-icon-refresh"},on:{click:e.refreshTable}},[e._v("刷新")]):e._e()],1),e.selectedTable?t("div",{staticClass:"table-container"},[t("div",{staticClass:"horizontal-scroll-container data-table-container"},[t("el-table",{staticClass:"custom-table",staticStyle:{width:"100%"},attrs:{data:e.rows,border:"",size:"small","table-layout":e.isSmallTable?"fixed":"auto",height:540,"highlight-current-row":""}},e._l(e.columns,(function(a){return t("el-table-column",{key:a.name,attrs:{prop:a.name,label:a.name,width:e.isSmallTable?e.getColumnWidth(a.name):"","min-width":e.isSmallTable?"":e.getColumnMinWidth(a.name),formatter:e.formatCell,"show-overflow-tooltip":"","header-align":"center",align:"center"}})})),1)],1),e.total>0?t("el-pagination",{staticStyle:{"margin-top":"16px","text-align":"right"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.page,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"pager-count":7,total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.handlePageChange,"size-change":e.handleSizeChange}}):e._e(),t("div",{staticClass:"db-table-columns-info",staticStyle:{"margin-top":"16px"}},[t("b",[e._v("字段信息：")]),t("div",{staticClass:"columns-info-container"},[t("el-table",{staticStyle:{width:"100%","margin-top":"8px"},attrs:{data:e.columns,border:"",size:"mini","table-layout":"fixed"}},[t("el-table-column",{attrs:{prop:"name",label:"字段名",width:"150"}}),t("el-table-column",{attrs:{prop:"type",label:"类型",width:"150"}}),t("el-table-column",{attrs:{prop:"nullable",label:"可空",width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:a.row.nullable?"info":"success"}},[e._v(e._s(a.row.nullable?"是":"否"))])]}}],null,!1,2001004620)}),t("el-table-column",{attrs:{prop:"comment",label:"注释","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getFieldComment(t.row.name))+" ")]}}],null,!1,1905219484)})],1)],1)])],1):t("div",{staticStyle:{"text-align":"center",color:"#888",padding:"60px 0"}},[e._v("请选择左侧表名")])])],1)],1)],1):t("div",{staticStyle:{"text-align":"center",color:"#888",padding:"60px 0"}},[e._v("无权限，仅超级管理员可访问")])},r=[],i=a(4373);function n(){return console.log("正在请求数据库表名..."),i.A.get("/api/db/tables")}function o(e){return console.log("正在请求表字段结构:",e),i.A.get(`/api/db/table/${e}/columns`)}function l(e,t){return console.log("正在请求表数据:",e,t),i.A.get(`/api/db/table/${e}/rows`,{params:t})}var c=a(3518);const u={name:"DatabaseViewer",data(){return{tables:[],selectedTable:"",columns:[],rows:[],total:0,page:1,pageSize:20,loading:!1,inited:!1,fieldComments:{"admin.id":"管理员唯一ID","admin.username":"管理员登录账号","admin.password_hash":"加密后的登录密码","admin.name":"管理员姓名","admin.role":"管理员角色（如superadmin）","admin.is_active":"账号是否激活（1激活，0禁用）","admin.created_at":"账号创建时间","email_logs.id":"日志唯一ID","email_logs.recipient":"收件人邮箱","email_logs.subject":"邮件主题","email_logs.template_key":"邮件模板标识","email_logs.event_type":"触发邮件的事件类型","email_logs.status":"发送状态（如success/failed）","email_logs.error_message":"发送失败时的错误信息","email_logs.reservation_code":"关联预约的编码","email_logs.reservation_number":"关联预约的编号","email_logs.created_at":"日志创建时间","email_logs.content_html":"邮件HTML内容","email_settings.id":"配置唯一ID","email_settings.smtp_server":"SMTP服务器地址","email_settings.smtp_port":"SMTP服务器端口","email_settings.sender_email":"发件人邮箱","email_settings.sender_name":"发件人显示名称","email_settings.smtp_username":"SMTP登录用户名","email_settings.smtp_password":"SMTP登录密码","email_settings.use_ssl":"是否使用SSL加密（1是，0否）","email_settings.enabled":"配置是否启用（1启用，0禁用）","email_settings.created_at":"配置创建时间","email_settings.updated_at":"配置更新时间","email_templates.id":"模板唯一ID","email_templates.name":"模板名称","email_templates.template_key":"模板标识（代码）","email_templates.subject":"邮件主题模板","email_templates.content_html":"HTML格式邮件内容","email_templates.content_text":"纯文本邮件内容","email_templates.variables":"可用变量说明","email_templates.language":"模板语言","email_templates.created_at":"模板创建时间","email_templates.updated_at":"模板更新时间","equipment.id":"设备唯一ID","equipment.name":"设备名称","equipment.category":"设备类别名称","equipment.model":"设备型号","equipment.location":"设备存放位置","equipment.status":"设备状态（如可用/维修/借出）","equipment.description":"设备详细描述","equipment.image_path":"设备图片路径","equipment.user_guide":"设备使用说明","equipment.created_at":"设备信息创建时间","equipment.updated_at":"设备信息更新时间","equipment.video_tutorial":"设备视频教程地址","equipment.category_id":"设备类别ID","equipment_category.id":"类别唯一ID","equipment_category.name":"类别名称","equipment_category.description":"类别描述","recurring_reservation.id":"周期预约唯一ID","recurring_reservation.equipment_id":"设备ID","recurring_reservation.pattern_type":"重复模式类型（如每周/每月）","recurring_reservation.days_of_week":"每周重复的星期（如1,3,5）","recurring_reservation.days_of_month":"每月重复的日期（如5,15,25）","recurring_reservation.start_date":"预约周期开始日期","recurring_reservation.end_date":"预约周期结束日期","recurring_reservation.start_time":"每天预约开始时间","recurring_reservation.end_time":"每天预约结束时间","recurring_reservation.user_name":"预约人姓名","recurring_reservation.user_department":"预约人部门","recurring_reservation.user_contact":"预约人联系方式","recurring_reservation.user_email":"预约人邮箱","recurring_reservation.purpose":"预约用途","recurring_reservation.status":"周期预约状态","recurring_reservation.created_at":"创建时间","recurring_reservation.reservation_code":"周期预约编码","reservation.id":"预约唯一ID","reservation.equipment_id":"设备ID","reservation.reservation_code":"预约编码","reservation.user_name":"预约人姓名","reservation.user_department":"预约人部门","reservation.user_contact":"预约人联系方式","reservation.user_email":"预约人邮箱","reservation.start_datetime":"预约开始时间","reservation.end_datetime":"预约结束时间","reservation.purpose":"预约用途","reservation.status":"预约状态","reservation.created_at":"预约创建时间","reservation.recurring_reservation_id":"关联的周期预约ID","reservation.is_exception":"是否为周期预约的特例","reservation.reservation_number":"预约编号","system_settings.id":"设置唯一ID","system_settings.site_name":"系统站点名称","system_settings.maintenance_mode":"维护模式开关（1开启，0关闭）","system_settings.reservation_limit_per_day":"单日预约上限","system_settings.allow_equipment_conflict":"是否允许设备冲突预约（1允许，0不允许）","system_settings.advance_reservation_days":"可提前预约天数","system_settings.created_at":"设置创建时间","system_settings.updated_at":"设置更新时间"}}},computed:{...(0,c.aH)({user:e=>e.user}),isSuperAdmin(){return this.user&&"superadmin"===this.user.role},isSmallTable(){const e=["admin","equipment_category","system_settings"];return!e.includes(this.selectedTable)}},created(){console.log("DatabaseViewer 组件 created")},mounted(){console.log("DatabaseViewer 组件 mounted, 调用 initIfNeeded"),this.initIfNeeded()},methods:{async initIfNeeded(){console.log("initIfNeeded 被调用，inited=",this.inited,"isSuperAdmin=",this.isSuperAdmin),!this.inited&&this.isSuperAdmin&&(this.inited=!0,await this.fetchTables())},async fetchTables(){console.log("开始获取数据库表名...");try{console.log("调用 getDbTables()");const e=await n();console.log("获取表名结果:",e),this.tables=e.data.tables||[],this.tables.length>0&&this.handleTableSelect(this.tables[0])}catch(e){console.error("获取表名失败:",e),this.$message.error("获取表名失败: "+(e.message||e))}},async handleTableSelect(e){this.selectedTable=e,this.page=1,await this.fetchTableColumns(),await this.fetchTableRows()},async fetchTableColumns(){try{const e=await o(this.selectedTable);this.columns=(e.data.columns||[]).map((e=>({name:e.name||e.column_name,type:e.type||e.type_name,nullable:void 0!==e.nullable?e.nullable:e.nullable_,default:e.default,comment:e.comment||""})))}catch(e){this.columns=[],this.$message.error("获取字段信息失败")}},async fetchTableRows(){this.loading=!0;try{const e=await l(this.selectedTable,{skip:(this.page-1)*this.pageSize,limit:this.pageSize});this.rows=e.data.rows||[],void 0!==e.data.total?this.total=e.data.total:this.rows.length<this.pageSize?this.total=(this.page-1)*this.pageSize+this.rows.length:this.total=this.page*this.pageSize+this.pageSize}catch(e){this.rows=[],this.$message.error("获取表数据失败")}finally{this.loading=!1}},handlePageChange(e){this.page=e,this.fetchTableRows()},handleSizeChange(e){this.pageSize=e,this.page=1,this.fetchTableRows()},refreshTable(){this.fetchTableColumns(),this.fetchTableRows()},getFieldComment(e){const t=`${this.selectedTable}.${e}`;return this.fieldComments[t]||"暂无注释"},getColumnMinWidth(e){const t=e.toLowerCase();return"admin"===this.selectedTable?"id"===t?80:"username"===t?150:"password_hash"===t?300:"name"===t?150:"role"===t?120:"is_active"===t?100:"created_at"===t?180:150:"equipment_category"===this.selectedTable?"id"===t?80:"name"===t?200:"description"===t?300:"created_at"===t?180:200:"system_settings"===this.selectedTable?"id"===t?80:"key"===t?200:"value"===t?400:"description"===t?300:200:t.includes("content_html")||t.includes("html")?300:"id"===t?80:t.includes("date")||t.includes("time")?160:120},getColumnWidth(e){const t=e.toLowerCase();return"email_logs"===this.selectedTable&&"content_html"===t?500:t.includes("content_html")||t.includes("html")||t.includes("content")?300:"id"===t?80:t.includes("date")||t.includes("time")?160:t.includes("name")?120:t.includes("code")||t.includes("number")?140:t.includes("title")?120:t.includes("email")?180:t.includes("description")||t.includes("comment")?200:t.includes("status")?120:t.includes("password")||t.includes("hash")?250:120},formatCell(e,t,a){if(null===a||void 0===a)return"";if((t.property.toLowerCase().includes("content_html")||t.property.toLowerCase().includes("html"))&&"string"===typeof a&&a.length>100)return a.substring(0,100)+"...";if((t.property.toLowerCase().includes("date")||t.property.toLowerCase().includes("time"))&&!isNaN(Date.parse(a)))try{return new Date(a).toLocaleString()}catch(s){return a}return a}}},d=u;var m=a(1656),p=(0,m.A)(d,s,r,!1,null,null,null);const g=p.exports}},t={};function a(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(i.exports,i,i.exports,a),i.loaded=!0,i.exports}a.m=e,(()=>{a.amdO={}})(),(()=>{var e=[];a.O=(t,s,r,i)=>{if(!s){var n=1/0;for(u=0;u<e.length;u++){for(var[s,r,i]=e[u],o=!0,l=0;l<s.length;l++)(!1&i||n>=i)&&Object.keys(a.O).every((e=>a.O[e](s[l])))?s.splice(l--,1):(o=!1,i<n&&(n=i));if(o){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[s,r,i]}})(),(()=>{a.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return a.d(t,{a:t}),t}})(),(()=>{a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}})(),(()=>{a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,s)=>(a.f[s](e,t),t)),[]))})(),(()=>{a.u=e=>"js/"+e+"."+{425:"c5890fb4",551:"105874da"}[e]+".js"})(),(()=>{a.miniCssF=e=>"css/"+e+"."+{425:"5fedab91",551:"c42e6d02"}[e]+".css"})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="equipment-reservation-frontend:";a.l=(s,r,i,n)=>{if(e[s])e[s].push(r);else{var o,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==s||d.getAttribute("data-webpack")==t+i){o=d;break}}o||(l=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",t+i),o.src=s),e[s]=[r];var m=(t,a)=>{o.onerror=o.onload=null,clearTimeout(p);var r=e[s];if(delete e[s],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((e=>e(a))),t)return t(a)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=m.bind(null,o.onerror),o.onload=m.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),(()=>{a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{a.p="/static/frontend/"})(),(()=>{if("undefined"!==typeof document){var e=(e,t,s,r,i)=>{var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",a.nc&&(n.nonce=a.nc);var o=a=>{if(n.onerror=n.onload=null,"load"===a.type)r();else{var s=a&&a.type,o=a&&a.target&&a.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+s+": "+o+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=s,l.request=o,n.parentNode&&n.parentNode.removeChild(n),i(l)}};return n.onerror=n.onload=o,n.href=t,s?s.parentNode.insertBefore(n,s.nextSibling):document.head.appendChild(n),n},t=(e,t)=>{for(var a=document.getElementsByTagName("link"),s=0;s<a.length;s++){var r=a[s],i=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(i===e||i===t))return r}var n=document.getElementsByTagName("style");for(s=0;s<n.length;s++){r=n[s],i=r.getAttribute("data-href");if(i===e||i===t)return r}},s=s=>new Promise(((r,i)=>{var n=a.miniCssF(s),o=a.p+n;if(t(n,o))return r();e(s,o,null,r,i)})),r={524:0};a.f.miniCss=(e,t)=>{var a={425:1,551:1};r[e]?t.push(r[e]):0!==r[e]&&a[e]&&t.push(r[e]=s(e).then((()=>{r[e]=0}),(t=>{throw delete r[e],t})))}}})(),(()=>{var e={524:0};a.f.j=(t,s)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)s.push(r[2]);else{var i=new Promise(((a,s)=>r=e[t]=[a,s]));s.push(r[2]=i);var n=a.p+a.u(t),o=new Error,l=s=>{if(a.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var i=s&&("load"===s.type?"missing":s.type),n=s&&s.target&&s.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+n+")",o.name="ChunkLoadError",o.type=i,o.request=n,r[1](o)}};a.l(n,l,"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,s)=>{var r,i,[n,o,l]=s,c=0;if(n.some((t=>0!==e[t]))){for(r in o)a.o(o,r)&&(a.m[r]=o[r]);if(l)var u=l(a)}for(t&&t(s);c<n.length;c++)i=n[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(u)},s=self["webpackChunkequipment_reservation_frontend"]=self["webpackChunkequipment_reservation_frontend"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=a.O(void 0,[504],(()=>a(2465)));s=a.O(s)})();